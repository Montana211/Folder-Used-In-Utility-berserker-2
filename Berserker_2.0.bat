@echo off
color 0F
chcp 65001 > nul
setlocal enabledelayedexpansion
title Berserker V2.0

:: Colors
set "reset=[0m"
set "blue=[38;5;33m"
set "ORANGE=%ESC%38;5;208m"
set "Gray=[90m"
set "green=[38;5;47m"
set "pink=[38;5;206m"
set "purple=[38;5;171m"
set "red=[38;5;196m"
set "yellow=[38;5;220m"

for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 18362 (
cls
echo Berserker not supporting below 1909 build windows
echo Recommanded:
echo Win 10:1909 for AMD RYZEN
echo Win 10:22H2, Win 11:22H2 for INTEL
pause
exit /b 0
) else (
goto :RR
)

:RR
fltmc >nul 2>&1 || (
    echo Administrator privileges are required.
    PowerShell Start -Verb RunAs '%0' 2> nul || (
        echo Right-click on the script and select "Run as administrator".
        pause & exit 1
    )
exit 0
)
dir "%windir%\BerserkerUsefulToolsV1.3" > nul 2>&1
if errorlevel 1 (
    goto Step1
) else (
    goto InterfaceUpdate
)

:Step1
cls
for /f "tokens=*" %%A in ('powershell -Command "Get-LocalUser | Where-Object { $_.Enabled -match 'True'} | Select-Object -ExpandProperty PrincipalSource"') do (
    set "is_microsoft_account=!user_info:*MicrosoftAccount*=!"

    if /i "%%A"=="MicrosoftAccount" (
        echo User is a Microsoft account. Use Local account instead if you want continue.
		timeout /t 3
		explorer.exe ms-settings:yourinfo
        Pause >Nul
		exit
    ) else (
        goto RPOINT
        pause
    )
)

:RPOINT
cls
echo.
echo.
echo.
Echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
Echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•    â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•    â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo.
echo. [1] Create Restore Point
echo. [2] Revert Point [ Revert All Tweaks ]
echo.
echo  [ Note ] If You No Create Restore Point, You Need Format Pc, Or Undo Values From Your Regedit C:
echo.
echo. [X] Open Interface
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Echo.
set /p input=:
if /i %input% == 1 goto restorepointcreate
if /i %input% == 2 goto ReverseTweaks
if /i %input% == X cls & goto Step2

) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto RPOINT

:restorepointcreate
cls
Echo.
Echo Creating [Restore Point]
Echo.
Echo The Name Restore Point Is [ Windows Wiouth Tweaks ]
timeout /t 2 >Nul /nobreak
cls
powershell -ExecutionPolicy Unrestricted -NoProfile Enable-ComputerRestore -Drive 'C:\' > nul
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "SystemRestorePointCreationFrequency" /t REG_DWORD /d 0 /f
powershell -ExecutionPolicy Unrestricted -NoProfile Checkpoint-Computer -Description 'Windows Without Tweaks'

Echo.
Echo [Restore Point] Create Correctly

Echo.
Echo [Press X When You Are In] [Create Restore Point]
timeout /t 2 >nul /nobreak
cls
goto RPOINT

:ReverseTweaks
cls
Echo.
Echo [Opening] Restore Point
cls
rstrui.exe
Echo.
Echo [ Press Secound Line ]
Echo [  And Select The Restore Point ]
Timeout /t 3 >Nul /nobreak
goto RPOINT

:Step2
cls
explorer.exe ms-settings:windowsdefender
echo.
echo    Disable Windows Defender before using tweaks
echo.
echo Press Enter To Continue
Pause >Nul
goto Resources2

:Resources2
cls
echo msgbox "Downloading Resources", vbInformation, "Berserker V2.0" > "%temp%\message.vbs"
cscript //nologo "%temp%\message.vbs"
del "%temp%\message.vbs"
cls
set "folder=BerserkerUsefulToolsV1.3"

dir "%folder%" > nul 2>&1

if errorlevel 1 (
   goto Downloadingresources
) else (
    goto CheckIfDownloadResources
)
:Downloadingresources
cls
set "file=BerserkerUsefulToolsV1.3.zip"
set "dest=C:\Windows"
powershell -Command "(New-Object System.Net.WebClient).DownloadFile('https://github.com/Montana211/Folder-Used-In-Utility-berserker-2/raw/main/BerserkerUsefulToolsV1.3.zip', '%file%')"
powershell -Command "Expand-Archive -Path '%file%' -DestinationPath '%dest%' -Force"
del /f "%file%"
mkdir "C:\ProgramData\Berserker-tasks"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\StartupOptimizer\discord-debloater.bat" "C:\ProgramData\Berserker-tasks"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\StartupOptimizer\hidediscorddebloater.bat" "C:\ProgramData\Berserker-tasks"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\StartupOptimizer\Startup Optimizer.bat" "C:\ProgramData\Berserker-tasks"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\StartupOptimizer\cleanup.bat" "C:\ProgramData\Berserker-tasks"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\NSudoLG.exe" "C:\Windows\"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\DevManView.exe" "C:\Windows\"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\DevManView.cfg" "C:\Windows\"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\devcon.exe"  "C:\Windows\"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\DeviceCleanup.exe" "C:\Windows\"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\SetTimerResolution.exe" "C:\Windows\"
rmdir /s /q "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\StartupOptimizer\CopyTaskbar"

:CheckIfDownloadResources
cls
set "folder=C:\Windows\BerserkerUsefulToolsV1.3"

dir "%folder%" > nul 2>&1

if errorlevel 1 (
    Echo.
    Echo.
    Echo  The Folder Does Not Exist
    timeout /nobreak /t 1 >Nul
    goto Downloadingresources
) else (
    Echo.
    Echo.
    Echo  The Folder Exists
    goto InterfaceUpdate
)

:InterfaceUpdate
cls
echo. %reset%
Echo  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo  â”‚
echo  â”‚     â€¢ Also In All Menu Press "E" To Back Here
echo  â”‚
echo  â”‚ [1] â€¢ Explication Menu
echo  â”‚
echo  â”‚ [2] â€¢ Disclaimers
echo  â”‚
echo  â”‚ [3] â€¢ About This Utility
echo  â”‚
echo  â”‚ [4] â€¢ Updates^? When
echo  â”‚
echo  â”‚ [5] â€¢ Berserker Interface
echo  â”‚
echo  â”‚ [6] â€¢ Guides, Channels, Servers
echo  â”‚
echo  â”‚ [7] â€¢ Credits / Tweaks
echo  â”‚     â€¢ Credits From Utility
Echo  â”‚     â€¢ [The Credits Are In The Same Box]
echo  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Echo.

set /p input=:
if /i %input% == 1 goto ExplicationMenu
if /i %input% == 2 goto Disclaimers
if /i %input% == 3 goto AbountThisUtility
if /i %input% == 4 goto Updates
if /i %input% == 5 goto TweaksWindowsInterface
if /i %input% == 6 goto GuidesLot
if /i %input% == 7 goto CreditsThanks
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto InterfaceUpdate

:ExplicationMenu
cls
echo.
echo â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—        
echo â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘    
echo â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â•šâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘        
echo â–ˆâ–ˆâ•”â•â•â•   â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘       
echo â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘       
echo â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•                                                                                                                                                                                                                                                                                                             
echo.
echo  This Utility It Is Made Up At first With 8 Shapes
echo  That You Can Find By Pressing "E", Each Of Them Takes
echo  You To A Different Place With This File Bach By Pressing "1,2,3,4,5,6,7,8"
echo  If You Have Any Inconvenience, Talk To The Discord Server
echo  [ Admin, Owner, Or Server People ]
echo.
echo  Type [E] To Back From The Other Menu
Echo.
set /p input=:
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto ExplicationMenu




:Disclaimers
cls
Echo.
Echo                 Please Read.
Echo.
Echo     %green%  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Echo     %green%  â”‚ %red%^> Disclaimers%green%                                                   â”‚
Echo     %green%  â”‚ â€¢ Your responsibility that you execute from this utility.       â”‚
Echo     %green%  â”‚ â€¢ It is not guaranteed to be the same on all PCs.               â”‚
Echo     %green%  â”‚ â€¢ Create a restore point to avoid problems in your system.      â”‚
Echo     %green%  â”‚ â€¢ Understand that all PCs are totally different.                â”‚
Echo     %green%  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜%reset%
echo.
echo                   %red% Others Disclaimers From This Utilty
echo.
echo     %green%â€¢%red% I am not responsible for any problems with your pc this may cause,  ^<
echo     %green%â€¢%red% For this reason from the beginning of the .bat an automatic restore point  ^<
echo     %green%â€¢%red% Type numbers/to select your options  ^<
echo     %green%â€¢%red% Remember that this is a 100% free program if one person selling this they robbed you ^<
echo     %green%â€¢%red% This .bat version is stable so everything works ^<
echo     %green%â€¢%red% And are satisfied with the results.  ^< %reset%
Echo.
echo                    Type [E] To Back From The Other Menu
Echo.
:input2
Echo.
set /p input=:
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto Disclaimers


:AbountThisUtility
cls
echo  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo  â”‚ ^> â€¢ More Than 5/4 i think months to do this I hope You Enjoy It   â”‚
echo  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜%reset%
echo Type [E] To Back From The Other Menu
Echo.
set /p input=:
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto AbountThisUtility

:Updates
cls
echo â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
echo â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â•šâ•â•â•â•â–ˆâ–ˆâ•—
echo â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–„â–ˆâ–ˆâ–ˆâ•”â•
echo â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â•â–€â–€â•â•â•
echo â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•—
echo  â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•     â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•      â•šâ•â•
echo.
echo  If Exits Problems With The Utility Tell In Discord Server
echo  And Here Is Update If I Need Change Or Add More Tweaks I Update
echo  If One Persons Resquest One Tweak And If I Test And It's Fine
echo  I Can Add These Tweak And Here Is Update And Lot Times Maybe Updates
echo  Maybe I Create One [ Channel Update Catalog ]
echo.
echo  Type [E] To Back From The Other Menu
Echo.
set /p input=:
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto Updates


:GuidesLot
cls
echo.
echo.
Echo â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
Echo â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘
Echo â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘       â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
Echo â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•    â•šâ•â•        â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [1] Calyptoâ€™s Latency   [3] Gaming Guide  [5] Melody Tweaks [7] Alchemy Channel
echo.
echo [2] Amitxv Guide        [4] TYT Guide     [6] Timings Ram   [8] BCD Guide
echo.
Echo.
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Echo.
Echo.
set /p input=:
if /i %input% == 1 goto link1
if /i %input% == 2 goto link2
if /i %input% == 3 goto link3
if /i %input% == 4 goto link4
if /i %input% == 5 goto link5
if /i %input% == 6 goto link6
if /i %input% == 7 goto link7
if /i %input% == 8 goto link8
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto GuidesLot

:link1
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://docs.google.com/document/d/1c2-lUJq74wuYK1WrA_bIvgb89dUN0sj8-hO3vqmrau4/edit
Echo.
Echo Already Opened [ Bye ]
timeout /t 1 >Nul /nobreak
cls
goto GuidesLot

:link2
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://github.com/dougg0k/gaming_os_tweaker
Echo.
Echo Already Opened [ Bye ]
timeout /t 1 >Nul /nobreak
cls
goto GuidesLot

:link3
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://sites.google.com/view/melodystweaks/basictweaks
Echo.
Echo Already Opened [ Bye ]
timeout /t 1 >Nul /nobreak
cls
goto GuidesLot

:link4
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://www.youtube.com/@ALCHEMYTWEAKS
Echo.
Echo Already Opened [ Bye ]
timeout /t 1 >Nul /nobreak
cls
goto GuidesLot

:link5
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://github.com/amitxv/PC-Tuning/blob/main/docs/research.md
Echo.
Echo Already Opened [ Bye ]
timeout /t 2 >Nul /nobreak
cls
goto GuidesLot

:link6
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://docs.google.com/document/d/1tnezBZcGkm04YfhoDgfPQ2XK-IUDmIiqmNR43TBo6Ns/edit
Echo.
Echo Already Opened [ Bye ]
timeout /t 2 >Nul /nobreak
cls
goto GuidesLot

:link7
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://github.com/integralfx/MemTestHelper/blob/oc-guide/DDR4%20OC%20Guide.md#tightening-timings
Echo.
Echo Already Opened [ Bye ]
timeout /t 2 >Nul /nobreak
cls
goto GuidesLot

:link8
ECHO.
echo [Opening In One Page From Your Navegator]
timeout /t 2 >Nul /nobreak
start https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/devtest/bcdedit--set.md
Echo.
Echo Already Opened [ Bye ]
timeout /t 1 >Nul /nobreak
cls
goto GuidesLot


:CreditsThanks
cls
echo.
echo.
Echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
Echo  â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘    â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•
Echo  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
Echo  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•
Echo  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•    â•šâ•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•       â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•â•â•â•â•     â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo                             ^< Credits From Utility Thanks For Everyone For Waiting All Time To Create This ^>
echo.
echo.
ECHO                             ^< Friends Changes ^>
echo.
echo   %green%â€¢%reset%  Utility, Interface By Owner Server                       %green%â€¢%reset% Update By Blitz^_ [ Place Movement Accommodate And Add Colors ]
echo.
echo   %green%â€¢%reset%  Tweaks By Owner, Petiga, Soon More,                      %green%â€¢%reset% Blitz^_ [ Helped Me A Lot To Make This Project ]
echo.
echo   %green%â€¢%reset%  Bliz^_, Catbutter09 Reduce The Placebo                    %green%â€¢%reset% Catbutter09 Organizated Tweaks
echo.
echo   %green%â€¢%reset%  Petiga, Catbutte09, Blitz^_ Tester From This Utility      %green%â€¢%reset% Blitz^_ Created The New Part Debloat
echo.
echo   %green%â€¢%reset% Catbutter09 - Fullscreen Optimization - Fix Uncapped fps  %green%â€¢%reset% gsard. [ Nvidia Tweaks Tested ]  
echo.
echo   %green%â€¢%reset% Alchemy, Give The Fix, No Internet Icon In The Tray      
echo.
echo                           ^< Old Project, Team Berserker ^>
echo.
echo.                                                                         
echo   %green%â€¢%reset% Dalla Tested Some Things, Nips [ Nips Are For Nvidia ]     %green%â€¢%reset% Malte  Give One Nip. [ I Added To Nvidia Part ]
echo.
echo                           ^< Credits From Tweaks Used Here In The Utility ^>
echo.
echo   %green%â€¢%reset% Hone - Cpu Affinity                                     %green%â€¢%reset% Dougg0k  [ Audio Tweaks ]          
echo.
echo   %green%â€¢%reset% O^&O ShutUp 10 And O^&O AppBuster  For Apps Thanks  
echo.
echo.
echo                                ^< Credits by MAD.BAT / Creator Dispositial File ^>
echo.
echo  %green%â€¢%reset% Taskbar Settings                                           %green%â€¢%reset% New Network Changes, With Information 
echo.
echo  %green%â€¢%reset% Added More Disable, Services  
echo.          
echo  %green%â€¢%reset% Lot Information Files In Github  ^/ Amit Guide         
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo                                              Type [E] To Back From The Other Menu              
set /p input=:
if /i %input% == E cls & goto InterfaceUpdate
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:RedirectMenu
cls
goto CreditsThanks

:TweaksWindowsInterface
cls
echo  â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„   â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„   â–„â–„â–„   â–„ â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„      â–„â–„â–„â–„â–„â–„â–„      â–„â–„â–„â–„â–„â–„â–„ 
echo â–ˆ  â–„    â–ˆ       â–ˆ   â–„  â–ˆ â–ˆ       â–ˆ       â–ˆ   â–„  â–ˆ â–ˆ   â–ˆ â–ˆ â–ˆ       â–ˆ   â–„  â–ˆ    â–ˆ       â–ˆ    â–ˆ  â–„    â–ˆ
echo â–ˆ â–ˆâ–„â–ˆ   â–ˆ    â–„â–„â–„â–ˆ  â–ˆ â–ˆ â–ˆ â–ˆ  â–„â–„â–„â–„â–„â–ˆ    â–„â–„â–„â–ˆ  â–ˆ â–ˆ â–ˆ â–ˆ   â–ˆâ–„â–ˆ â–ˆ    â–„â–„â–„â–ˆ  â–ˆ â–ˆ â–ˆ    â–ˆâ–„â–„â–„â–„   â–ˆ    â–ˆ â–ˆ â–ˆ   â–ˆ
echo â–ˆ       â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆâ–„â–„â–ˆâ–„â–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆâ–„â–„â–ˆâ–„â–ˆ      â–„â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆâ–„â–„â–ˆâ–„    â–„â–„â–„â–„â–ˆ  â–ˆ    â–ˆ â–ˆ â–ˆ   â–ˆ
echo â–ˆ  â–„   â–ˆâ–ˆ    â–„â–„â–„â–ˆ    â–„â–„  â–ˆâ–„â–„â–„â–„â–„  â–ˆ    â–„â–„â–„â–ˆ    â–„â–„  â–ˆ     â–ˆâ–„â–ˆ    â–„â–„â–„â–ˆ    â–„â–„  â–ˆ  â–ˆ â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„ â–ˆ â–ˆâ–„â–ˆ   â–ˆ
echo â–ˆ â–ˆâ–„â–ˆ   â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆ  â–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆ â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆ  â–ˆ â–ˆ    â–„  â–ˆ   â–ˆâ–„â–„â–„â–ˆ   â–ˆ  â–ˆ â–ˆ  â–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆ   â–ˆâ–ˆ       â–ˆ
echo â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–ˆ  â–ˆâ–„â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–ˆ  â–ˆâ–„â–ˆâ–„â–„â–„â–ˆ â–ˆâ–„â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–ˆ  â–ˆâ–„â–ˆ  â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–„â–„â–ˆâ–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆ
Echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo     [1] Windows Tweaks                          [12] Disable Services and Drivers
echo     [2] Device Manager                          [13] Start Menu            ^/(Saves a lot of RAM) ^/ OpenShell
echo     [3] FSO, FSE Mode                           [14] Clean Windows         ^/All Temporaly   ^/ Files And Useless Files
echo     [4] Network Tweaks                          [15] Audio Latency         ^/ Using Github Program
echo     [5] Security Tweaks                         [16] %red%AMD Tweaks%Reset%
echo     [6] Disable PowerSaving (Desktop)           [17] %blue%Tweaks Intel%reset%
echo     [7] Debloat [Windows, OEM]                  [18] %green%Nvidia%reset%
echo     [8] Programs Tweaks [Also Debloat]          [19] Timer Resolution 0.5ms
echo     [9] Windows Update                          
echo    [10] Set Your AutoGpuAffinity                                        
echo. 
Echo           Type [X] To Toolbox Menu             %green%[ Toolbox To Install Programs ]%reset%
echo           Type [E] To Back From The Other Menu
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i "%input%" ==  "E"   goto InterfaceUpdate
if /i "%input%" ==  "X"   goto ToolBox
if /i "%input%" ==  "1"   goto Allinone
if /i "%input%" ==  "2"   goto DeviceManager
if /i "%input%" ==  "3"   goto FSO
if /i "%input%" ==  "4"   goto Network
if /i "%input%" ==  "5"   goto SecurityTweaks
if /i "%input%" ==  "6"   goto PowerSavingss
if /i "%input%" ==  "7"   goto DebloatWindows
if /i "%input%" ==  "8"   goto DebloatPrograms
if /i "%input%" ==  "9"   goto WindowsUpdat
if /i "%input%" == "10"   goto AutoGpuAffinity
if /i "%input%" == "12"   goto DisbleServc
if /i "%input%" == "13"   goto TaskbarCustom
if /i "%input%" == "14"   goto CleanWindows
if /i "%input%" == "15"   goto AppsForAudioLatency
if /i "%input%" == "16"   goto AMDInterface
if /i "%input%" == "17"   goto TweaksIntel
if /i "%input%" == "18"   goto Nvidia
if /i "%input%" == "19"   goto TimerResolution

) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu

:idk.
cls
echo idk soon.
pause TweaksWindowsInterface

:RedirectMenu
cls
goto TweaksWindowsInterface

:TimerResolution
cls
echo.
echo                       %red%^< TimerResolution Compatibility 1909, Windows server, Win11 ^>%reset%
ECHO.
CHOICE /C YN /M "Enable TimerResolution 0.5000ms? (Y = Enable, N = Disable) (Consumes more power on laptops, can reduce latency)"
IF %ERRORLEVEL% EQU 1 (
taskkill /f /im SetTimerResolution.exe
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "TimerResolution" /t REG_SZ /d "C:\Windows\SetTimerResolution.exe --resolution 5000 --no-console" /f
start "" "C:\Windows\SetTimerResolution.exe" --resolution 5000 --no-console
) else (
taskkill /f /im SetTimerResolution.exe
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "TimerResolution" /f
)
echo.
echo Press Enter To Go Berserker Interface.
Pause > Nul
goto TweaksWindowsInterface

:DeviceManager
cls
echo                     [Device Manager]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo.
echo.
echo          [1] Cleanup from old/unused Devices Drivers
echo          [2] Disable Unnecessary Devices
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if "%input%"=="" goto DeviceManager
if /i %input% == 1 goto CleanDevices
if /i %input% == 2 goto DisableDevices
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DeviceManager



:CleanDevices
devicecleanup * -s -m:7d
echo all old/unused devices drivers removed Press any key to go to Tweaking interface
Pause > Nul
goto TweaksWindowsInterface

:DisableDevices
cls
devmanview /disable "AMD PSP"
devmanview /disable "AMD SMBus"
devmanview /disable "Microsoft Kernel Debug Network Adapter"
devmanview /disable "High Precision Event Timer"
devmanview /disable "Legacy device"
devmanview /disable "Numeric data processor"
devmanview /disable "System timer"
devmanview /disable "System speaker"
devmanview /disable "WAN Miniport (IKEv2)"
devmanview /disable "WAN Miniport (IP)"
devmanview /disable "WAN Miniport (IPv6)"
devmanview /disable "WAN Miniport (L2TP)"
devmanview /disable "WAN Miniport (Network Monitor)"
devmanview /disable "WAN Miniport (PPPOE)"
devmanview /disable "WAN Miniport (PPTP)"
devmanview /disable "WAN Miniport (SSTP)"
devmanview /disable "Programmable Interrupt Controller"
devmanview /disable "Composite Bus Enumerator"
devmanview /disable "Microsoft GS Wavetable Synth"
devmanview /disable "Microsoft Virtual Drive Enumerator"
devmanview /disable "NDIS Virtual Network Adapter Enumerator"
devmanview /disable "Microsoft Print to PDF"
devmanview /disable "UMBus Root Bus Enumerator"
devmanview /disable "Direct memory access controller"
devmanview /disable "Motherboard resources"
devmanview /disable "Base SYSTEM Device"
devmanview /disable "PCI Memory Controller"
devmanview /disable "SM Bus Controller"
devmanview /disable "PCI Data Acquisition and Signal Processing Controller"
devmanview /disable "PCI Simple Communications Controller"
devmanview /disable "Microsoft Storage Spaces Controller"
devmanview /disable "Unknown device"
devmanview /disable "Intel Management Engine"
devmanview /disable "PCI Encryption/Decryption Controller"
devmanview /disable "PCI Device"
devmanview /disable "Microsoft ISATAP Adapter"
devmanview /disable "Remote Dekstop Device Redirector Bus"
devmanview /disable "Microsoft Hyper-V Virtualization Infrastructure Driver"
devmanview /disable "Microsoft UEFI-Compliant SYSTEM"
devmanview /disable "Programmable Interrupt Controller"
devmanview /disable "Communications Port (COM1)"
devmanview /disable "Communications Port (COM2)"
devmanview /disable "Communications Port (SER1)"
devmanview /disable "Communications Port (SER2)"
devmanview /disable "SYSTEM board"
devmanview /disable "Microsoft RRAS Root Enumerator"
devmanview /disable "Microsoft Device Association Root Enumerator"
devmanview /disable "Microsoft Radio Device Enumeration Bus"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c devmanview /disable "System CMOS/real time clock"
devcon disable ACPI\HP*
devcon disable ACPI\MSFT01*
reg query HKLM\SYSTEM\CurrentControlSet\Control\Class\{72631E54-78A4-11D0-BCF7-00AA00B7B32A}\0000 >nul
if %errorlevel% equ 1 (
devmanview /disable "ACPI Processor Aggregator"
devmanview /disable "Microsoft Windows Management Interface for ACPI"
)
echo all unneccesary devices disabled Press any key to go to Tweaking interface
Pause > Nul
goto TweaksWindowsInterface

:WindowsUpdat
cls
CHOICE /C YN /M "Disable Windows Update? (Y = Disable, N = Enable)"
IF %ERRORLEVEL% EQU 1 (
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "DisableWUfBSafeguards" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "ExcludeWUDriversInQualityUpdate" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersionInfo" /t REG_SZ /d "22H2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersion" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "NoAutoUpdate" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "SetUpdateNotificationLevel" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "SetDisableUXWUAccess" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "NoAutoUpdate" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AUOptions" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AlwaysAutoRebootAtScheduledTime" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AutoInstallMinorUpdates" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "EnableFeaturedSoftware" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "IncludeRecommendedUpdates" /t REG_DWORD /d "0" /f
schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\Scheduled Start" /Disable
schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\RUXIM\PLUGScheduler" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Report policies" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Scan" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Scan Static Task" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Work" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\UpdateModelTask" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Start Oobe Expedite Work" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScan_LicenseAccepted" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScanAfterUpdate" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\USO_UxBroker" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\UUS Failover Task" /Disable
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\MoUsoCoreWorker.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\MusNotification.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\UsoClient.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\usocoreworker.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\System\CurrentControlSet\Services\UsoSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v "DontOfferThroughWUAU" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "4" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator" /v "EnhancedShutdownEnabled" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator" /v "ShutdownFlyoutOptions" /f
) else (
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "DisableWUfBSafeguards" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "ExcludeWUDriversInQualityUpdate" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersionInfo" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "TargetReleaseVersion" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "NoAutoUpdate" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "SetUpdateNotificationLevel" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v "SetDisableUXWUAccess" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "NoAutoUpdate" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AUOptions" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AutoInstallMinorUpdates" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "EnableFeaturedSoftware" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "IncludeRecommendedUpdates" /f
schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\Scheduled Start" /Enable
schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\RUXIM\PLUGScheduler" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Report policies" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Scan" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Scan Static Task" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Schedule Work" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\UpdateModelTask" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\Start Oobe Expedite Work" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScan_LicenseAccepted" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\StartOobeAppsScanAfterUpdate" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\USO_UxBroker" /Enable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\UpdateOrchestrator\UUS Failover Task" /Enable
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\MoUsoCoreWorker.exe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\MusNotification.exe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\UsoClient.exe" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\usocoreworker.exe" /f
reg add "HKLM\System\CurrentControlSet\Services\UsoSvc" /v "Start" /t REG_DWORD /d "3" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\MRT" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "3" /f
)
echo.
echo Press Enter To Go Berserker Interface.
Pause > Nul
goto TweaksWindowsInterface

:PowerSavingss
cls
CHOICE /C YN /M "Disable PowerSavings?"
IF %ERRORLEVEL% EQU 1 (
    powercfg -import "C:\Windows\BerserkerUsefulTools\PowerPlans\Berserker V3.pow" 33333333-3333-3333-3333-333333333333
        powercfg -setactive 33333333-3333-3333-3333-333333333333
    devmanview /disable "ACPI Processor Aggregator" >nul 2>&1
    devmanview /disable "Microsoft Windows Management Interface for ACPI" >nul 2>&1
    reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling" /v "PowerThrottlingOff" /t REG_DWORD /d "1" /f
    reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Storage" /v "StorageD3InModernStandby" /t REG_DWORD /d "0" /f
    for %%i in (EnableHIPM EnableDIPM EnableHDDParking) do for /f %%a in ('reg query "HKLM\SYSTEM\CurrentControlSet\Services" /s /f "%%i" ^| findstr "HKEY"') do (
        reg add "%%a" /v "%%i" /t REG_DWORD /d "0" /f
    )
    for /f "tokens=*" %%i in ('reg query "HKLM\SYSTEM\CurrentControlSet\Enum" /s /f "StorPort" ^| findstr "StorPort"') do (
        reg add "%%i" /v "EnableIdlePowerManagement" /t REG_DWORD /d "0" /f
    )
    reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme\Parameters\Device" /v "IdlePowerMode" /t REG_DWORD /d "0" /f > nul 2> nul
    for %%g in (
        EnhancedPowerManagementEnabled
        AllowIdleIrpInD3
        EnableSelectiveSuspend
        DeviceSelectiveSuspended
        SelectiveSuspendEnabled
        SelectiveSuspendOn
        WaitWakeEnabled
        D3ColdSupported
        WdfDirectedPowerTransitionEnable
        EnableIdlePowerManagement
        IdleInWorkingState
    ) do for /f "delims=" %%b in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum" /s /f "%%g" ^| findstr "HKEY"') do reg add "%%b" /v "%%g" /t REG_DWORD /d "0" /f
    reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "SleepStudyDisabled" /t REG_DWORD /d "1" /f
)
for /f %%i in ('wmic path Win32_USBController get PNPDeviceID') do set "str=%%i" & (
    reg add "HKLM\System\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePriority" /f
    reg add "HKLM\System\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f
)
for /f %%i in ('wmic path Win32_IDEController get PNPDeviceID 2^>nul') do set "str=%%i" & if "!str:PCI\VEN_=!" neq "!str!" (
    reg add "HKLM\System\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePriority" /f
) else (
for /F "tokens=*" %%A in ('powercfg -devicequery wake_armed') do powercfg -devicedisablewake "%%A"
    devmanview /enable "ACPI Processor Aggregator" >nul 2>&1
    devmanview /enable "Microsoft Windows Management Interface for ACPI" >nul 2>&1
    reg delete "HKLM\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling" /v "PowerThrottlingOff" /f
    reg delete "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Storage" /v "StorageD3InModernStandby" /f
    for %%i in (EnableHIPM EnableDIPM EnableHDDParking) do for /f %%a in ('reg query "HKLM\SYSTEM\CurrentControlSet\Services" /s /f "%%i" ^| findstr "HKEY"') do (
        reg add "%%a" /v "%%i" /t REG_DWORD /d "1" /f
    )
    for /f "tokens=*" %%i in ('reg query "HKLM\SYSTEM\CurrentControlSet\Enum" /s /f "StorPort" ^| findstr "StorPort"') do (
        reg add "%%i" /v "EnableIdlePowerManagement" /t REG_DWORD /d "1" /f
    )
    reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme\Parameters\Device" /v "IdlePowerMode" /t REG_DWORD /d "1" /f > nul 2> nul
    reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f
    reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePriority" /t REG_DWORD /d "0" /f
echo Press Enter To Go Berserker Interface.
Pause > Nul
goto TweaksWindowsInterface
)
:Allinone
cls
echo                                          [Windows Tweaks]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  [1] Telemetry Remove (use local account for this)   [22] Prevent Audio Priority change
echo  [2] Optimize Task Scheduler                         [23] Disable Archive unused ms store apps Windows 11
echo  [3] Windows Features Tweaks                         [24] Disable VulnerableDriverBlocklist Windows 11
echo  [4] Explorer Optimize                               [25] Block Cleanup unusued preinstalled languages
echo  [5] Bcdedit Optimize                                [26] Unlock Timer Resolution Windows 11
echo  [6] Disable Autologger                              [27] Gamebar Disable
echo  [7] BSoD Tweaks (shows error code)                  [28] mobsync.exe Disable  
echo  [8] Mouse Acceleration Disable                      [29] Set Sound Communications to "Do nothing"
echo  [9] Optimize game launchers, system by priority set [30] remove "include in library" context menu
echo  [10] Optimize HyperThreading                        [31] remove pin to start context menu
echo  [11] Optimize Msi Mode                              [32] remove pin to quick access context menu
echo  [12] Disable Ram Compression, Page Executive        [33] remove "send to" from context menu
echo  [13] Accessability Tweaks                           [34] Disable bad Driver check for hw protection
echo  [14] Hibernation Disable                            [35] Disable Disk Checkup
echo  [15] Disk Tweaks                                    [36] ProtectionMode Disk Disable
echo  [16] Optimize Count Processes Svchost               [37] Hardware-Accelerated Gpu Scheduling Enable (22h2)
echo  [17] Remove Print Context menu                      [38] Startup Optimizer [optimizes services on startup and more]
echo  [18] Remove "rotate right, rotate left" context menu[39] Win32Saparation set to 26
echo  [19] Kernel, Memory Managment Tweaks                [40] Disable Logon Background Image
echo  [20] add powerplan .pow using context menu          [41] Speech model disable
echo  [21] Classic Context Menu for Windows 11            [42] languaged packs and features install disable
Echo                                                      [43] DiskQuota Disable
echo                                                      [44] Disable (not needed) WaaSMedicSvc
echo             Type [X] To Back First Page              [45] Unlock Internet Explorer
echo            Type [E] To Back From The Other Menu      %yellow%[46] Apply all%reset%
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto TelemetryRemove
if /i %input% == 2 goto taskschdOptimize
if /i %input% == 3 goto FeaturesOptimize
if /i %input% == 4 goto ExplorerOptimize
if /i %input% == 5 goto BcdeditOptimize
if /i %input% == 6 goto DisableAutologger
if /i %input% == 7 goto BSoDTweaks
if /i %input% == 8 goto MouseAcc
if /i %input% == 9 goto GameLaunchPrio
if /i %input% == 10 goto HyperThreadingOpti
if /i %input% == 11 goto MsiModeOpti
if /i %input% == 12 goto MMAgentOpti
if /i %input% == 13 goto AccTweaks
if /i %input% == 14 goto HibDisable
if /i %input% == 15 goto DiskTweaks
if /i %input% == 16 goto SvchostTweaks
if /i %input% == 17 goto PrintContext
if /i %input% == 18 goto RotateContext
if /i %input% == 19 goto KernelMemoryTweaks
if /i %input% == 20 goto PowerPlanContext
if /i %input% == 21 goto ClassicContextW11
if /i %input% == 22 goto OtherSvchostAudio
if /i %input% == 23 goto DisableArchive
if /i %input% == 24 goto VulnarableDisable
if /i %input% == 25 goto BlockCleanup
if /i %input% == 26 goto TimerResW11
if /i %input% == 27 goto GamebarDisable
if /i %input% == 28 goto mobsyncDisable
if /i %input% == 29 goto setnothing
if /i %input% == 30 goto libcontext
if /i %input% == 31 goto pintostart
if /i %input% == 32 goto pintoquick
if /i %input% == 33 goto SendTo
if /i %input% == 34 goto BadDriver
if /i %input% == 35 goto DiskCheckup
if /i %input% == 36 goto ProtectionDisk
if /i %input% == 37 goto HwSch
if /i %input% == 38 goto StartupOpti
if /i %input% == 39 goto Win32Sapa
if /i %input% == 40 goto DisableLogonImage
if /i %input% == 41 goto SpeechModelDisable
if /i %input% == 42 goto langpackdisable
if /i %input% == 43 goto DiskQuotadisable
if /i %input% == 44 goto WaaSDisable
if /i %input% == 45 goto UnlockIE
if /i %input% == 46 goto ApplyAllInOne
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto Allinone

:TelemetryRemove
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete DiagTrack
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete dmwappushservice
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete diagnosticshub.standardcollector.service
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete diagsvc
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\DeviceCensus.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\CompatTelRunner.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowDeviceNameInTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "DoNotShowFeedbackNotifications" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows" /v "CEIPEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AITEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableEngine" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableInventory" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisablePCA" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableUAR" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "MaxTelemetryAllowed" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform" /v "NoGenTicket" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Consent" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontSendAdditionalData" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontShowUI" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "LoggingDisabled" /t REG_DWORD /d 1 /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Consent" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontSendAdditionalData" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontShowUI" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "LoggingDisabled" /t REG_DWORD /d 1 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete WerSvc
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete wercplsupport
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "DontSearchWindowsUpdate" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "DriverUpdateWizardWuSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "SearchOrderConfig" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\picturesLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\videosLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocation" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocationScripting" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableWindowsLocationProvider" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "HistoryViewEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "DeviceHistoryEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCloudSearch" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortana" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortanaAboveLock" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowSearchToUseLocation" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaConsent" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "BingSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "BackgroundAppGlobalToggle" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCortanaButton" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OemPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RemediationRequired" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenOverlayEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SlideshowEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SoftLandingEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-202914Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-280815Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314559Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314563Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-88000326Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete WbioSrvc
reg add "HKLM\SOFTWARE\Microsoft\WindowsSelfHost\UI\Visibility" /v "HideInsiderPage" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\AppSync" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Language" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Personalization\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Microsoft\Personalization\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Siuf\Rules" /v "NumberOfSIUFInPeriod" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg delete "HKLM\Software\Microsoft\InputPersonalization" /v "Installed" /f
reg add "HKLM\Software\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg delete "HKLM\Software\Microsoft\InputPersonalization" /v "Shutdown" /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config" /v "AutoConnectAllowedOEM" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackProgs" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Input\TIPC" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Input\TIPC" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "AllowBlockingAppsAtShutdown" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "AllowDomainPINLogon" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "DisableAcrylicBackgroundOnLogon" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "DisableHHDEP" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableActivityFeed" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableCdp" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableMmx" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "PublishUserActivities" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "UploadUserActivities" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowFullControl" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowToGetHelp" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fEnableChatControl" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\LSA" /v "RestrictAnonymous" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\WCN\UI" /v "DisableWcnUi" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "AllowOnlineTips" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "NoUseStoreOpenWith" /t REG_DWORD /d 1 /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device" /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device User" /f
schtasks /delete /TN "Microsoft\Windows\Device Information" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /f
schtasks /change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /disable
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\AitAgent" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\MareBackup" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\PcaPatchDbTask" /f
schtasks /delete /TN "Microsoft\Windows\Autochk\Proxy" /f
schtasks /delete /TN "Microsoft\Windows\Autochk" /f
schtasks /delete /TN "Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClient" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf" /f
schtasks /delete /TN "Microsoft\Windows\Feedback" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings\RefreshCache" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings" /f
schtasks /delete /TN "Microsoft\Windows\Flighting" /f
schtasks /delete /TN "Microsoft\Windows\Input\InputSettingsRestoreDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\LocalUserSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\MouseSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\TouchpadSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
schtasks /delete /TN "Microsoft\Windows\Location\Notifications" /f
schtasks /delete /TN "Microsoft\Windows\Location\WindowsActionDialog" /f
schtasks /delete /TN "Microsoft\Windows\Location" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance\WinSAT" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance" /f
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /Delete /TN "Microsoft\Windows\RetailDemo\CleanupOfflineContent" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo" /F
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\TaskScheduler" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
setx POWERSHELL_TELEMETRY_OPTOUT 1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "PrivacyConsentPresentationVersion" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "PrivacyConsentSettingsVersion" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaIsReplaceable" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaIsReplaced" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Id" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v "DisabledByGroupPolicy" /t REG_DWORD /d "1" /f
reg add "HKCU\Control Panel\International\User Profile" /v "HttpAcceptLanguageOptOut" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Policies\Microsoft\Windows\OOBE" /v "DisablePrivacyExperience" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OOBE" /v "DisablePrivacyExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Control Panel\International" /v "TurnOffHighlightMisspelledWords" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Control Panel\International" /v "TurnOffAutocorrectMisspelledWords" /t REG_DWORD /d "1" /f
sc config cplspcon start= disabled
sc config ihi_service start= disabled
sc config igccservice start= disabled
sc config LMS start= disabled
sc config WMIRegistrationService start= disabled
sc config DSAService start= disabled
sc config DSAUpdateService start= disabled
sc config ESRV_SVC_QUEENCREEK start= disabled
sc config SystemUsageReportSvc_QUEENCREEK start= disabled
sc config USER_ESRV_SVC_QUEENCREEK start= disabled
sc config "Intel(R) SUR QC SAM" start= disabled
sc config XTU3Service start= demand
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "NoStartMenuHelp" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "DeviceDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_0" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_1" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_2" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_3" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_4" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v "ScoobeSystemSettingEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowSyncProviderNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "ConfigureWindowsSpotlight" /t REG_DWORD /d "2" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightFeatures" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnActionCenter" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightWindowsWelcomeExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "IncludeEnterpriseSpotlight" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableThirdPartySuggestions" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsAADCloudSearchEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsDeviceSearchHistoryEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsMSACloudSearchEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCloudSearch" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortana" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortanaAboveLock" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowSearchToUseLocation" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v "GlobalUserDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\Settings\AllowOnlineTips" /v "value" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "NoConnectedUser" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization" /v "DODownloadMode" /t REG_DWORD /d "0" /f
wevtutil sl Microsoft-Windows-SleepStudy/Diagnostic /e:false >nul 2>&1
wevtutil sl Microsoft-Windows-Kernel-Processor-Power/Diagnostic /e:false >nul 2>&1
wevtutil sl Microsoft-Windows-UserModePowerService/Diagnostic /e:false >nul 2>&1
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3" /v "1806" /t "REG_DWORD" /d "0" /f > nul 2> nul
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Associations" /v "LowRiskFileTypes" /t REG_SZ /d ".txt;.zip;.rar;.nfo;.exe;.bat;.cmd;.reg;.msi;.htm;.html;.gif;.bmp;.jpg;.jpeg;.png;.tif;.tiff;.mp3;.wma;.wav;.ogg;.mid;.midi;.avi;.mpg;.mpeg;.mov;.wmv;.asf;.swf;.vob;.mp4;.flv;.f4v;.mkv;.m4v;.rm;.rmvb;.doc;.docx;.xls;.xlsx;.ppt;.pptx;.pdf;.vsd;.vsdx;.odt;.odp;.ods;.odg;.odc;.odb;.odf;.rtf" /f > nul 2> nul
w32tm /config /syncfromflags:manual /manualpeerlist:"0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org" >nul 2>nul
w32tm /config /update >nul 2>nul
w32tm /resync >nul 2>nul
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\ControlSet001\Control\Diagnostics\Performance" /v "DisableDiagnosticTracing" /t "REG_DWORD" /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v "AllowHeadlessExecution" /t "REG_DWORD" /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\msfeedssync.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
wmic product where name="Intel Driver && Support Assistant" uninstall
wmic product where name="Intel(R) Computing Improvement Program" uninstall
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Feeds" /v "ShellFeedsTaskbarViewMode" /t REG_DWORD /d "2" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableSpellchecking" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableTextPrediction" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnablePredictionSpaceInsertion" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableDoubleTapSpace" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableAutocorrection" /t REG_DWORD /d "0" /f
reg delete "HKLM\SYSTEM\ControlSet001\Control\Power" /v "EnergyEstimationEnabled" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\StorageHealth" /v "AllowDiskHealthModelUpdates" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Input\Settings" /v "HarvestContacts" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Input\Settings" /v "InsightsEnabled" /t REG_DWORD /d "0" /f
reg delete "HKCU\Software\Microsoft\input\Settings" /v "Insights" /f
reg add "HKCU\Software\Microsoft\input\Settings" /v "InsightsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Psched" /v "NonBestEffortLimit" /t REG_DWORD /d "10" /f
reg add "HKLM\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows\Psched" /v "NonBestEffortLimit" /t REG_DWORD /d "10" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Lsa" /v "disabledomaincreds" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Lsa" /v "restrictanonymous" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "CdpSessionUserAuthzPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "EnableRemoteLaunchToast" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "NearShareChannelUserAuthzPolicy" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "RomeSdkChannelUserAuthzPolicy" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "CdpUserSettingsVersion" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "EnableBackupForWin8Apps" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSync" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSyncUserOverride" /t REG_DWORD /d "1" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy" /v DisableQueryRemoteServer /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC" /v PreventHandwritingDataSharing /t REG_DWORD /d 1 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Diagnostics" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Appraiser" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\ClientTelemetry" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController" /f
for /f "delims=" %%b in ('reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels" /s /f "Enabled" ^| findstr "HKEY"') do reg add "%%b" /v "Enabled" /t REG_DWORD /d "0" /f
call "C:\Program Files\McAfee\WebAdvisor\uninstaller.exe" /s
rd /s /q "C:\Program Files\McAfee\WebAdvisor"
sc config SDRSVC start= disabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "NoAutoRebootWithLoggedOnUsers" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AlwaysAutoRebootAtScheduledTime" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DisableAutomaticRestartSignOn" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK" /t REG_DWORD /d "0" /f
Reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.SecurityAndMaintenance" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\FTH" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice" /v "AllowFindMyDevice" /t REG_DWORD /d "0" /f
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
  wusa /uninstall /kb:5005463 /quiet /norestart
  reg add "HKLM\SOFTWARE\Microsoft\PCHC" /v "PreviousUninstall" /t REG_DWORD /d "1" /f
) else (
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\graphicsCaptureProgrammatic" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\graphicsCaptureWithoutBorder" /v "Value" /t REG_SZ /d "Deny" /f
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
)
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync" /v "BackupPolicy" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync" /v "DeviceMetadataUploaded" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "MaintenanceDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "WakeUp" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\ScheduledDiagnostics" /v "EnabledExecution" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{1d27f844-3a1f-4410-85ac-14651078412d}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{e2bf9676-5f8f-435c-97eb-11607a5bedf7}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{596AB062-B4D2-4215-9F74-E9109B0A8153}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModelUnlock" /v "AllowDevelopmentWithoutDevLicense" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "SleepStudyDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\AboveLock" /v "AllowCortanaAboveLock" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\CloudDesktop" /v "BootToCloudMode" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Experience" /v "AllowCortana" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Settings" /v "AllowDataSense" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowLocation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowExperimentation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowTelemetry" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\WindowsInkWorkspace" /v "AllowWindowsInkWorkspace" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\TextInput" /v "AllowLinguisticDataCollection" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings" /v "DisableSendGenericDriverNotFoundToWER" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings" /v "DisableSendRequestAdditionalSoftwareToWER" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\MediaPlayer\Preferences" /v "UsageTracking" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\DriverDatabase\Policies\Settings" /v "DisableSendGenericDriverNotFoundToWER" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\DriverDatabase\Policies\Settings" /v "DisableSendRequestAdditionalSoftwareToWER" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization" /v "OptInOOBE" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Metadata" /v "PreventDeviceMetadataFromNetwork" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CreatorsUpdatePrivacySettings" /v "AutoSet" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CreatorsUpdatePrivacySettings" /v "ShowUI" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Census" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v "AllowNewsAndInterests" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\MDM" /v "DisableRegistration" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v "EnableFeeds" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsInkWorkspace" /v "AllowSuggestedAppsInWindowsInkWorkspace" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WinBio\AccountInfo" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\ScriptedDiagnosticsProvider" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "BluetoothPolicy" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "UserAuthPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "BluetoothPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "UserAuthPolicy" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ConnectedSearch" /v "ConnectedSearchUseWeb" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\16.0\common" /v "qmenable" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\16.0\common" /v "sendcustomerdata" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\common\clienttelemetry" /v "sendtelemetry" /t REG_DWORD /d "3" /f
reg add "HKCU\Software\Policies\Microsoft\TabletTip\1.7" /v "DisablePrediction" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\AppCompat" /v "DisablePCA" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightFeatures" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "ConfigureWindowsSpotlight" /t REG_DWORD /d "2" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "IncludeEnterpriseSpotlight" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightWindowsWelcomeExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnActionCenter" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CurrentVersion\QuietHours" /v "Enable" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "HidePeopleBar" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "EnableLegacyBalloonNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Network Connections" /v "NC_ShowSharedAccessUI" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Spelling\Options" /v "UserDictionaryMerged" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Spelling\Options" /v "UserDictionaryUploaded" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Cortana" /v "IsAvailable" /t REG_DWORD /d "0" /f
reg add "HKCU\Policies\Microsoft\Windows\CloudContent" /v "DisableTailoredExperiencesWithDiagnosticData" /t REG_DWORD /d "1" /f
reg delete "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "LegacyCortanaOn" /f
reg add "HKLM\SOFTWARE\Microsoft\Ole\AppCompat" /v "RequireIntegrityActivationAuthenticationLevel" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell" /v "BagMRU Size" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WinBio" /f
reg delete "HKLM\SOFTWARE\Microsoft\TelemetryClient" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "DisableTaggedEnergyLogging" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "TelemetryMaxApplication" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "TelemetryMaxTagPerApplication" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete RetailDemo
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RetailDemo" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete TroubleshootingSvc
wusa /uninstall /kb:4023057 /quiet /norestart
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22631 (
echo Windows 11 23H2 not detected. >nul 2>nul
) else (
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d "1" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownBuildNumber" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownUBR" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeAppsScanRun" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeMigrationComplete" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\USOShared\ScheduleTimeDump" /f
)
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Dsh" /v "IsPrelaunchEnabled" /f
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Dsh" /v "PrelaunchDelay" /f
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinSATMediaFiles-Package" ^| findstr "~~"') do (set "WinSAT=%%i")
if defined WinSAT (
		echo Removing %WinSAT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WinSAT% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /f
	) else (
		echo WinSAT not found, skipping.
	)
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"quiethours;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!quiethours;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"sync;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!sync;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search-permissions;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search-permissions;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"cortana-windowssearch;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!cortana-windowssearch;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search-moredetails;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search-moredetails;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-general;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-general;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-feedback;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-feedback;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-activityhistory;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-activityhistory;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-location;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-location;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-callhistory;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-callhistory;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-messaging;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-messaging;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-automaticfiledownloads;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-automaticfiledownloads;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"tabletmode;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!tabletmode;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"delivery-optimization;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!delivery-optimization;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"findmydevice;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!findmydevice;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"backup;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!backup;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"troubleshoot;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!troubleshoot;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"family-group;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!family-group;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"developers;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!developers;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"workplace;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!workplace;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"home;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!home;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Telemetry has removed. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:TaskschdOptimize
cls
schtasks /delete /TN "Microsoft\Windows\Device Information\Device" /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device User" /f
schtasks /delete /TN "Microsoft\Windows\Device Information" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /f
schtasks /change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /disable
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\AitAgent" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\MareBackup" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\PcaPatchDbTask" /f
schtasks /delete /TN "Microsoft\Windows\Autochk\Proxy" /f
schtasks /delete /TN "Microsoft\Windows\Autochk" /f
schtasks /delete /TN "Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClient" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf" /f
schtasks /delete /TN "Microsoft\Windows\Feedback" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings\RefreshCache" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings" /f
schtasks /delete /TN "Microsoft\Windows\Flighting" /f
schtasks /delete /TN "Microsoft\Windows\Input\InputSettingsRestoreDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\LocalUserSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\MouseSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\TouchpadSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\appuriverifierdaily" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\appuriverifierinstall" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\DsSvcCleanup" /disable
schtasks /delete /TN "Microsoft\Windows\AppListBackup\Backup" /f
schtasks /delete /TN "Microsoft\Windows\AppListBackup\BackupNonMaintenance" /f
schtasks /delete /TN "Microsoft\Windows\AppListBackup" /f
schtasks /change /TN "Microsoft\Windows\BrokerInfrastructure\BgTaskRegistrationMaintenanceTask" /disable
schtasks /change /TN "Microsoft\Windows\Chkdsk\ProactiveScan" /disable
schtasks /change /TN "Microsoft\Windows\CloudExperienceHost\CreateObjectTask" /disable
schtasks /change /TN "Microsoft\Windows\CloudRestore\Backup" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Check And Scan" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Scan" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Scan for Crash Recovery" /disable
schtasks /change /TN "Microsoft\Windows\Diagnosis\Scheduled" /disable
schtasks /change /TN "Microsoft\Windows\DiskCleanup\SilentCleanup" /disable
schtasks /change /TN "Microsoft\Windows\DiskFootprint\Diagnostics" /disable
schtasks /change /TN "Microsoft\Windows\DiskFootprint\StorageSense" /disable
schtasks /change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /disable
schtasks /change /TN "Microsoft\Windows\HelloFace\FODCleanupTask" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\RestoreDevice" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\ScanForUpdates" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\ScanForUpdatesAsUser" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\SmartRetry" /disable
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping > nul 2>&1
) else (
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownBuildNumber" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownUBR" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeAppsScanRun" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeMigrationComplete" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\USOShared\ScheduleTimeDump" /f
)
schtasks /change /TN "Microsoft\Windows\International\Synchronize Language Settings" /disable
schtasks /delete /TN "Microsoft\Windows\Location\Notifications" /f
schtasks /delete /TN "Microsoft\Windows\Location\WindowsActionDialog" /f
schtasks /delete /TN "Microsoft\Windows\Location" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance\WinSAT" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance" /f
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Cellular" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Logon" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\MdmDiagnosticsCleanup" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Retry" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\RunOnReboot" /disable
schtasks /change /TN "Microsoft\Windows\Maps\MapsToastTask" /disable
schtasks /change /TN "Microsoft\Windows\Maps\MapsUpdateTask" /disable
schtasks /change /TN "Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents" /disable
schtasks /change /TN "Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic" /disable
schtasks /change /TN "Microsoft\Windows\Mobile Broadband Accounts\MNO Metadata Parser" /disable
schtasks /change /TN "Microsoft\Windows\MUI\LPRemove" /disable
schtasks /change /TN "Microsoft\Windows\Multimedia\SystemSoundsService" /disable
schtasks /change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /disable
schtasks /change /TN "Microsoft\Windows\NlaSvc\WiFiTask" /disable
schtasks /change /TN "Microsoft\Windows\Offline Files\Background Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Offline Files\Logon Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Plug and Play\Sysprep Generalize Drivers" /disable
schtasks /delete /TN "Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem" /f
schtasks /delete /TN "Microsoft\Windows\Power Efficiency Diagnostics" /f
schtasks /change /TN "Microsoft\Windows\Printing\EduPrintProv" /disable
schtasks /change /TN "Microsoft\Windows\Printing\PrinterCleanupTask" /disable
schtasks /change /TN "Microsoft\Windows\Ras\MobilityManager" /disable
schtasks /change /TN "Microsoft\Windows\RecoveryEnvironment\VerifyWinRE" /disable
schtasks /change /TN "Microsoft\Windows\Registry\RegIdleBackup" /disable
schtasks /change /TN "Microsoft\Windows\RemoteAssistance\RemoteAssistanceTask" /disable
schtasks /change /TN "Microsoft\Windows\SettingSync\BackgroundUploadTask" /disable
schtasks /change /TN "Microsoft\Windows\SettingSync\NetworkStateChangeTask" /disable
schtasks /change /TN "Microsoft\Windows\Shell\FamilySafetyMonitor" /disable
schtasks /change /TN "Microsoft\Windows\Shell\FamilySafetyRefreshTask" /disable
schtasks /change /TN "Microsoft\Windows\Shell\IndexerAutomaticMaintenance" /disable
schtasks /change /TN "Microsoft\Windows\Shell\ThemesSyncedImageDownload" /disable
schtasks /change /TN "Microsoft\Windows\Shell\UpdateUserPictureTask" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /change /TN "Microsoft\Windows\StateRepository\MaintenanceTasks" /disable
schtasks /change /TN "Microsoft\Windows\Storage Tiers Management\Storage Tiers Management Initialization" /disable
schtasks /change /TN "Microsoft\Windows\Subscription\EnableLicenseAcquisition" /disable
schtasks /change /TN "Microsoft\Windows\SystemRestore\SR" /disable
schtasks /change /TN "Microsoft\Windows\Time Synchronization\ForceSynchronizeTime" /disable
schtasks /change /TN "Microsoft\Windows\Time Synchronization\SynchronizeTime" /disable
schtasks /change /TN "Microsoft\Windows\Time Zone\SynchronizeTimeZone" /disable
schtasks /change /TN "Microsoft\Windows\WaaSMedic\PerformRemediation" /disable
schtasks /change /TN "Microsoft\Windows\WCM\WiFiTask" /disable
schtasks /change /TN "Microsoft\Windows\WDI\ResolutionHost" /disable
schtasks /change /TN "Microsoft\Windows\Windows Filtering Platform\BfeOnServiceStartTypeChange" /disable
schtasks /change /TN "Microsoft\Windows\Wininet\CacheTask" /disable
schtasks /change /TN "Microsoft\Windows\WlanSvc\CDSSync" /disable
schtasks /change /TN "Microsoft\Windows\WindowsBackup\ConfigNotification" /disable
schtasks /change /TN "Microsoft\Windows\WOF\WIM-Hash-Management" /disable
schtasks /change /TN "Microsoft\Windows\WOF\WIM-Hash-Validation" /disable
schtasks /change /TN "Microsoft\Windows\Work Folders\Work Folders Logon Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Work Folders\Work Folders Maintenance Work" /disable
schtasks /change /TN "Microsoft\Windows\WwanSvc\NotificationTask" /disable
schtasks /change /TN "Microsoft\Windows\WwanSvc\OobeDiscovery" /disable
schtasks /change /TN "Microsoft\XblGameSave\XblGameSaveTask" /disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\Device Setup\Metadata Refresh" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\HandleCommand" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\HandleWnsCommand" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\IntegrityCheck" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\LocateCommandUserSession" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceAccountChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceLocationRightsChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDevicePeriodic24" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDevicePolicyChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceProtectionStateChanged" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceSettingChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterUserDevice" /Disable
schtasks /Delete /TN "Microsoft\Windows\PLA\System" /F
schtasks /Delete /TN "Microsoft\Windows\PLA" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo\CleanupOfflineContent" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo" /F
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\TaskScheduler" /f
schtasks /Delete /TN "Microsoft\Windows\Windows Activation Technologies" /F
for %%i in (eport UAC pdate ice gent NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "MaintenanceDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "WakeUp" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" /v "EnableWebContentEvaluation" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost\Download" /v "CheckExeSignatures" /t REG_SZ /d "no" /f
reg add "HKLM\SOFTWARE\Microsoft\Internet Explorer\FlipAhead" /v "FPEnabled" /t REG_DWORD /d "0" /f
echo.
echo Task Scheduler optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:FeaturesOptimize
cls
dism /Online /Enable-Feature /FeatureName:"LegacyComponents" /NoRestart
dism /Online /Enable-Feature /FeatureName:"DirectPlay" /NoRestart
dism /Online /Enable-Feature /FeatureName:"MediaPlayback" /NoRestart
dism /Online /Enable-Feature /FeatureName:"WindowsMediaPlayer" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Printing-PrintToPDFServices-Features" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Printing-XPSServices-Features" /NoRestart
dism /Online /Disable-feature /FeatureName:"MSRDC-Infrastructure" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SmbDirect" /NoRestart
dism /online /Disable-Feature /FeatureName:"SMB1Protocol" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Client" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Server" /NoRestart
dism /Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2Root" /NoRestart
dism /Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2" /NoRestart
echo.
echo Features optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone



:ExplorerOptimize
cls
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers" /v "DisableAutoplay" /t REG_DWORD /d "1" /f
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
	reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "HideSCAMeetNow" /t REG_DWORD /d 1 /f
	reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v "UseWin32BatteryFlyout" /t REG_DWORD /d "1" /f
) else (
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DITest" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableSnapAssistFlyout" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableSnapBar" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableTaskGroups" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "FolderContentsInfoTip" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SnapAssist" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAl" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarDa" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarMn" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarSh" /t REG_DWORD /d "0" /f
  reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DisableStartupSound" /t REG_DWORD /d "1" /f
  reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
)
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "AppsUseLightTheme" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "EnableTransparency" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "SystemUsesLightTheme" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DisablePreviewDesktop" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewAlphaSelect" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewShadow" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAnimations" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "NavPaneExpandToCurrentFolder" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SharingWizardOn" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "AltTabSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoThumbnailCache" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoCDBurning" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoReadingPane" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoNetConnectDisconnect" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoDriveTypeAutoRun" /t REG_DWORD /d "255" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "AicEnabled" /t REG_SZ /d "Anywhere" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "DisableEdgeDesktopShortcutCreation" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "HubMode" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "SmartScreenEnabled" /t REG_SZ /d "Off" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "HidePeopleBar" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "EnableLegacyBalloonNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "HideFastUserSwitching" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DelayedDesktopSwitchTimeout" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableFirstLogonAnimation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "Max Cached Icons" /t REG_SZ /d "4096" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v "VisualFXSetting" /t REG_DWORD /d "3" /f
reg add "HKCU\Control Panel\Desktop" /v "UserPreferencesMask" /t REG_BINARY /d "9012038010000000" /f
reg add "HKCU\Control Panel\Desktop\WindowMetrics" /v "MinAnimate" /t REG_SZ /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\DWM" /v "EnableAeroPeek" /t REG_DWORD /d "0" /f
reg add "HKCU\Control Panel\Desktop" /v "JPEGImportQuality" /t "REG_DWORD" /d "100" /f
reg add "HKCU\Control Panel\Desktop" /v "AutoEndTasks" /t REG_SZ /d "1" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"autoplay;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!autoplay;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Explorer optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:BcdeditOptimize
cls
bcdedit /set disabledynamictick yes
bcdedit /deletevalue useplatformclock
bcdedit /set useplatformtick yes
bcdedit /set bootux disabled
bcdedit /set quietboot Yes
bcdedit /timeout 3
bcdedit /set bootmenupolicy legacy
bcdedit /deletevalue isolatedcontext
bcdedit /deletevalue allowedinmemorysettings
bcdedit /deletevalue recoveryenabled
echo.
echo Bcdedit optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DisableAutologger
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Circular Kernel Context Logger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\CloudExperienceHostOobe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Rdp-Graphics-RdpIdd-Trace" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Setup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\ReadyBoot" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\ReFSLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\SpoolerLogger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diaglog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\LwtNetLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Rdp-Graphics-RdpIdd-Trace" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\NetCore" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\NtfsLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\RadioMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\UBPM" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\WdiContextLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\WiFiSession" /v "Start" /t REG_DWORD /d "0" /f
echo.
echo Autologgers Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:BSoDTweaks
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "AutoReboot" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "CrashDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "DisplayParameters" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "LogEvent" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "DeviceDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_0" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_1" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_2" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_3" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_4" /t REG_DWORD /d "0" /f
echo.
echo BSoD Tweaked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:MouseAcc
cls
reg add "HKCU\Control Panel\Mouse" /v "MouseSpeed" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Mouse" /v "MouseThreshold1" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Mouse" /v "MouseThreshold2" /t REG_SZ /d "0" /f
echo.
echo Mouse Acceleration Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:GameLaunchPrio
cls
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ApplicationFrameHost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ApplicationFrameHost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\csrss.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\csrss.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\EpicWebHelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\EpicWebHelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\fontdrvhost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\fontdrvhost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservices.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservices.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservicesnet.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservicesnet.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\lsass.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\lsass.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\memorycleaner.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\memorycleaner.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\RuntimeBroker.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\RuntimeBroker.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sihost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sihost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\SocialClubHelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\SocialClubHelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\steamwebhelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\steamwebhelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\TextInputHost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\TextInputHost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\WmiPrvSE.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\WmiPrvSE.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
echo.
echo Priority to game launchers, system has been set. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:HyperThreadingOpti
cls
for /f "tokens=*" %%f in ('wmic cpu get NumberOfCores /value ^| find "="') do set %%f
for /f "tokens=*" %%f in ('wmic cpu get NumberOfLogicalProcessors /value ^| find "="') do set %%f
if "!NumberOfCores!" == "2" (
	goto HyperThreading
)
if !NumberOfCores! gtr 4 (
	for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
		reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "3" /f
		reg delete "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /f
	) > nul 2> nul
	for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
		reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "5" /f
		reg delete "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /f
	) > nul 2> nul
)

if !NumberOfLogicalProcessors! gtr !NumberOfCores! (
for /f %%i in ('wmic path Win32_USBController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "C0" /f
	) > nul 2> nul
for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "C0" /f
	) > nul 2> nul
for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "30" /f
	) > nul 2> nul
)
echo.
echo Hyper Threading Optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:MsiModeOpti
cls
for /f %%i in ('wmic path Win32_IDEController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_USBController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_SoundDevice get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "0" /f >nul 2>&1
		for /f "tokens=*" %%i in ('reg query "HKLM\SYSTEM\CurrentControlSet\Enum\PCI"^| findstr "HKEY"') do (
			for /f "tokens=*" %%a in ('reg query "%%i"^| findstr "HKEY"') do reg delete "%%a\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePriority" /f >nul 2>&1
		)
	)
)
echo.
echo Msi Mode Optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:MMAgentOpti
cls
powershell "Disable-MMAgent -MemoryCompression"
powershell "Disable-MMAgent -PageCombining"
echo.
echo MMAgent Optimized. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:AccTweaks
cls
reg add "HKCU\Control Panel\Accessibility\HighContrast" /v "Flags" /t REG_SZ /d "4194" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "Flags" /t REG_SZ /d "2" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "AutoRepeatRate" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "AutoRepeatDelay" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\MouseKeys" /v "Flags" /t REG_SZ /d "130" /f
reg add "HKCU\Control Panel\Accessibility\MouseKeys" /v "MaximumSpeed" /t REG_SZ /d "39" /f
reg add "HKCU\Control Panel\Accessibility\StickyKeys" /v "Flags" /t REG_SZ /d "2" /f
reg add "HKCU\Control Panel\Accessibility\ToggleKeys" /v "Flags" /t REG_SZ /d "34" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "Flags" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "FSTextEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "TextEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "WindowsEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SlateLaunch" /v "ATapp" /t REG_SZ /d "" /f
reg add "HKCU\Control Panel\Accessibility\SlateLaunch" /v "LaunchAT" /t REG_DWORD /d "0" /f
reg add "HKCU\Control Panel\Keyboard" /v "InitialKeyboardIndicators" /t REG_SZ /d "0" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-eyecontrol;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-eyecontrol;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-closedcaptioning;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-closedcaptioning;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-narrator;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-narrator;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-highcontrast;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-highcontrast;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-colorfilter;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-colorfilter;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-magnifier;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-magnifier;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-visualeffects;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-visualeffects;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Accessability registry tweaked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:HibDisable
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "HiberbootEnabled" /t REG_DWORD /d "0" /f
powercfg -h off
echo.
echo Hibernation Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DiskTweaks
cls
reg delete "HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds\rdpwd" /v "StartupPrograms" /f
reg delete "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Font Drivers" /v "Adobe Type Manager" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE_Initialize" /v "DisableRemoteFontBootCache" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\GRE_Initialize" /v "DisableRemoteFontBootCache" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\MUI\StringCacheSettings" /v "StringCacheGeneration" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "UdfsSoftwareDefectManagement" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "LongPathsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsAllowExtendedCharacter8dot3Rename" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisable8dot3NameCreation" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisableLastAccessUpdate" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "RefsDisableLastAccessUpdate" /t REG_DWORD /d "1" /f
fsutil behavior set Bugcheckoncorrupt 0 >nul 2>&1
fsutil behavior set disable8dot3 1 >nul 2>&1
fsutil behavior set disablecompression 1 >nul 2>&1
fsutil behavior set disablelastaccess 1 >nul 2>&1
fsutil behavior set encryptpagingfile 0 >nul 2>&1
fsutil behavior set disabledeletenotify 0 >nul 2>&1
for /f "skip=1" %%i in ('wmic os get TotalVisibleMemorySize') do if not defined TOTAL_MEMORY set "TOTAL_MEMORY=%%i"
if !TOTAL_MEMORY! LSS 8000000 (
	fsutil behavior set memoryusage 1
	fsutil behavior set mftzone 1
) > nul 2> nul else if !TOTAL_MEMORY! LSS 16000000 (
	fsutil behavior set memoryusage 1
	fsutil behavior set mftzone 2
) > nul 2> nul else (
	fsutil behavior set memoryusage 2
	fsutil behavior set mftzone 2
) > nul 2> nul
reg add "HKLM\SYSTEM\ControlSet001\Control\Storage\EnabledDenyGP" /v "DenyAllGPState" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Services\pci\Parameters" /v "ASPMOptOut" /t REG_DWORD /d "1" /f
dism /Online /Set-ReservedStorageState /State:Disabled
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ReserveManager" /v "ShippedWithReserves" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v "01" /t REG_DWORD /d "0" /f
Reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions" /v "HasFlushedShellExtCache" /f
echo.
echo Disk Tweaked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:SvchostTweaks
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control" /v "SvcHostSplitThresholdInKB" /t REG_DWORD /d 4294967295 /f
echo.
echo Svchost Processes Count Tweaked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:PrintContext
cls
reg delete "HKCR\SystemFileAssociations\image\shell\print" /f
reg delete "HKCR\batfile\shell\print" /f
reg delete "HKCR\cmdfile\shell\print" /f
reg delete "HKCR\docxfile\shell\print" /f
reg delete "HKCR\fonfile\shell\print" /f
reg delete "HKCR\htmlfile\shell\print" /f
reg delete "HKCR\inffile\shell\print" /f
reg delete "HKCR\inifile\shell\print" /f
reg delete "HKCR\JSEFile\Shell\Print" /f
reg delete "HKCR\otffile\shell\print" /f
reg delete "HKCR\pfmfile\shell\print" /f
reg delete "HKCR\regfile\shell\print" /f
reg delete "HKCR\rtffile\shell\print" /f
reg delete "HKCR\ttcfile\shell\print" /f
reg delete "HKCR\ttffile\shell\print" /f
reg delete "HKCR\txtfile\shell\print" /f
reg delete "HKCR\VBEFile\Shell\Print" /f
reg delete "HKCR\VBSFile\Shell\Print" /f
reg delete "HKCR\WSFFile\Shell\Print" /f
echo.
echo Print Context Menu Removed. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:RotateContext
cls
reg delete "HKCR\SystemFileAssociations\.bmp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.dib\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.gif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heic\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.ico\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jfif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpe\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpeg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.png\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.rle\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tiff\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.webp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
echo.
echo Rotate Left, Right Context Menu Removed. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:KernelMemoryTweaks
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DisableExceptionChainValidation" /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DisableTsx"                      /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DistributeTimers"                /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "KernelSEHOPEnabled"              /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "DisablePageCombining" /t REG_DWORD /d 1 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "EnableCfg"                       /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "MoveImages"                      /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\Memory Management" /v "DisablePagingExecutive" /t REG_DWORD /d "1" /f
echo.
echo Kernel, Memory Managment Tweaked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:PowerPlanContext
cls
reg add "HKCR\.pow" /ve /t REG_SZ /d "Power Plan" /f
reg add "HKCR\.pow" /v "FriendlyTypeName" /t REG_SZ /d "Power Plan" /f
reg add "HKCR\.pow\DefaultIcon" /ve /t REG_EXPAND_SZ /d "%%SystemRoot%%\System32\powercfg.cpl,-202" /f
reg add "HKCR\.pow\shell\Import\command" /ve /t REG_SZ /d "powercfg /import \"%%1\"" /f
echo.
echo Powerplan Context menu added to .pow files. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:ClassicContextW11
cls
reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
echo.
echo Classic context menu enabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:OtherSvchostAudio
cls
copy /y "%windir%\System32\svchost.exe" "%windir%\System32\audiosvchost.exe" > nul 2> nul
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "ImagePath" /t REG_EXPAND_SZ /d "%windir%\System32\audiosvchost.exe -k LocalServiceNetworkRestricted -p" /f > nul 2> nul
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "ImagePath" /t REG_EXPAND_SZ /d "%windir%\System32\audiosvchost.exe -k LocalSystemNetworkRestricted -p" /f > nul 2> nul
echo.
echo Svchost for audio was changed. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DisableArchive
cls
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx" /v "AllowAutomaticAppArchiving" /t REG_DWORD /d "0" /f
echo.
echo Archive Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:VulnarableDisable
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CI\Config" /v "VulnerableDriverBlocklistEnable" /t REG_DWORD /d "0" /f
echo.
echo Vulnarable Driver Blocklist Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:BlockCleanup
cls
reg add "HKLM\SOFTWARE\Policies\Microsoft\Control Panel\International" /v "BlockCleanupOfUnusedPreinstalledLangPacks" /t REG_DWORD /d "1" /f
echo.
echo Block Cleanup unusued preinstalled languages. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:TimerResW11
cls
reg add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\kernel" /v "GlobalTimerResolutionRequests" /t REG_DWORD /d "1" /f
echo.
echo Global Timer Resolution Requests unlocked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:GamebarDisable
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter" /v "ActivationType" /t REG_DWORD /d "0" /f
) else (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter" /v "ActivationType" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\GameBarPresenceWriter.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
)
echo.
echo Gamebar Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:mobsyncDisable
cls
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\mobsync.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
echo.
echo mobsync Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:setnothing
cls
reg add "HKCU\Software\Microsoft\Multimedia\Audio" /v "UserDuckingPreference" /t REG_DWORD /d "3" /f
echo.
echo Sound communications has been set to Do nothing. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:libcontext
cls
reg delete "HKCR\Folder\shellex\ContextMenuHandlers\Library Location" /f
echo.
echo include in library context menu removed. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:pintostart
cls
reg delete "HKCR\Folder\shellex\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\exefile\shellex\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\Microsoft.Website\ShellEx\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\mscfile\shellex\ContextMenuHandlers\PintoStartScreen" /f
echo.
echo Pin to start removed from Context Menu. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:pintoquick
cls
reg delete "HKCR\Folder\shell\pintohome" /f
echo.
echo Pin to quick access removed from Context Menu. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:SendTo
cls
reg delete "HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\SendTo" /f
reg delete "HKCR\UserLibraryFolder\shellex\ContextMenuHandlers\SendTo" /f
echo.
echo "Send To" removed from Context Menu. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:BadDriver
cls
reg add "HKLM\SYSTEM\ControlSet001\Control\GraphicsDrivers" /v "DisableBadDriverCheckForHwProtection" /t REG_DWORD /d "1" /f
echo.
echo Bad Driver check for hw protection Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DiskCheckup
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager" /v "BootExecute" /t Reg_SZ /d "" /f
echo.
echo Disk Checkup Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:ProtectionDisk
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager" /v "ProtectionMode" /t Reg_DWORD /d "0" /f
echo.
echo Protection Mode Disk disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:HwSch
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "HwSchMode" /t REG_DWORD /d "2" /f
echo.
echo Hardware-Accelerated Gpu Scheduling Enabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:StartupOpti
cls
cmd /c (
  @echo off
  setlocal ENABLEDELAYEDEXPANSION
  for /f "tokens=2 delims==" %%a in ('wmic cpu get NumberOfCores /value ^| findstr "="') do (
      set NUMBER_OF_CORES=%%a
  )
  for /f "tokens=2 delims==" %%b in ('wmic cpu get MaxClockSpeed /value ^| findstr "="') do (
      set MAX_CLOCK_SPEED=%%b
  )
  set /a CPU=!NUMBER_OF_CORES!*!MAX_CLOCK_SPEED!
  if !CPU! GEQ 15000 (goto :high) else if !CPU! GEQ 10000 (goto :mid) else if !CPU! GEQ 1000 (goto :low)
  goto :end

  :high
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:20 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  goto :end

  :mid
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:25 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  goto :end

  :low
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:50 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  
  :end
)
echo.
echo Startup Optimizer Enabled! Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:Win32Sapa
cls
reg delete "HKLM\SYSTEM\ControlSet001\Control\PriorityControl" /v "ConvertibleSlateMode" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\PriorityControl" /v "Win32PrioritySeparation" /t REG_DWORD /d "38" /f
echo.
echo win32saparation has been set to 26. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DisableLogonImage
cls
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "DisableLogonBackgroundImage" /t REG_DWORD /d "1" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"lockscreen;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!lockscreen;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Logon Background Image Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:SpeechModelDisable
cls
reg add "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationOn" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationDefaultOn" /t REG_DWORD /d 0 /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Isolated" /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationEnableAboveLockscreen" /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Settings" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Speech" /v "AllowSpeechModelUpdate" /t REG_DWORD /d "0" /f
schtasks /change /TN "Microsoft\Windows\Speech\SpeechModelDownloadTask" /disable
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-speechtyping;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-speechtyping;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-speech;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-speech;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"speech;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!speech;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-speechrecognition;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-speechrecognition;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo speech model disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:langpackdisable
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete PenService
reg add "HKLM\SOFTWARE\Policies\Microsoft\Control Panel\International" /v "RestrictLanguagePacksAndFeaturesInstall" /t REG_DWORD /d "1" /f
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\Installation" /disable
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\ReconcileLanguageResources" /disable
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\Uninstallation" /disable
echo.
echo languaged packs and features install disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:AMDInterface
cls
start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\AMD\tweaks"
echo.
echo    Tweak AMD
echo.
echo Press Enter To Go To Berserker Interface
Pause >Nul
goto TweaksWindowsInterface

:Nvidia
cls
Start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Nvidia\tweaks"
echo.
echo    Tweak Nvidia
echo.
echo Press Enter To Go To Berserker Interface
Pause >Nul
goto TweaksWindowsInterface

:DiskQuotadisable
cls
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DiskQuota" /v "Enable" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DiskQuota" /v "Enforce" /t REG_DWORD /d "0" /f
echo.
echo DiskQuota Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:WaaSDisable
cls
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SYSTEM\WaaS" /f
echo.
echo WaaSMedicSvc Disabled. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:UnlockIE
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 19045 (
  echo on this build internet explorer is supported
) else (
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\InternetExplorer\Internet Explorer.lnk" "%AppData%\Microsoft\Windows\Start Menu\Programs\Accessories"
) else (
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\InternetExplorer\Internet Explorer.lnk" "%ProgramData%\Microsoft\Windows\Start Menu\Programs\Accessories"
)
)
echo.
echo Internet Explorer Unlocked. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:ApplyAllInOne
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete DiagTrack
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete dmwappushservice
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete diagnosticshub.standardcollector.service
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete diagsvc
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\DeviceCensus.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\CompatTelRunner.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowDeviceNameInTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "DoNotShowFeedbackNotifications" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows" /v "CEIPEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AITEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableEngine" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableInventory" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisablePCA" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableUAR" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "MaxTelemetryAllowed" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Software Protection Platform" /v "NoGenTicket" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Consent" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontSendAdditionalData" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontShowUI" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "LoggingDisabled" /t REG_DWORD /d 1 /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Consent" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontSendAdditionalData" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "DontShowUI" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v "LoggingDisabled" /t REG_DWORD /d 1 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete WerSvc
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete wercplsupport
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "DontSearchWindowsUpdate" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "DriverUpdateWizardWuSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "SearchOrderConfig" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\picturesLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\videosLibrary" /v "Value" /t REG_SZ /d Deny /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocation" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocationScripting" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableWindowsLocationProvider" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "HistoryViewEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "DeviceHistoryEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCloudSearch" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortana" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortanaAboveLock" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowSearchToUseLocation" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaConsent" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "BingSearchEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "BackgroundAppGlobalToggle" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCortanaButton" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OemPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RemediationRequired" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenOverlayEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SlideshowEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SoftLandingEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-202914Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-280815Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314559Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314563Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-88000326Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete WbioSrvc
reg add "HKLM\SOFTWARE\Microsoft\WindowsSelfHost\UI\Visibility" /v "HideInsiderPage" /t REG_DWORD /d 1 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Accessibility" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\AppSync" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Credentials" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Language" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Personalization" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync\Groups\Windows" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Personalization\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Microsoft\Personalization\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Siuf\Rules" /v "NumberOfSIUFInPeriod" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg delete "HKLM\Software\Microsoft\InputPersonalization" /v "Installed" /f
reg add "HKLM\Software\Microsoft\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Microsoft\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f
reg delete "HKLM\Software\Microsoft\InputPersonalization" /v "Shutdown" /f
reg add "HKLM\Software\Policies\Microsoft\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config" /v "AutoConnectAllowedOEM" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackProgs" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Microsoft\Input\TIPC" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKCU\SOFTWARE\Microsoft\Input\TIPC" /v "Enabled" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "AllowBlockingAppsAtShutdown" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "AllowDomainPINLogon" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "DisableAcrylicBackgroundOnLogon" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "DisableHHDEP" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableActivityFeed" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableCdp" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "EnableMmx" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "PublishUserActivities" /t REG_DWORD /d 0 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\System" /v "UploadUserActivities" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowFullControl" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fAllowToGetHelp" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v "fEnableChatControl" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\LSA" /v "RestrictAnonymous" /t REG_DWORD /d 1 /f
reg add "HKLM\Software\Policies\Microsoft\Windows\WCN\UI" /v "DisableWcnUi" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "AllowOnlineTips" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "NoUseStoreOpenWith" /t REG_DWORD /d 1 /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device" /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device User" /f
schtasks /delete /TN "Microsoft\Windows\Device Information" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /f
schtasks /change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /disable
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\AitAgent" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\MareBackup" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\PcaPatchDbTask" /f
schtasks /delete /TN "Microsoft\Windows\Autochk\Proxy" /f
schtasks /delete /TN "Microsoft\Windows\Autochk" /f
schtasks /delete /TN "Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClient" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf" /f
schtasks /delete /TN "Microsoft\Windows\Feedback" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings\RefreshCache" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings" /f
schtasks /delete /TN "Microsoft\Windows\Flighting" /f
schtasks /delete /TN "Microsoft\Windows\Input\InputSettingsRestoreDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\LocalUserSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\MouseSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\TouchpadSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
schtasks /delete /TN "Microsoft\Windows\Location\Notifications" /f
schtasks /delete /TN "Microsoft\Windows\Location\WindowsActionDialog" /f
schtasks /delete /TN "Microsoft\Windows\Location" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance\WinSAT" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance" /f
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /Delete /TN "Microsoft\Windows\RetailDemo\CleanupOfflineContent" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo" /F
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\TaskScheduler" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
setx POWERSHELL_TELEMETRY_OPTOUT 1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "PrivacyConsentPresentationVersion" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "PrivacyConsentSettingsVersion" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaIsReplaceable" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaIsReplaced" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Id" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v "DisabledByGroupPolicy" /t REG_DWORD /d "1" /f
reg add "HKCU\Control Panel\International\User Profile" /v "HttpAcceptLanguageOptOut" /t REG_DWORD /d 1 /f
reg add "HKCU\Software\Policies\Microsoft\Windows\OOBE" /v "DisablePrivacyExperience" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OOBE" /v "DisablePrivacyExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Control Panel\International" /v "TurnOffHighlightMisspelledWords" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Control Panel\International" /v "TurnOffAutocorrectMisspelledWords" /t REG_DWORD /d "1" /f
sc config cplspcon start= disabled
sc config ihi_service start= disabled
sc config igccservice start= disabled
sc config LMS start= disabled
sc config WMIRegistrationService start= disabled
sc config DSAService start= disabled
sc config DSAUpdateService start= disabled
sc config ESRV_SVC_QUEENCREEK start= disabled
sc config SystemUsageReportSvc_QUEENCREEK start= disabled
sc config USER_ESRV_SVC_QUEENCREEK start= disabled
sc config "Intel(R) SUR QC SAM" start= disabled
sc config XTU3Service start= demand
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "NoStartMenuHelp" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "DeviceDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_0" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_1" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_2" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_3" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_4" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v "ScoobeSystemSettingEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowSyncProviderNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "ConfigureWindowsSpotlight" /t REG_DWORD /d "2" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightFeatures" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnActionCenter" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightWindowsWelcomeExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "IncludeEnterpriseSpotlight" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableThirdPartySuggestions" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsAADCloudSearchEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsDeviceSearchHistoryEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings" /v "IsMSACloudSearchEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCloudSearch" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortana" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowCortanaAboveLock" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v "AllowSearchToUseLocation" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v "GlobalUserDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\Settings\AllowOnlineTips" /v "value" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "NoConnectedUser" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization" /v "DODownloadMode" /t REG_DWORD /d "0" /f
wevtutil sl Microsoft-Windows-SleepStudy/Diagnostic /e:false >nul 2>&1
wevtutil sl Microsoft-Windows-Kernel-Processor-Power/Diagnostic /e:false >nul 2>&1
wevtutil sl Microsoft-Windows-UserModePowerService/Diagnostic /e:false >nul 2>&1
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3" /v "1806" /t "REG_DWORD" /d "0" /f > nul 2> nul
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Associations" /v "LowRiskFileTypes" /t REG_SZ /d ".txt;.zip;.rar;.nfo;.exe;.bat;.cmd;.reg;.msi;.htm;.html;.gif;.bmp;.jpg;.jpeg;.png;.tif;.tiff;.mp3;.wma;.wav;.ogg;.mid;.midi;.avi;.mpg;.mpeg;.mov;.wmv;.asf;.swf;.vob;.mp4;.flv;.f4v;.mkv;.m4v;.rm;.rmvb;.doc;.docx;.xls;.xlsx;.ppt;.pptx;.pdf;.vsd;.vsdx;.odt;.odp;.ods;.odg;.odc;.odb;.odf;.rtf" /f > nul 2> nul
w32tm /config /syncfromflags:manual /manualpeerlist:"0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org" >nul 2>nul
w32tm /config /update >nul 2>nul
w32tm /resync >nul 2>nul
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\ControlSet001\Control\Diagnostics\Performance" /v "DisableDiagnosticTracing" /t "REG_DWORD" /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v "AllowHeadlessExecution" /t "REG_DWORD" /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\msfeedssync.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
wmic product where name="Intel Driver && Support Assistant" uninstall
wmic product where name="Intel(R) Computing Improvement Program" uninstall
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Feeds" /v "ShellFeedsTaskbarViewMode" /t REG_DWORD /d "2" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableSpellchecking" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableTextPrediction" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnablePredictionSpaceInsertion" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableDoubleTapSpace" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\TabletTip\1.7" /v "EnableAutocorrection" /t REG_DWORD /d "0" /f
reg delete "HKLM\SYSTEM\ControlSet001\Control\Power" /v "EnergyEstimationEnabled" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\StorageHealth" /v "AllowDiskHealthModelUpdates" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Input\Settings" /v "HarvestContacts" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Input\Settings" /v "InsightsEnabled" /t REG_DWORD /d "0" /f
reg delete "HKCU\Software\Microsoft\input\Settings" /v "Insights" /f
reg add "HKCU\Software\Microsoft\input\Settings" /v "InsightsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Psched" /v "NonBestEffortLimit" /t REG_DWORD /d "10" /f
reg add "HKLM\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows\Psched" /v "NonBestEffortLimit" /t REG_DWORD /d "10" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Lsa" /v "disabledomaincreds" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Lsa" /v "restrictanonymous" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "CdpSessionUserAuthzPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "EnableRemoteLaunchToast" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "NearShareChannelUserAuthzPolicy" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "RomeSdkChannelUserAuthzPolicy" /t REG_DWORD /d "0" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\CDP" /v "CdpUserSettingsVersion" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "EnableBackupForWin8Apps" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSync" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSyncUserOverride" /t REG_DWORD /d "1" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy" /v DisableQueryRemoteServer /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC" /v PreventHandwritingDataSharing /t REG_DWORD /d 1 /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Diagnostics" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Appraiser" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\ClientTelemetry" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController" /f
for /f "delims=" %%b in ('reg query "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels" /s /f "Enabled" ^| findstr "HKEY"') do reg add "%%b" /v "Enabled" /t REG_DWORD /d "0" /f
call "C:\Program Files\McAfee\WebAdvisor\uninstaller.exe" /s
rd /s /q "C:\Program Files\McAfee\WebAdvisor"
sc config SDRSVC start= disabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "NoAutoRebootWithLoggedOnUsers" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v "AlwaysAutoRebootAtScheduledTime" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DisableAutomaticRestartSignOn" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_CRITICAL_TOASTS_ABOVE_LOCK" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK" /t REG_DWORD /d "0" /f
Reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.SecurityAndMaintenance" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\FTH" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice" /v "AllowFindMyDevice" /t REG_DWORD /d "0" /f
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
  wusa /uninstall /kb:5005463 /quiet /norestart
  reg add "HKLM\SOFTWARE\Microsoft\PCHC" /v "PreviousUninstall" /t REG_DWORD /d "1" /f
) else (
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\graphicsCaptureProgrammatic" /v "Value" /t REG_SZ /d "Deny" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\graphicsCaptureWithoutBorder" /v "Value" /t REG_SZ /d "Deny" /f
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
)
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync" /v "BackupPolicy" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SettingSync" /v "DeviceMetadataUploaded" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "MaintenanceDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "WakeUp" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\ScheduledDiagnostics" /v "EnabledExecution" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{1d27f844-3a1f-4410-85ac-14651078412d}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{e2bf9676-5f8f-435c-97eb-11607a5bedf7}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{596AB062-B4D2-4215-9F74-E9109B0A8153}" /t REG_SZ /d "" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModelUnlock" /v "AllowDevelopmentWithoutDevLicense" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "SleepStudyDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\AboveLock" /v "AllowCortanaAboveLock" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\CloudDesktop" /v "BootToCloudMode" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Experience" /v "AllowCortana" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Settings" /v "AllowDataSense" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowLocation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowExperimentation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\System" /v "AllowTelemetry" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\WindowsInkWorkspace" /v "AllowWindowsInkWorkspace" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\TextInput" /v "AllowLinguisticDataCollection" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings" /v "DisableSendGenericDriverNotFoundToWER" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Settings" /v "DisableSendRequestAdditionalSoftwareToWER" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Microsoft\MediaPlayer\Preferences" /v "UsageTracking" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\DriverDatabase\Policies\Settings" /v "DisableSendGenericDriverNotFoundToWER" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\DriverDatabase\Policies\Settings" /v "DisableSendRequestAdditionalSoftwareToWER" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization" /v "OptInOOBE" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Metadata" /v "PreventDeviceMetadataFromNetwork" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CreatorsUpdatePrivacySettings" /v "AutoSet" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CreatorsUpdatePrivacySettings" /v "ShowUI" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Census" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v "AllowNewsAndInterests" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\MDM" /v "DisableRegistration" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v "EnableFeeds" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsInkWorkspace" /v "AllowSuggestedAppsInWindowsInkWorkspace" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WinBio\AccountInfo" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\ScriptedDiagnosticsProvider" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "BluetoothPolicy" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "UserAuthPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "BluetoothPolicy" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SmartGlass" /v "UserAuthPolicy" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ConnectedSearch" /v "ConnectedSearchUseWeb" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\16.0\common" /v "qmenable" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\16.0\common" /v "sendcustomerdata" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\office\common\clienttelemetry" /v "sendtelemetry" /t REG_DWORD /d "3" /f
reg add "HKCU\Software\Policies\Microsoft\TabletTip\1.7" /v "DisablePrediction" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\AppCompat" /v "DisablePCA" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightFeatures" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "ConfigureWindowsSpotlight" /t REG_DWORD /d "2" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "IncludeEnterpriseSpotlight" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightWindowsWelcomeExperience" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnActionCenter" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsSpotlightOnSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\CurrentVersion\QuietHours" /v "Enable" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "HidePeopleBar" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "EnableLegacyBalloonNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Network Connections" /v "NC_ShowSharedAccessUI" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Spelling\Options" /v "UserDictionaryMerged" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Spelling\Options" /v "UserDictionaryUploaded" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Cortana" /v "IsAvailable" /t REG_DWORD /d "0" /f
reg add "HKCU\Policies\Microsoft\Windows\CloudContent" /v "DisableTailoredExperiencesWithDiagnosticData" /t REG_DWORD /d "1" /f
reg delete "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "LegacyCortanaOn" /f
reg add "HKLM\SOFTWARE\Microsoft\Ole\AppCompat" /v "RequireIntegrityActivationAuthenticationLevel" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell" /v "BagMRU Size" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WinBio" /f
reg delete "HKLM\SOFTWARE\Microsoft\TelemetryClient" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "DisableTaggedEnergyLogging" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "TelemetryMaxApplication" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Power\EnergyEstimation\TaggedEnergy" /v "TelemetryMaxTagPerApplication" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete RetailDemo
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RetailDemo" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete TroubleshootingSvc
wusa /uninstall /kb:4023057 /quiet /norestart
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22631 (
echo Windows 11 23H2 not detected. >nul 2>nul
) else (
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d "1" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v "TurnOffWindowsCopilot" /t REG_DWORD /d "1" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownBuildNumber" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownUBR" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeAppsScanRun" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeMigrationComplete" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\USOShared\ScheduleTimeDump" /f
)
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Dsh" /v "IsPrelaunchEnabled" /f
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Dsh" /v "PrelaunchDelay" /f
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinSATMediaFiles-Package" ^| findstr "~~"') do (set "WinSAT=%%i")
if defined WinSAT (
		echo Removing %WinSAT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WinSAT% /NoRestart
		echo Y | reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /f
	) else (
		echo WinSAT not found, skipping.
	)
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"quiethours;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!quiethours;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"sync;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!sync;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search-permissions;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search-permissions;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"cortana-windowssearch;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!cortana-windowssearch;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search-moredetails;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search-moredetails;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"search;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!search;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-general;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-general;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-feedback;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-feedback;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-activityhistory;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-activityhistory;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-location;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-location;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-callhistory;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-callhistory;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-messaging;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-messaging;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-automaticfiledownloads;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-automaticfiledownloads;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"tabletmode;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!tabletmode;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"delivery-optimization;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!delivery-optimization;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"findmydevice;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!findmydevice;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"backup;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!backup;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"troubleshoot;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!troubleshoot;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"family-group;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!family-group;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"developers;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!developers;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"workplace;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!workplace;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"home;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!home;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Telemetry has removed
schtasks /delete /TN "Microsoft\Windows\Device Information\Device" /f
schtasks /delete /TN "Microsoft\Windows\Device Information\Device User" /f
schtasks /delete /TN "Microsoft\Windows\Device Information" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /f
schtasks /change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /disable
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /f
schtasks /delete /TN "Microsoft\Windows\Customer Experience Improvement Program" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /f
schtasks /delete /TN "Microsoft\Windows\Windows Error Reporting" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\AitAgent" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\MareBackup" /f
schtasks /delete /TN "Microsoft\Windows\Application Experience\PcaPatchDbTask" /f
schtasks /delete /TN "Microsoft\Windows\Autochk\Proxy" /f
schtasks /delete /TN "Microsoft\Windows\Autochk" /f
schtasks /delete /TN "Microsoft\Windows\Diagnosis\RecommendedTroubleshootingScanner" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver" /f
schtasks /delete /TN "Microsoft\Windows\DiskDiagnostic" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClient" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload" /f
schtasks /delete /TN "Microsoft\Windows\Feedback\Siuf" /f
schtasks /delete /TN "Microsoft\Windows\Feedback" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\ReconcileFeatures" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataFlushing" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig\UsageDataReporting" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\FeatureConfig" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings\RefreshCache" /f
schtasks /delete /TN "Microsoft\Windows\Flighting\OneSettings" /f
schtasks /delete /TN "Microsoft\Windows\Flighting" /f
schtasks /delete /TN "Microsoft\Windows\Input\InputSettingsRestoreDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\LocalUserSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\MouseSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input\TouchpadSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\appuriverifierdaily" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\appuriverifierinstall" /disable
schtasks /change /TN "Microsoft\Windows\ApplicationData\DsSvcCleanup" /disable
schtasks /delete /TN "Microsoft\Windows\AppListBackup\Backup" /f
schtasks /delete /TN "Microsoft\Windows\AppListBackup\BackupNonMaintenance" /f
schtasks /delete /TN "Microsoft\Windows\AppListBackup" /f
schtasks /change /TN "Microsoft\Windows\BrokerInfrastructure\BgTaskRegistrationMaintenanceTask" /disable
schtasks /change /TN "Microsoft\Windows\Chkdsk\ProactiveScan" /disable
schtasks /change /TN "Microsoft\Windows\CloudExperienceHost\CreateObjectTask" /disable
schtasks /change /TN "Microsoft\Windows\CloudRestore\Backup" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Check And Scan" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Scan" /disable
schtasks /change /TN "Microsoft\Windows\Data Integrity Scan\Data Integrity Scan for Crash Recovery" /disable
schtasks /change /TN "Microsoft\Windows\Diagnosis\Scheduled" /disable
schtasks /change /TN "Microsoft\Windows\DiskCleanup\SilentCleanup" /disable
schtasks /change /TN "Microsoft\Windows\DiskFootprint\Diagnostics" /disable
schtasks /change /TN "Microsoft\Windows\DiskFootprint\StorageSense" /disable
schtasks /change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /disable
schtasks /change /TN "Microsoft\Windows\HelloFace\FODCleanupTask" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\RestoreDevice" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\ScanForUpdates" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\ScanForUpdatesAsUser" /disable
schtasks /change /TN "Microsoft\Windows\InstallService\SmartRetry" /disable
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping > nul 2>&1
) else (
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownBuildNumber" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "LastKnownUBR" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeAppsScanRun" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler" /v "OobeMigrationComplete" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\IA" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\LXP" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\TFLUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\USOShared\ScheduleTimeDump" /f
)
schtasks /change /TN "Microsoft\Windows\International\Synchronize Language Settings" /disable
schtasks /delete /TN "Microsoft\Windows\Location\Notifications" /f
schtasks /delete /TN "Microsoft\Windows\Location\WindowsActionDialog" /f
schtasks /delete /TN "Microsoft\Windows\Location" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance\WinSAT" /f
schtasks /delete /TN "Microsoft\Windows\Maintenance" /f
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Cellular" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Logon" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\MdmDiagnosticsCleanup" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\Retry" /disable
schtasks /change /TN "Microsoft\Windows\Management\Provisioning\RunOnReboot" /disable
schtasks /change /TN "Microsoft\Windows\Maps\MapsToastTask" /disable
schtasks /change /TN "Microsoft\Windows\Maps\MapsUpdateTask" /disable
schtasks /change /TN "Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents" /disable
schtasks /change /TN "Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic" /disable
schtasks /change /TN "Microsoft\Windows\Mobile Broadband Accounts\MNO Metadata Parser" /disable
schtasks /change /TN "Microsoft\Windows\MUI\LPRemove" /disable
schtasks /change /TN "Microsoft\Windows\Multimedia\SystemSoundsService" /disable
schtasks /change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /disable
schtasks /change /TN "Microsoft\Windows\NlaSvc\WiFiTask" /disable
schtasks /change /TN "Microsoft\Windows\Offline Files\Background Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Offline Files\Logon Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Plug and Play\Sysprep Generalize Drivers" /disable
schtasks /delete /TN "Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem" /f
schtasks /delete /TN "Microsoft\Windows\Power Efficiency Diagnostics" /f
schtasks /change /TN "Microsoft\Windows\Printing\EduPrintProv" /disable
schtasks /change /TN "Microsoft\Windows\Printing\PrinterCleanupTask" /disable
schtasks /change /TN "Microsoft\Windows\Ras\MobilityManager" /disable
schtasks /change /TN "Microsoft\Windows\RecoveryEnvironment\VerifyWinRE" /disable
schtasks /change /TN "Microsoft\Windows\Registry\RegIdleBackup" /disable
schtasks /change /TN "Microsoft\Windows\RemoteAssistance\RemoteAssistanceTask" /disable
schtasks /change /TN "Microsoft\Windows\SettingSync\BackgroundUploadTask" /disable
schtasks /change /TN "Microsoft\Windows\SettingSync\NetworkStateChangeTask" /disable
schtasks /change /TN "Microsoft\Windows\Shell\FamilySafetyMonitor" /disable
schtasks /change /TN "Microsoft\Windows\Shell\FamilySafetyRefreshTask" /disable
schtasks /change /TN "Microsoft\Windows\Shell\IndexerAutomaticMaintenance" /disable
schtasks /change /TN "Microsoft\Windows\Shell\ThemesSyncedImageDownload" /disable
schtasks /change /TN "Microsoft\Windows\Shell\UpdateUserPictureTask" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskLogon" /disable
schtasks /change /TN "Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTaskNetwork" /disable
schtasks /change /TN "Microsoft\Windows\StateRepository\MaintenanceTasks" /disable
schtasks /change /TN "Microsoft\Windows\Storage Tiers Management\Storage Tiers Management Initialization" /disable
schtasks /change /TN "Microsoft\Windows\Subscription\EnableLicenseAcquisition" /disable
schtasks /change /TN "Microsoft\Windows\SystemRestore\SR" /disable
schtasks /change /TN "Microsoft\Windows\Time Synchronization\ForceSynchronizeTime" /disable
schtasks /change /TN "Microsoft\Windows\Time Synchronization\SynchronizeTime" /disable
schtasks /change /TN "Microsoft\Windows\Time Zone\SynchronizeTimeZone" /disable
schtasks /change /TN "Microsoft\Windows\WaaSMedic\PerformRemediation" /disable
schtasks /change /TN "Microsoft\Windows\WCM\WiFiTask" /disable
schtasks /change /TN "Microsoft\Windows\WDI\ResolutionHost" /disable
schtasks /change /TN "Microsoft\Windows\Windows Filtering Platform\BfeOnServiceStartTypeChange" /disable
schtasks /change /TN "Microsoft\Windows\Wininet\CacheTask" /disable
schtasks /change /TN "Microsoft\Windows\WlanSvc\CDSSync" /disable
schtasks /change /TN "Microsoft\Windows\WindowsBackup\ConfigNotification" /disable
schtasks /change /TN "Microsoft\Windows\WOF\WIM-Hash-Management" /disable
schtasks /change /TN "Microsoft\Windows\WOF\WIM-Hash-Validation" /disable
schtasks /change /TN "Microsoft\Windows\Work Folders\Work Folders Logon Synchronization" /disable
schtasks /change /TN "Microsoft\Windows\Work Folders\Work Folders Maintenance Work" /disable
schtasks /change /TN "Microsoft\Windows\WwanSvc\NotificationTask" /disable
schtasks /change /TN "Microsoft\Windows\WwanSvc\OobeDiscovery" /disable
schtasks /change /TN "Microsoft\XblGameSave\XblGameSaveTask" /disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\Device Setup\Metadata Refresh" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\HandleCommand" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\HandleWnsCommand" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\IntegrityCheck" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\LocateCommandUserSession" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceAccountChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceLocationRightsChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDevicePeriodic24" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDevicePolicyChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceProtectionStateChanged" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterDeviceSettingChange" /Disable
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c schtasks /Change /TN "Microsoft\Windows\DeviceDirectoryClient\RegisterUserDevice" /Disable
schtasks /Delete /TN "Microsoft\Windows\PLA\System" /F
schtasks /Delete /TN "Microsoft\Windows\PLA" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo\CleanupOfflineContent" /F
schtasks /Delete /TN "Microsoft\Windows\RetailDemo" /F
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\TaskScheduler" /f
schtasks /Delete /TN "Microsoft\Windows\Windows Activation Technologies" /F
for %%i in (eport UAC pdate ice gent NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "MaintenanceDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "WakeUp" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" /v "EnableWebContentEvaluation" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost\Download" /v "CheckExeSignatures" /t REG_SZ /d "no" /f
reg add "HKLM\SOFTWARE\Microsoft\Internet Explorer\FlipAhead" /v "FPEnabled" /t REG_DWORD /d "0" /f
echo.
echo Task Scheduler optimized
dism /Online /Enable-Feature /FeatureName:"LegacyComponents" /NoRestart
dism /Online /Enable-Feature /FeatureName:"DirectPlay" /NoRestart
dism /Online /Enable-Feature /FeatureName:"MediaPlayback" /NoRestart
dism /Online /Enable-Feature /FeatureName:"WindowsMediaPlayer" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Printing-PrintToPDFServices-Features" /NoRestart
dism /Online /Disable-Feature /FeatureName:"Printing-XPSServices-Features" /NoRestart
dism /Online /Disable-feature /FeatureName:"MSRDC-Infrastructure" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SmbDirect" /NoRestart
dism /online /Disable-Feature /FeatureName:"SMB1Protocol" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Client" /NoRestart
dism /Online /Disable-Feature /FeatureName:"SMB1Protocol-Server" /NoRestart
dism /Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2Root" /NoRestart
dism /Online /Disable-Feature /FeatureName:"MicrosoftWindowsPowerShellV2" /NoRestart
echo.
echo Features optimized
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers" /v "DisableAutoplay" /t REG_DWORD /d "1" /f
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
	reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "HideSCAMeetNow" /t REG_DWORD /d 1 /f
	reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v "UseWin32BatteryFlyout" /t REG_DWORD /d "1" /f
) else (
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DITest" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableSnapAssistFlyout" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableSnapBar" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableTaskGroups" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "FolderContentsInfoTip" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SnapAssist" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAl" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarDa" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarMn" /t REG_DWORD /d "0" /f
	reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarSh" /t REG_DWORD /d "0" /f
  reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DisableStartupSound" /t REG_DWORD /d "1" /f
  reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
)
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "AppsUseLightTheme" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "EnableTransparency" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "SystemUsesLightTheme" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DisablePreviewDesktop" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewAlphaSelect" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewShadow" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAnimations" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "NavPaneExpandToCurrentFolder" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SharingWizardOn" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "AltTabSettings" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoThumbnailCache" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoCDBurning" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoRecentDocsHistory" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoReadingPane" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoNetConnectDisconnect" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoDriveTypeAutoRun" /t REG_DWORD /d "255" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "AicEnabled" /t REG_SZ /d "Anywhere" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "DisableEdgeDesktopShortcutCreation" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "HubMode" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "SmartScreenEnabled" /t REG_SZ /d "Off" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "HidePeopleBar" /t REG_DWORD /d "1" /f
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "EnableLegacyBalloonNotifications" /t REG_DWORD /d "0" /f
reg add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "HideFastUserSwitching" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DelayedDesktopSwitchTimeout" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableFirstLogonAnimation" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "Max Cached Icons" /t REG_SZ /d "4096" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v "VisualFXSetting" /t REG_DWORD /d "3" /f
reg add "HKCU\Control Panel\Desktop" /v "UserPreferencesMask" /t REG_BINARY /d "9012038010000000" /f
reg add "HKCU\Control Panel\Desktop\WindowMetrics" /v "MinAnimate" /t REG_SZ /d "0" /f
reg add "HKCU\SOFTWARE\Microsoft\Windows\DWM" /v "EnableAeroPeek" /t REG_DWORD /d "0" /f
reg add "HKCU\Control Panel\Desktop" /v "JPEGImportQuality" /t "REG_DWORD" /d "100" /f
reg add "HKCU\Control Panel\Desktop" /v "AutoEndTasks" /t REG_SZ /d "1" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"autoplay;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!autoplay;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Explorer optimized
bcdedit /set disabledynamictick yes
bcdedit /deletevalue useplatformclock
bcdedit /set useplatformtick yes
bcdedit /set bootux disabled
bcdedit /set quietboot Yes
bcdedit /timeout 3
bcdedit /set bootmenupolicy legacy
bcdedit /deletevalue isolatedcontext
bcdedit /deletevalue allowedinmemorysettings
bcdedit /deletevalue recoveryenabled
echo.
echo Bcdedit optimized
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Circular Kernel Context Logger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\CloudExperienceHostOobe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Rdp-Graphics-RdpIdd-Trace" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Setup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\ReadyBoot" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\ReFSLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\SpoolerLogger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diaglog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Diagtrack-Listener" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\LwtNetLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\Microsoft-Windows-Rdp-Graphics-RdpIdd-Trace" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\NetCore" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\NtfsLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\RadioMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\UBPM" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\WdiContextLog" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\WiFiSession" /v "Start" /t REG_DWORD /d "0" /f
echo.
echo Autologgers Disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "AutoReboot" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "CrashDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "DisplayParameters" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl" /v "LogEvent" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "DeviceDumpEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_0" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_1" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_2" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_3" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CrashControl\StorageTelemetry" /v "StorageTCCode_4" /t REG_DWORD /d "0" /f
echo.
echo BSoD Tweaked
reg add "HKCU\Control Panel\Mouse" /v "MouseSpeed" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Mouse" /v "MouseThreshold1" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Mouse" /v "MouseThreshold2" /t REG_SZ /d "0" /f
echo.
echo Mouse Acceleration Disabled
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ApplicationFrameHost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\ApplicationFrameHost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\csrss.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\csrss.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\EpicWebHelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\EpicWebHelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\fontdrvhost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\fontdrvhost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservices.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservices.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservicesnet.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\gamingservicesnet.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\lsass.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\lsass.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\memorycleaner.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\memorycleaner.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\RuntimeBroker.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\RuntimeBroker.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sihost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sihost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\SocialClubHelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\SocialClubHelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\steamwebhelper.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\steamwebhelper.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\TextInputHost.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\TextInputHost.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\WmiPrvSE.exe\PerfOptions" /v "CpuPriorityClass" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\WmiPrvSE.exe\PerfOptions" /v "IoPriority" /t REG_DWORD /d "2" /f
echo.
echo Priority to game launchers, system has been set
for /f "tokens=*" %%f in ('wmic cpu get NumberOfCores /value ^| find "="') do set %%f
for /f "tokens=*" %%f in ('wmic cpu get NumberOfLogicalProcessors /value ^| find "="') do set %%f
if "!NumberOfCores!" == "2" (
	goto HyperThreading
)
if !NumberOfCores! gtr 4 (
	for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
		reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "3" /f
		reg delete "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /f
	) > nul 2> nul
	for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
		reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "5" /f
		reg delete "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /f
	) > nul 2> nul
)

if !NumberOfLogicalProcessors! gtr !NumberOfCores! (
for /f %%i in ('wmic path Win32_USBController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "C0" /f
	) > nul 2> nul
for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "C0" /f
	) > nul 2> nul
for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do (
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePolicy" /t REG_DWORD /d "4" /f
	reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\Affinity Policy" /v "AssignmentSetOverride" /t REG_BINARY /d "30" /f
	) > nul 2> nul
)
echo.
echo Hyper Threading Optimized
for /f %%i in ('wmic path Win32_IDEController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_USBController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_VideoController get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_NetworkAdapter get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "1" /f >nul 2>&1
for /f %%i in ('wmic path Win32_SoundDevice get PNPDeviceID^| findstr /l "PCI\VEN_"') do reg add "HKLM\SYSTEM\CurrentControlSet\Enum\%%i\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties" /v "MSISupported" /t REG_DWORD /d "0" /f >nul 2>&1
		for /f "tokens=*" %%i in ('reg query "HKLM\SYSTEM\CurrentControlSet\Enum\PCI"^| findstr "HKEY"') do (
			for /f "tokens=*" %%a in ('reg query "%%i"^| findstr "HKEY"') do reg delete "%%a\Device Parameters\Interrupt Management\Affinity Policy" /v "DevicePriority" /f >nul 2>&1
		)
	)
)
echo.
echo Msi Mode Optimized
powershell "Disable-MMAgent -MemoryCompression"
powershell "Disable-MMAgent -PageCombining"
echo.
echo MMAgent Optimized
reg add "HKCU\Control Panel\Accessibility\HighContrast" /v "Flags" /t REG_SZ /d "4194" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "Flags" /t REG_SZ /d "2" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "AutoRepeatRate" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\Keyboard Response" /v "AutoRepeatDelay" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\MouseKeys" /v "Flags" /t REG_SZ /d "130" /f
reg add "HKCU\Control Panel\Accessibility\MouseKeys" /v "MaximumSpeed" /t REG_SZ /d "39" /f
reg add "HKCU\Control Panel\Accessibility\StickyKeys" /v "Flags" /t REG_SZ /d "2" /f
reg add "HKCU\Control Panel\Accessibility\ToggleKeys" /v "Flags" /t REG_SZ /d "34" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "Flags" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "FSTextEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "TextEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SoundSentry" /v "WindowsEffect" /t REG_SZ /d "0" /f
reg add "HKCU\Control Panel\Accessibility\SlateLaunch" /v "ATapp" /t REG_SZ /d "" /f
reg add "HKCU\Control Panel\Accessibility\SlateLaunch" /v "LaunchAT" /t REG_DWORD /d "0" /f
reg add "HKCU\Control Panel\Keyboard" /v "InitialKeyboardIndicators" /t REG_SZ /d "0" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-eyecontrol;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-eyecontrol;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-closedcaptioning;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-closedcaptioning;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-narrator;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-narrator;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-highcontrast;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-highcontrast;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-colorfilter;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-colorfilter;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-magnifier;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-magnifier;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-visualeffects;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-visualeffects;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Accessability registry tweaked
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "HiberbootEnabled" /t REG_DWORD /d "0" /f
powercfg -h off
echo.
echo Hibernation Disabled
reg delete "HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds\rdpwd" /v "StartupPrograms" /f
reg delete "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Font Drivers" /v "Adobe Type Manager" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE_Initialize" /v "DisableRemoteFontBootCache" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\GRE_Initialize" /v "DisableRemoteFontBootCache" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\MUI\StringCacheSettings" /v "StringCacheGeneration" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "UdfsSoftwareDefectManagement" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "LongPathsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsAllowExtendedCharacter8dot3Rename" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisable8dot3NameCreation" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisableLastAccessUpdate" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "RefsDisableLastAccessUpdate" /t REG_DWORD /d "1" /f
fsutil behavior set Bugcheckoncorrupt 0 >nul 2>&1
fsutil behavior set disable8dot3 1 >nul 2>&1
fsutil behavior set disablecompression 1 >nul 2>&1
fsutil behavior set disablelastaccess 1 >nul 2>&1
fsutil behavior set encryptpagingfile 0 >nul 2>&1
fsutil behavior set disabledeletenotify 0 >nul 2>&1
for /f "skip=1" %%i in ('wmic os get TotalVisibleMemorySize') do if not defined TOTAL_MEMORY set "TOTAL_MEMORY=%%i"
if !TOTAL_MEMORY! LSS 8000000 (
	fsutil behavior set memoryusage 1
	fsutil behavior set mftzone 1
) > nul 2> nul else if !TOTAL_MEMORY! LSS 16000000 (
	fsutil behavior set memoryusage 1
	fsutil behavior set mftzone 2
) > nul 2> nul else (
	fsutil behavior set memoryusage 2
	fsutil behavior set mftzone 2
) > nul 2> nul
reg add "HKLM\SYSTEM\ControlSet001\Control\Storage\EnabledDenyGP" /v "DenyAllGPState" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\ControlSet001\Services\pci\Parameters" /v "ASPMOptOut" /t REG_DWORD /d "1" /f
dism /Online /Set-ReservedStorageState /State:Disabled
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ReserveManager" /v "ShippedWithReserves" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v "01" /t REG_DWORD /d "0" /f
Reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Shell Extensions" /v "HasFlushedShellExtCache" /f
echo.
echo Disk Tweaked
reg add "HKLM\SYSTEM\CurrentControlSet\Control" /v "SvcHostSplitThresholdInKB" /t REG_DWORD /d 4294967295 /f
echo.
echo Svchost Processes Count Tweaked
reg delete "HKCR\SystemFileAssociations\image\shell\print" /f
reg delete "HKCR\batfile\shell\print" /f
reg delete "HKCR\cmdfile\shell\print" /f
reg delete "HKCR\docxfile\shell\print" /f
reg delete "HKCR\fonfile\shell\print" /f
reg delete "HKCR\htmlfile\shell\print" /f
reg delete "HKCR\inffile\shell\print" /f
reg delete "HKCR\inifile\shell\print" /f
reg delete "HKCR\JSEFile\Shell\Print" /f
reg delete "HKCR\otffile\shell\print" /f
reg delete "HKCR\pfmfile\shell\print" /f
reg delete "HKCR\regfile\shell\print" /f
reg delete "HKCR\rtffile\shell\print" /f
reg delete "HKCR\ttcfile\shell\print" /f
reg delete "HKCR\ttffile\shell\print" /f
reg delete "HKCR\txtfile\shell\print" /f
reg delete "HKCR\VBEFile\Shell\Print" /f
reg delete "HKCR\VBSFile\Shell\Print" /f
reg delete "HKCR\WSFFile\Shell\Print" /f
echo.
echo Print Context Menu Removed
reg delete "HKCR\SystemFileAssociations\.bmp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.dib\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.gif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heic\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.ico\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jfif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpe\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpeg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.png\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.rle\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tiff\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.webp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
echo.
echo Rotate Left, Right Context Menu Removed
reg delete "HKCR\SystemFileAssociations\.bmp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.dib\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.gif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heic\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.heif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.ico\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jfif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpe\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpeg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.jpg\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.png\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.rle\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tif\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.tiff\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
reg delete "HKCR\SystemFileAssociations\.webp\ShellEx\ContextMenuHandlers\ShellImagePreview" /f
echo.
echo Rotate Left, Right Context Menu Removed
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DisableExceptionChainValidation" /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DisableTsx"                      /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "DistributeTimers"                /t Reg_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel"            /v "KernelSEHOPEnabled"              /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "DisablePageCombining" /t REG_DWORD /d 1 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "EnableCfg"                       /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "MoveImages"                      /t Reg_DWORD /d "0" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\Memory Management" /v "DisablePagingExecutive" /t REG_DWORD /d "1" /f
echo.
echo Kernel, Memory Managment Tweaked
reg add "HKCR\.pow" /ve /t REG_SZ /d "Power Plan" /f
reg add "HKCR\.pow" /v "FriendlyTypeName" /t REG_SZ /d "Power Plan" /f
reg add "HKCR\.pow\DefaultIcon" /ve /t REG_EXPAND_SZ /d "%%SystemRoot%%\System32\powercfg.cpl,-202" /f
reg add "HKCR\.pow\shell\Import\command" /ve /t REG_SZ /d "powercfg /import \"%%1\"" /f
echo.
echo Powerplan Context menu added to .pow files
reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
echo.
echo Classic context menu enabled
copy /y "%windir%\System32\svchost.exe" "%windir%\System32\audiosvchost.exe" > nul 2> nul
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "ImagePath" /t REG_EXPAND_SZ /d "%windir%\System32\audiosvchost.exe -k LocalServiceNetworkRestricted -p" /f > nul 2> nul
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "ImagePath" /t REG_EXPAND_SZ /d "%windir%\System32\audiosvchost.exe -k LocalSystemNetworkRestricted -p" /f > nul 2> nul
echo.
echo Svchost for audio was changed
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Appx" /v "AllowAutomaticAppArchiving" /t REG_DWORD /d "0" /f
echo.
echo Archive Disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Control\CI\Config" /v "VulnerableDriverBlocklistEnable" /t REG_DWORD /d "0" /f
echo.
echo Vulnarable Driver Blocklist Disabled
reg add "HKLM\SOFTWARE\Policies\Microsoft\Control Panel\International" /v "BlockCleanupOfUnusedPreinstalledLangPacks" /t REG_DWORD /d "1" /f
echo.
echo Block Cleanup unusued preinstalled languages
reg add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\kernel" /v "GlobalTimerResolutionRequests" /t REG_DWORD /d "1" /f
echo.
echo Global Timer Resolution Requests unlocked
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter" /v "ActivationType" /t REG_DWORD /d "0" /f
) else (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\WindowsRuntime\ActivatableClassId\Windows.Gaming.GameBar.PresenceServer.Internal.PresenceWriter" /v "ActivationType" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\GameBarPresenceWriter.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
)
echo.
echo Gamebar Disabled
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\mobsync.exe" /v "Debugger" /t REG_SZ /d "%windir%\System32\taskkill.exe" /f
echo.
echo mobsync Disabled
reg add "HKCU\Software\Microsoft\Multimedia\Audio" /v "UserDuckingPreference" /t REG_DWORD /d "3" /f
echo.
echo Sound communications has been set to Do nothing
reg delete "HKCR\Folder\shellex\ContextMenuHandlers\Library Location" /f
echo.
echo include in library context menu removed
reg delete "HKCR\Folder\shellex\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\exefile\shellex\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\Microsoft.Website\ShellEx\ContextMenuHandlers\PintoStartScreen" /f
reg delete "HKCR\mscfile\shellex\ContextMenuHandlers\PintoStartScreen" /f
echo.
echo Pin to start removed from Context Menu
reg delete "HKCR\Folder\shell\pintohome" /f
echo.
echo Pin to quick access removed from Context Menu
reg delete "HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\SendTo" /f
reg delete "HKCR\UserLibraryFolder\shellex\ContextMenuHandlers\SendTo" /f
echo.
echo "Send To" removed from Context Menu
reg add "HKLM\SYSTEM\ControlSet001\Control\GraphicsDrivers" /v "DisableBadDriverCheckForHwProtection" /t REG_DWORD /d "1" /f
echo.
echo Bad Driver check for hw protection Disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager" /v "BootExecute" /t Reg_SZ /d "" /f
echo.
echo Disk Checkup Disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager" /v "ProtectionMode" /t Reg_DWORD /d "0" /f
echo.
echo Protection Mode Disk disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "HwSchMode" /t REG_DWORD /d "2" /f
echo.
echo Hardware-Accelerated Gpu Scheduling Enabled
cmd /c (
  @echo off
  setlocal ENABLEDELAYEDEXPANSION
  for /f "tokens=2 delims==" %%a in ('wmic cpu get NumberOfCores /value ^| findstr "="') do (
      set NUMBER_OF_CORES=%%a
  )
  for /f "tokens=2 delims==" %%b in ('wmic cpu get MaxClockSpeed /value ^| findstr "="') do (
      set MAX_CLOCK_SPEED=%%b
  )
  set /a CPU=!NUMBER_OF_CORES!*!MAX_CLOCK_SPEED!
  if !CPU! GEQ 15000 (goto :high) else if !CPU! GEQ 10000 (goto :mid) else if !CPU! GEQ 1000 (goto :low)
  goto :end

  :high
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:20 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  goto :end

  :mid
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:25 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  goto :end

  :low
  schtasks /create /sc ONLOGON /f /ru "nt authority\system" /tn "\Berserker\Startup Optimizer" /delay 0000:50 /tr "C:\ProgramData\Berserker-tasks\Startup_optimizer.bat"
  schtasks /create /sc MONTHLY /mo 1 /tn "\Berserker\Cleanup" /tr "C:\ProgramData\Berserker-tasks\cleanup.bat" /st 04:50 /ru "%USERDOMAIN%\%USERNAME%"
  
  :end
)
echo.
echo Startup Optimizer Enabled
reg delete "HKLM\SYSTEM\ControlSet001\Control\PriorityControl" /v "ConvertibleSlateMode" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\PriorityControl" /v "Win32PrioritySeparation" /t REG_DWORD /d "38" /f
echo.
echo win32saparation has been set to 26
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "DisableLogonBackgroundImage" /t REG_DWORD /d "1" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"lockscreen;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!lockscreen;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Logon Background Image Disabled
reg add "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationOn" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationDefaultOn" /t REG_DWORD /d 0 /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Isolated" /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Preferences" /v "VoiceActivationEnableAboveLockscreen" /f
Reg delete "HKCU\Software\Microsoft\Speech_OneCore\Settings" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Speech" /v "AllowSpeechModelUpdate" /t REG_DWORD /d "0" /f
schtasks /change /TN "Microsoft\Windows\Speech\SpeechModelDownloadTask" /disable
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-speechtyping;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-speechtyping;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"privacy-speech;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!privacy-speech;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"speech;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!speech;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"easeofaccess-speechrecognition;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!easeofaccess-speechrecognition;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo speech model disabled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c sc delete PenService
reg add "HKLM\SOFTWARE\Policies\Microsoft\Control Panel\International" /v "RestrictLanguagePacksAndFeaturesInstall" /t REG_DWORD /d "1" /f
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\Installation" /disable
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\ReconcileLanguageResources" /disable
schtasks /change /TN "Microsoft\Windows\LanguageComponentsInstaller\Uninstallation" /disable
echo.
echo languaged packs and features install disabled
start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\AMD\tweaks"
echo.
echo    Tweak AMD
echo.
Start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Nvidia\tweaks"
echo.
echo    Tweak Nvidia
echo.
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DiskQuota" /v "Enable" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\DiskQuota" /v "Enforce" /t REG_DWORD /d "0" /f
echo.
echo DiskQuota Disabled
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SYSTEM\WaaS" /f
echo.
echo WaaSMedicSvc Disabled
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 19045 (
  echo on this build internet explorer is supported
) else (
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\InternetExplorer\Internet Explorer.lnk" "%AppData%\Microsoft\Windows\Start Menu\Programs\Accessories"
) else (
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\InternetExplorer\Internet Explorer.lnk" "%ProgramData%\Microsoft\Windows\Start Menu\Programs\Accessories"
)
)
echo.
echo Internet Explorer Unlocked
echo.
echo Applied all tweaks. Press any key to go to Windows Tweaks
Pause > Nul
goto Allinone

:DebloatPrograms
cls
FOR /F %%A in ('"PROMPT $H&FOR %%B in (1) DO REM"') DO SET "BS=%%A"
echo.
echo.
ECHO â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
ECHO â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
ECHO â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
ECHO â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
ECHO â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
ECHO â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•       â•šâ•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
Call :TYPEfast "   Browsers,                                   Launchers"
echo.
echo.
echo   [1] Chrome                                  [6] %blue%Discord Debloat%reset%
echo   [2] Brave%reset%                                   [7] %blue%Steam Settings%reset%
echo   [3] %blue%Edge%reset%
echo   [4] %red%Opera[Also GX]%reset%
echo   [5] %red%FireFox%reset%
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto ChromeDebloat
if /i %input% == 2 goto BraveDebloat
if /i %input% == 3 goto EdgeDebloat
if /i %input% == 4 goto OperaGXDebloat
if /i %input% == 5 goto FireFoxDebloat
if /i %input% == 6 goto DiscordDebloat
if /i %input% == 7 goto SteamDebloatorsettingsidk
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto :DebloatPrograms


:ChromeDebloat
cls
net stop gupdate
sc delete gupdate
net stop googlechromeelevationservice
sc delete googlechromeelevationservice
net stop gupdatem
sc delete gupdatem
taskkill /f /im GoogleUpdate.exe
cd /d "C:\Program Files (x86)\Google\Update\"
dir GoogleCrashHandler.exe /a /b /s
del GoogleCrashHandler.exe /a /s
dir GoogleCrashHandler64.exe /a /b /s
del GoogleCrashHandler64.exe /a /s
cd /d "C:\Program Files\Google\Chrome\Application\"
dir chrmstp.exe /a /b /s
del chrmstp.exe /a /s
dir elevation_service.exe /a /b /s
del elevation_service.exe /a /s
schtasks /Delete /TN "GoogleUpdateTaskMachineCore" /F
schtasks /Delete /TN "GoogleUpdateTaskMachineUA" /F
echo.
echo Chrome Are Debloated Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:BraveDebloat
cls
net stop brave
sc delete brave
net stop bravem
sc delete bravem
net stop BraveElevationService
sc delete BraveElevationService
net stop BraveVpnService
sc delete BraveVpnService
net stop BraveVpnWireguardService
sc delete BraveVpnWireguardService
cd /d "C:\Program Files (x86)\BraveSoftware\Update\"
dir BraveCrashHandler.exe /a /b /s
del BraveCrashHandler.exe /a /s
dir BraveCrashHandler64.exe /a /b /s
del BraveCrashHandler64.exe /a /s
cd /d "C:\Program Files\BraveSoftware\Brave-Browser\Application\"
dir chrmstp.exe /a /b /s
del chrmstp.exe /a /s
dir brave_vpn_helper.exe /a /b /s
del brave_vpn_helper.exe /a /s
schtasks /Delete /TN "BraveSoftwareUpdateTaskMachineCore" /F
schtasks /Delete /TN "BraveSoftwareUpdateTaskMachineUA" /F
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "BraveVpnWireguardService" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "BraveVpnWireguardService" /f
rmdir "C:\ProgramData\BraveSoftware" /s /q
echo.
echo Brave Are Debloated Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:EdgeDebloat
cls
if exist "%ProgramFiles(x86)%\Microsoft\Edge\Application" (
reg add "HKCU\Software\Microsoft\Edge\SmartScreenEnabled" /ve /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Edge" /v "UsageStatsInSample" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "AddressBarMicrosoftSearchInBingProviderEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "AdsSettingForIntrusiveAdsSites" /t REG_DWORD /d "2" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "BingAdsSuppression" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "DiagnosticData" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "EdgeCollectionsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "EdgeFollowEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "HideFirstRunExperience" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "HubsSidebarEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "MicrosoftEdgeInsiderPromotionEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "NewTabPageAllowedBackgroundTypes" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "NewTabPageContentEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "NewTabPageHideDefaultTopSites" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "NewTabPageQuickLinksEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "NewTabPageSearchBox" /t REG_SZ /d "redirect" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "PersonalizationReportingEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "PromotionalTabsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "ShowMicrosoftRewards" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "ShowRecommendationsEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "WebWidgetAllowed" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v "WebWidgetIsEnabledOnStartup" /t REG_DWORD /d "0" /f
) else (
echo Edge Not Detected!
)
Powershell -C "Remove-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -Name "MicrosoftEdgeAutoLaunch_*" -Force"
Powershell -C "Remove-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" -Name "MicrosoftEdgeAutoLaunch_*" -Force"
sc config MicrosoftEdgeElevationService start=disabled >nul 2>&1
sc config edgeupdate start=disabled >nul 2>&1
sc config edgeupdatem start=disabled >nul 2>&1
echo.
echo Edge Are Debloated Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:OperaGXDebloat
cls
for %%i in (Opera) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
cd /d "%HOMEPATH%\AppData\Local\Programs\Opera"
for /f "delims=" %%a in ('dir /b /s /ad resources') do (
    rmdir /s /q "%%a"
)
dir opera_crashreporter.exe /a /b /s
del opera_crashreporter.exe /a /s
cd /d "%HOMEPATH%\AppData\Local\Programs\Opera GX"
for /f "delims=" %%a in ('dir /b /s /ad resources') do (
    rmdir /s /q "%%a"
)
dir opera_crashreporter.exe /a /b /s
del opera_crashreporter.exe /a /s
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Opera GX Stable" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "Opera GX Stable" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Opera Stable" /f
reg delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "Opera Stable" /f
echo.
echo Opera Are Debloated Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:FireFoxDebloat
cls
taskkill /f /im maintenanceservice.exe
taskkill /f /im uninstall.exe
net stop MozillaMaintenance
sc delete MozillaMaintenance
rmdir "C:\Program Files (x86)\Mozilla Maintenance Service" /s /q
del /f "C:\Program Files\Mozilla Firefox\maintenanceservice_installer.exe"
del /f "C:\Program Files\Mozilla Firefox\maintenanceservice.exe"
del /f "C:\Program Files\Mozilla Firefox\default-browser-agent.exe"
del /f "C:\Program Files\Mozilla Firefox\minidump-analyzer.exe"
del /f "C:\Program Files\Mozilla Firefox\pingsender.exe"
cd /D "%APPDATA%\Mozilla\Firefox\Profiles\*.default-release"
echo user_pref("full-screen-api.warning.timeout", "0");>>prefs.js
echo user_pref("full-screen-api.transition-duration.enter", "0 0");>>prefs.js
echo user_pref("full-screen-api.transition-duration.leave", "0 0");>>prefs.js
echo user_pref("network.captive-portal-service.enabled", false);>>prefs.js
echo user_pref("captivedetect.canonicalURL", "");>>prefs.js
echo user_pref("toolkit.telemetry.archive.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.bhrPing.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.cachedClientID", "");>>prefs.js
echo user_pref("toolkit.telemetry.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.firstShutdownPing.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.newProfilePing.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.reportingpolicy.firstRun", false);>>prefs.js
echo user_pref("toolkit.telemetry.server", "");>>prefs.js
echo user_pref("toolkit.telemetry.shutdownPingSender.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.unified", false);>>prefs.js
echo user_pref("toolkit.telemetry.updatePing.enabled", false);>>prefs.js
echo user_pref("toolkit.telemetry.pioneer-new-studies-available", false);>>prefs.js
echo user_pref("browser.tabs.crashReporting.sendReport", false);>>prefs.js
echo user_pref("dom.battery.enabled", false);>>prefs.js
echo user_pref("geo.enabled", false);>>prefs.js
echo user_pref("browser.newtab.preload", false);>>prefs.js
echo user_pref("browser.safebrowsing.blockedURIs.enabled", false);>>prefs.js
echo user_pref("browser.safebrowsing.downloads.enabled", false);>>prefs.js
echo user_pref("browser.safebrowsing.downloads.remote.enabled", false);>>prefs.js
echo user_pref("browser.safebrowsing.downloads.remote.url", "");>>prefs.js
echo user_pref("browser.safebrowsing.id", "");>>prefs.js
echo user_pref("browser.safebrowsing.reportPhishURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.malware.enabled", false);>>prefs.js
echo user_pref("browser.safebrowsing.phishing.enabled", false);>>prefs.js
echo user_pref("datareporting.healthreport.uploadEnabled", false);>>prefs.js
echo user_pref("datareporting.policy.dataSubmissionEnabled", false);>>prefs.js
echo user_pref("browser.newtabpage.activity-stream.feeds.telemetry", false);>>prefs.js
echo user_pref("browser.newtabpage.activity-stream.telemetry", false);>>prefs.js
echo user_pref("browser.ping-centre.telemetry", false);>>prefs.js
echo user_pref("app.update.auto.migrated", false);>>prefs.js
echo user_pref("dom.push.connection.enabled", false);>>prefs.js
echo user_pref("dom.push.enabled", false);>>prefs.js
echo user_pref("dom.push.serverURL", "");>>prefs.js
echo user_pref("browser.topsites.contile.enabled", false);>>prefs.js
echo user_pref("browser.topsites.contile.endpoint", "");>>prefs.js
echo user_pref("messaging-system.rsexperimentloader.enabled", false);>>prefs.js
echo user_pref("app.normandy.enabled", false);>>prefs.js
echo user_pref("network.dns.disablePrefetch", true);>>prefs.js
echo user_pref("network.prefetch-next", false);>>prefs.js
echo user_pref("privacy.resistFingerprinting", true);>>prefs.js
echo user_pref("extensions.systemAddon.update.enabled", false);>>prefs.js
echo user_pref("browser.safebrowsing.provider.google.gethashURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google.lists", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google.reportURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google.updateURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google4.dataSharingURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google4.gethashURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google4.reportURL", "");>>prefs.js
echo user_pref("browser.safebrowsing.provider.google4.updateURL", "");>>prefs.js
echo user_pref("extensions.pocket.enabled", false);>>prefs.js
echo.
echo FireFox Are Debloated Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:DiscordDebloat
cls
@echo Closing Discord!
TASKKILL /T /F /IM  discord.exe
CLS
CHOICE /C YN /M "Debloat your Discord?"
IF %ERRORLEVEL% EQU 1 (
@echo Removing bloat!
cd /d "%HOMEPATH%\appdata\Local\discord\"
DEL /f "%HOMEPATH%\AppData\Local\Discord\Discord_updater_rCURRENT.log"
DEL /f "%HOMEPATH%\AppData\Local\Discord\SquirrelSetup.log"
rmdir /s /q "%HOMEPATH%\appdata\Roaming\Microsoft\Windows\Start Menu\Programs\Discord Inc"
rmdir /s /q "%HOMEPATH%\appdata\Local\discord\download"
dir discord_game_sdk_x64.dll /a /b /s
del discord_game_sdk_x64.dll /a /s
dir discord_game_sdk_x86.dll /a /b /s
del discord_game_sdk_x86.dll /a /s
for /f "delims=" %%a in ('dir /b /s /ad discord_cloudsync') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_dispatch') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_erlpack') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_media') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_spellcheck') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_game_utils') do (
    rmdir /s /q "%%a"
)
dir af.pak /a /b /s
del af.pak /a /s
dir am.pak /a /b /s
del am.pak /a /s
dir ar.pak /a /b /s
del ar.pak /a /s
dir bg.pak /a /b /s
del bg.pak /a /s
dir bn.pak /a /b /s
del bn.pak /a /s
dir ca.pak /a /b /s
del ca.pak /a /s
dir cs.pak /a /b /s
del cs.pak /a /s
dir da.pak /a /b /s
del da.pak /a /s
dir de.pak /a /b /s
del de.pak /a /s
dir el.pak /a /b /s
del el.pak /a /s
dir en-GB.pak /a /b /s
del en-GB.pak /a /s
dir es.pak /a /b /s
del es.pak /a /s
dir es-419.pak /a /b /s
del es-419.pak /a /s
dir et.pak /a /b /s
del et.pak /a /s
dir fa.pak /a /b /s
del fa.pak /a /s
dir fi.pak /a /b /s
del fi.pak /a /s
dir fil.pak /a /b /s
del fil.pak /a /s
dir fr.pak /a /b /s
del fr.pak /a /s
dir gu.pak /a /b /s
del gu.pak /a /s
dir he.pak /a /b /s
del he.pak /a /s
dir hi.pak /a /b /s
del hi.pak /a /s
dir hr.pak /a /b /s
del hr.pak /a /s
dir hu.pak /a /b /s
del hu.pak /a /s
dir id.pak /a /b /s
del id.pak /a /s
dir it.pak /a /b /s
del it.pak /a /s
dir ja.pak /a /b /s
del ja.pak /a /s
dir kn.pak /a /b /s
del kn.pak /a /s
dir ko.pak /a /b /s
del ko.pak /a /s
dir lt.pak /a /b /s
del lt.pak /a /s
dir lv.pak /a /b /s
del lv.pak /a /s
dir ml.pak /a /b /s
del ml.pak /a /s
dir mr.pak /a /b /s
del mr.pak /a /s
dir ms.pak /a /b /s
del ms.pak /a /s
dir nb.pak /a /b /s
del nb.pak /a /s
dir nl.pak /a /b /s
del nl.pak /a /s
dir pl.pak /a /b /s
del pl.pak /a /s
dir pt-BR.pak /a /b /s
del pt-BR.pak /a /s
dir pt-PT.pak /a /b /s
del pt-PT.pak /a /s
dir ro.pak /a /b /s
del ro.pak /a /s
dir ru.pak /a /b /s
del ru.pak /a /s
dir sk.pak /a /b /s
del sk.pak /a /s
dir sl.pak /a /b /s
del sl.pak /a /s
dir sr.pak /a /b /s
del sr.pak /a /s
dir sv.pak /a /b /s
del sv.pak /a /s
dir sw.pak /a /b /s
del sw.pak /a /s
dir ta.pak /a /b /s
del ta.pak /a /s
dir te.pak /a /b /s
del te.pak /a /s
dir th.pak /a /b /s
del th.pak /a /s
dir tr.pak /a /b /s
del tr.pak /a /s
dir uk.pak /a /b /s
del uk.pak /a /s
dir ur.pak /a /b /s
del ur.pak /a /s
dir vi.pak /a /b /s
del vi.pak /a /s
dir zh-CN.pak /a /b /s
del zh-CN.pak /a /s
dir zh-TW.pak /a /b /s
del zh-TW.pak /a /s
echo Y | schtasks /create /tn "\Berserker\DiscordDebloater" /tr "C:\ProgramData\Berserker-tasks\hidediscorddebloater.vbs" /sc ONLOGON /ru "%USERDOMAIN%\%USERNAME%"
CLS
@echo Done!)
CHOICE /C YN /M "Remove krisp?(noise suppression - krisp will be removed)"
IF %ERRORLEVEL% EQU 1 (
cd /d "%HOMEPATH%\appdata\Local\discord\"
for /f "delims=" %%a in ('dir /b /s /ad discord_krisp') do (
    rmdir /s /q "%%a"
)
mkdir "%ProgramData%\Berserker-tasks\krisp"
CLS
@echo Done!)
CHOICE /C YN /M "Remove overlay?(overlay in games)"
IF %ERRORLEVEL% EQU 1 (
cd /d "%HOMEPATH%\appdata\Local\discord\"
for /f "delims=" %%a in ('dir /b /s /ad discord_overlay2') do (
    rmdir /s /q "%%a"
)
for /f "delims=" %%a in ('dir /b /s /ad discord_rpc') do (
    rmdir /s /q "%%a"
)
mkdir "%ProgramData%\Berserker-tasks\overlay"
CLS
@echo Done!)
@echo Everything done!
@echo Credit goes to:Chrometastic and Velo!
@echo Created by:Matekoo !
@echo Krisp command created by iiiKariFPS!
Pause > Nul
goto DebloatPrograms

:SteamDebloatorsettingsidk
cls
reg add "HKCU\Software\Valve\Steam" /v "SuppressAutoRun" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "Restart" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "BigPictureInForeground" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "GPUAccelWebViews" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "SmoothScrollWebViews" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "DPIScaling" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "H264HWAccel" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Valve\Steam" /v "StartupMode" /t REG_DWORD /d "0" /f
echo.
echo Steam Settings Finish Press enter to go to Debloat Programs.
Pause > Nul
goto DebloatPrograms

:SecurityTweaks
cls
echo   â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—
echo   â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â•šâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•”â•
echo   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘
echo   â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â–‘
echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘
echo   â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â–‘â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   [1] Disable Meltdown and Spectre          [9] Enable Meltdown and Spectre
echo   [2] Disable Mitigations                   [10] Enable Mitigations [NOT ADDED]
echo   [3] Disable DEP (FACEIT, Valorant bricks) [11] Enable DEP
echo   [4] Disable CFG                           [12] Enable CFG [NOT ADDED]
echo   [5] Disable Windows Firewall              [13] Enable Windows Firewall [NOT ADDED]
echo   [6] Disable DmaRemapping                  [14] Enable DmaRemapping
echo   [7] Disable Windows Defender              [15] Enable Windows Defender
echo   [8] Remove CPU microcode updates          [16] Enable Mitigations for Valorant
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto DisableMeltdown
if /i %input% == 2 goto JustDisableMiti
if /i %input% == 3 goto DisableDEP
if /i %input% == 4 goto DisableCFG
if /i %input% == 5 goto DisableFirewall
if /i %input% == 6 goto DisableDMA
if /i %input% == 7 goto DefenderDisable
if /i %input% == 8 goto MicrocodeRemove
if /i %input% == 9 goto EnableMeltdown
if /i %input% == 10 goto EnableMiti
if /i %input% == 11 goto EnableDEP
if /i %input% == 12 goto EnableCFG
if /i %input% == 13 goto EnableFirewall
if /i %input% == 14 goto EnableDMA
if /i %input% == 15 goto DefenderEnable
if /i %input% == 16 goto MitiValo
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto SecurityTweaks

:DisableMeltdown
cls
wmic cpu get name | findstr "Intel" >nul && (
    reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverride" /t REG_DWORD /d 3 /f
)
wmic cpu get name | findstr "AMD" >nul && (
    reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverride" /t REG_DWORD /d 64 /f
)
echo.
echo Meltdown and Spectre has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:JustDisableMiti
cls
powershell "ForEach($v in (Get-Command -Name \"Set-ProcessMitigation\").Parameters[\"Disable\"].Attributes.ValidValues){Set-ProcessMitigation -SYSTEM -Disable $v.ToString() -ErrorAction SilentlyContinue}" 
for /f "tokens=3 skip=2" %%a in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "MitigationAuditOptions"') do set mitigation_mask=%%a
for /L %%a in (0,1,9) do (
    set "mitigation_mask=!mitigation_mask:%%a=2!
)
for %%a in (
    ApplicationFrameHost.exe
    fontdrvhost.exe
    dasHost.exe
    dllhost.exe
    dwm.exe
    lsass.exe
    svchost.exe
    WmiPrvSE.exe
    wininit.exe
    winlogon.exe
    csrss.exe
    audiodg.exe
    ntoskrnl.exe
    services.exe
    RuntimeBroker.exe
    ShellExperienceHost.exe
    sihost.exe
    splwow64.exe
    spoolsv.exe
    SystemSettings.exe
    smss.exe
    sppsvc.exe
    TiWorker.exe
    TextInputHost.exe
) do (
    reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\%%a" /v "MitigationOptions" /t REG_BINARY /d "!mitigation_mask!" /f 
    reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\%%a" /v "MitigationAuditOptions" /t REG_BINARY /d "!mitigation_mask!" /f 
)
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "MitigationOptions" /t REG_BINARY /d "!mitigation_mask!" /f 
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "MitigationAuditOptions" /t REG_BINARY /d "!mitigation_mask!" /f 
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SYSTEM\ControlSet001\Services\DcomLaunch" /v "MitigationFlags" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg delete "HKLM\SYSTEM\ControlSet001\Services\RpcSs" /v "MitigationFlags" /f
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo Windows 11 not detected >nul 2>&1
) else (
reg delete "HKLM\SYSTEM\ControlSet001\Services\pci\Parameters" /v "PnpAsyncNewDevices" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\PcaSvc" /v "DelayedAutostart" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\partmgr" /v "EnableCounterForIoctl" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\AFD\Parameters" /v "DoNotHoldNicBuffers" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\BrokerInfrastructure" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\DeviceInstall" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\PlugPlay" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\Power" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\RpcEptMapper" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\Schedule" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\SysMain" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\SystemEventsBroker" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\TimeBrokerSvc" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\LSM" /v "MitigationFlags" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\DeviceInstall\Parameters" /v "DeviceInstallMode" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\cbdhsvc" /v "DelayedAutostart" /f
reg delete "HKLM\SYSTEM\ControlSet001\Services\W32Time" /v "DelayedAutostart" /f
)
reg add "HKLM\SOFTWARE\Policies\Microsoft\FVE" /v "DisableExternalDMAUnderLock" /t REG_DWORD /d "0" /fecho.
echo Mitigations has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:DisableDEP
cls
bcdedit /set nx AlwaysOff
echo.
echo DEP has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:DisableCFG
cls
powershell "set-ProcessMitigation -System -Disable  DEP, EmulateAtlThunks, SEHOP, ForceRelocateImages, RequireInfo, BottomUp, HighEntropy, StrictHandle, DisableWin32kSystemCalls, AuditSystemCall, DisableExtensionPoints, BlockDynamicCode, AllowThreadsToOptOut, AuditDynamicCode, CFG, SuppressExports, StrictCFG, MicrosoftSignedOnly, AllowStoreSignedBinaries, AuditMicrosoftSigned, AuditStoreSigned, EnforceModuleDependencySigning, DisableNonSystemFonts, AuditFont, BlockRemoteImageLoads, BlockLowLabelImageLoads, PreferSystem32, AuditRemoteImageLoads, AuditLowLabelImageLoads, AuditPreferSystem32, EnableExportAddressFilter, AuditEnableExportAddressFilter, EnableExportAddressFilterPlus, AuditEnableExportAddressFilterPlus, EnableImportAddressFilter, AuditEnableImportAddressFilter, EnableRopStackPivot, AuditEnableRopStackPivot, EnableRopCallerCheck, AuditEnableRopCallerCheck, EnableRopSimExec, AuditEnableRopSimExec, SEHOP, AuditSEHOP, SEHOPTelemetry, TerminateOnError, DisallowChildProcessCreation, AuditChildProcess" >nul 2>&1
echo.
echo CFG has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:DisableFirewall
cls
powershell -NoProfile "$net=get-netconnectionprofile; Set-NetConnectionProfile -Name $net.Name -NetworkCategory Private" >nul 2>&1
reg delete "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules" /f > nul 2> nul
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules" /f > nul 2> nul
netsh advfirewall set allprofiles state off > nul 2> nul
netsh advfirewall firewall set rule group="Network Discovery" new enable=No > nul 2> nul
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f
echo.
echo Firewall has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:DisableDMA
cls
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PolicyManager\default\DmaGuard\DeviceEnumerationPolicy" /v "value" /t REG_DWORD /d "2" /f
for /f %%l in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" /s /f DmaRemappingCompatible ^| find /i "Services\" ') do (
	echo %%l...
	reg add "%%l" /v "DmaRemappingCompatible" /t REG_DWORD /d "0" /f
)
for /f %%k in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" /s /f DmaRemappingCompatibleSelfhost ^| find /i "Services\" ') do (
	echo %%k...
	reg add "%%k" /v "DmaRemappingCompatibleSelfhost" /t REG_DWORD /d "0" /f
)
echo.
echo DmaRemapping has been Disabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableMeltdown
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverride" /t REG_DWORD /d 0 /f
echo.
echo Meltdown and Spectre has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableMiti
cls

echo.
echo Mitigations has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableDEP
cls
bcdedit /set nx OptIn
echo.
echo DEP has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableCFG
cls

echo.
echo CFG has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableFirewall
cls

echo.
echo Firewall has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:EnableDMA
cls
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PolicyManager\default\DmaGuard\DeviceEnumerationPolicy" /v "value" /t REG_DWORD /d "1" /f
for /f %%l in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" /s /f DmaRemappingCompatible ^| find /i "Services\" ') do (
	echo %%l...
	reg add "%%l" /v "DmaRemappingCompatible" /t REG_DWORD /d "1" /f
)
for /f %%k in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" /s /f DmaRemappingCompatibleSelfhost ^| find /i "Services\" ') do (
	echo %%k...
	reg add "%%k" /v "DmaRemappingCompatibleSelfhost" /t REG_DWORD /d "1" /f
)
echo.
echo DMARemapping has been Enabled. Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks

:DefenderDisable
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Real-Time Protection" /v "DpaDisabled" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiVirus" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableRoutinelyTakingAction" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet" /v "SpyNetReporting" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Features" /v "TamperProtection" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Real-Time Protection" /v "DpaDisabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Sense" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecCore" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecFlt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecWfp" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wscsvc" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdFilter" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdBoot" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmBroker" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinDefend" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService" /v "Start" /t REG_DWORD /d "4" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "SecurityHealth" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "SecurityHealth" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "EnableSmartScreen" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Control\WMI\Autologger\DefenderApiLogger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Control\WMI\Autologger\DefenderAuditLogger" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Security Center" /v "cval" /t REG_DWORD /d "0" /f
schtasks /Change /TN "Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh" /Disable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance" /Disable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Cleanup" /Disable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan" /Disable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Verification" /Disable
echo.
echo Defender Are Disable. Press enter to go to Back.
Pause > Nul
goto SecurityTweaks

:MicrocodeRemove
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c del /f /q C:\Windows\System32\mcupdate_GenuineIntel.dll
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c del /f /q C:\Windows\System32\mcupdate_AuthenticAMD.dll
echo.
echo CPU microcode updates removed. Press enter to go to Back.
Pause > Nul
goto SecurityTweaks

:DefenderEnable
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Real-Time Protection" /v "DpaDisabled" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiVirus" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet" /v "SpyNetReporting" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Features" /v "TamperProtection" /t REG_DWORD /d "1" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender\Real-Time Protection" /v "DpaDisabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Sense" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecCore" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsSecWfp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wscsvc" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdFilter" /v "Start" /t REG_DWORD /d "0" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdBoot" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmAgent" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmBroker" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinDefend" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService" /v "Start" /t REG_DWORD /d "3" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "EnableSmartScreen" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "SecurityHealth"  /t REG_EXPAND_SZ /d "%windir%\system32\SecurityHealthSystray.exe" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "SecurityHealth" /t REG_BINARY /d "060000000000000000000000" /f
reg add "HKLM\System\CurrentControlSet\Control\WMI\Autologger\DefenderApiLogger" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Control\WMI\Autologger\DefenderAuditLogger" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Microsoft\Security Center" /v "cval" /t REG_DWORD /d "1" /f
schtasks /Change /TN "Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh" /Enable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance" /Enable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Cleanup" /Enable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan" /Enable
schtasks /Change /TN "Microsoft\Windows\Windows Defender\Windows Defender Verification" /Enable
echo.
echo Defender Are Enable. Press enter to go to Back.
Pause > Nul
goto SecurityTweaks

:MitiValo
cls
for %%i in (valorant valorant-win64-shipping vgtray vgc) do (
    PowerShell -NoProfile -Command "Set-ProcessMitigation -Name %%i.exe -Enable CFG"
)
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "MitigationAuditOptions" /t REG_BINARY /d "222222222222222222222222222222222222222222222222" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "MitigationOptions" /t REG_BINARY /d "232222222223222222222222222222222222222222222222" /f
echo.
echo Mitigations for Valorant has been Enabled Press enter to go to Security tweaks.
Pause > Nul
goto SecurityTweaks


:DisbleServc
cls
echo    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
echo    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
echo    â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
echo    â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â•šâ•â•â•â–ˆâ–ˆâ•— â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–‘â•šâ•â•â•â–ˆâ–ˆâ•—
echo    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â–‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo    â•šâ•â•â•â•â•â•â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â–‘ â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â•šâ•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â–‘
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo            %RED%Disable Services%reset%                                     %green%Re-Enable Services%reset%                     %Red%Disable More Services%Reset%
echo   [1] Disable Unnecessary Services, Drivers              [14] Enable Unnecessary Services, Drivers [27] Disable All (Detects wifi and Not Disable: Xbox-Store, Encryption things, NTFS Encryption)
echo   [2] Disable Diagnostics                                [15] Enable Diagnostics                   [28] Enable All
echo   [3] Disable NTFS Encryption (some UWP apps require it) [16] Enable Encryption                    [29] Disable Encryption things(Windows Updates bricks)
echo   [4] Disable Bluetooth                                  [17] Enable Bluetooth                     [30] Enable Encryption things
echo   [5] Disable Clipboard history                          [18] Enable Clipboard history
echo   [6] Disable Lanman Workstation (Needed for some apps)  [19] Enable Lanman Workstation
echo   [7] Disable Notifications                              [20] Enable Notifications
echo   [8] Disable Printing                                   [21] Enable Printing
echo   [9] Disable Remote Desktop                             [22] Enable Remote Desktop
echo   [10] Disable UAC (Needed for some UWP apps)            [23] Enable UAC
echo   [11] Disable VPN                                       [24] Enable VPN
echo   [12] Disable WiFi                                      [25] Enable WiFi
echo   [13] Disable Xbox, Store Services(Bricks wupdate)      [26] Enable Xbox, Store Services
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto DisableServicesDrivers
if /i %input% == 2 goto DisableDiag
if /i %input% == 3 goto DisableEncry
if /i %input% == 4 goto DisableBluetooth
if /i %input% == 5 goto DisableClipboard
if /i %input% == 6 goto DisableLanman
if /i %input% == 7 goto DisableNoti
if /i %input% == 8 goto DisablePrinting
if /i %input% == 9 goto DisableRemote
if /i %input% == 10 goto DisableUAC
if /i %input% == 11 goto DisableVPN
if /i %input% == 12 goto DisableWifi
if /i %input% == 13 goto DisableXbox
if /i %input% == 14 goto EnableServicesDrivers
if /i %input% == 15 goto EnableDiag
if /i %input% == 16 goto EnableEncry
if /i %input% == 17 goto EnableBluetooth
if /i %input% == 18 goto EnableClipboard
if /i %input% == 19 goto EnableLanman
if /i %input% == 20 goto EnableNoti
if /i %input% == 21 goto EnablePrinting
if /i %input% == 22 goto EnableRemote
if /i %input% == 23 goto EnableUAC
if /i %input% == 24 goto EnableVPN
if /i %input% == 25 goto EnableWifi
if /i %input% == 26 goto EnableXbox
if /i %input% == 27 goto DisableAll
if /i %input% == 28 goto EnableAll
if /i %input% == 29 goto DisableEnc
if /i %input% == 30 goto EnableEnc
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DisbleServc

:DisableEnc
cls
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{4d36e967-e325-11ce-bfc1-08002be10318}" /v "LowerFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{4d36e96c-e325-11ce-bfc1-08002be10318}" /v "UpperFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{6bdd1fc6-810f-11d0-bec7-08002be2092f}" /v "UpperFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{ca3e7ab9-b4c3-4ae6-8251-579ef933890f}" /v "UpperFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{71a27cdd-812a-11d0-bec7-08002be2092f}" /v "LowerFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{71a27cdd-812a-11d0-bec7-08002be2092f}" /v "UpperFilters" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorClass" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rdyboost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fvevol" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iorate" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volsnap" /v "Start" /t REG_DWORD /d "3" /f
echo.
echo Encryption Services, Drivers has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:EnableEnc
cls
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{4d36e967-e325-11ce-bfc1-08002be10318}" /v "LowerFilters" /t REG_MULTI_SZ /d "EhStorClass" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{4d36e96c-e325-11ce-bfc1-08002be10318}" /v "UpperFilters" /t REG_MULTI_SZ /d "ksthunk" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{6bdd1fc6-810f-11d0-bec7-08002be2092f}" /v "UpperFilters" /t REG_MULTI_SZ /d "ksthunk" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{ca3e7ab9-b4c3-4ae6-8251-579ef933890f}" /v "UpperFilters" /t REG_MULTI_SZ /d "ksthunk" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{71a27cdd-812a-11d0-bec7-08002be2092f}" /v "LowerFilters" /t REG_MULTI_SZ /d "fvevol\0iorate\0rdyboost" /f
reg add "HKLM\SYSTEM\ControlSet001\Control\Class\{71a27cdd-812a-11d0-bec7-08002be2092f}" /v "UpperFilters" /t REG_MULTI_SZ /d "volsnap" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorClass" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rdyboost" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fvevol" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iorate" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volsnap" /v "Start" /t REG_DWORD /d "0" /f
echo.
echo Encryption Services, Drivers has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:DisableServicesDrivers
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Services\1394ohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ACPI" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpiex" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpipagr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiPmi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpitime" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Acx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ADP80XX" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AFD" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\afunix" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ahcache" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdgpio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AmdK8" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AmdPPM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdsata" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdsbs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdxata" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppID" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleKmdfFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleLowerFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\applockerfltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AsyncMac" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\atapi" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0MMCSS\0AudioEndpointBuilder" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicDisplay" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicRender" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bcmfn2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Beep" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bindflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bowser" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BrokerInfrastructure" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bttflt" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\buttonconverter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CAD" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\camsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdrom" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\circlass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cloudidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CmBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CNG" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cnghwassist" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CompositeBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\condrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CoreMessagingRegistrar" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CryptSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcpsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\defragsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceInstall" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dfsc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dhcp" /v "Start" /t REG_DWORD /d "2" /f
sc config diagnosticshub.standardcollector.service start= disabled
sc config diagsvc start= disabled
sc config DiagTrack start= disabled
sc config RetailDemo start= disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Services\disk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DispBrokerDesktopSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DisplayEnhancementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "DependOnService" /t REG_MULTI_SZ /d "nsi" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dot3svc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\drmkaud" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DXGKrnl" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Eaphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EntAppSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ErrDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\exfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fastfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fdPHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FDResPub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Filetrace" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FltMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FsDepends" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Fs_Rec" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\genericusbfn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GPIOClx0101" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RPCSS" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GpuEnergyDrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HdAudAddService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HDAudBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidinterrupt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidserv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidspi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidUsb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HTTP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HwNClx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hwpolicy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iagpio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iai2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_GPIO" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IaNVMe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorAVC" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorV" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\icssvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IndirectKmd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpFilterDriver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iphlpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSS\0winmgmt\0tcpip\0nsi" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPMIDRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPNAT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\isapnp" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KeyIso" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KSecDD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ksthunk" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lmhosts" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSI_SSS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSM" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LxpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbhost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\McpManagementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MMCSS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\monitor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mountmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MRxDAV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb20" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSDTC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Msfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msgpiowin32" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidkmdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidumdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msisadrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msiserver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSKSSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsLldp" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPCLOCK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPQM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsQuic" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsRPC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mssmbios" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSTEE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MTConfig" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Mup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mvumis" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NativeWifiP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcbService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcdAutoSetup" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDIS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisCap" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisTapi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndisuio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisVirtualBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisWan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndiswanlegacy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDKPing" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetAdapterCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netlogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netman" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\netprofm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetSetupSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "DependOnService" /t REG_MULTI_SZ /d "NSI\0RpcSs\0TcpIp\0Dhcp" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Npfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\npsvctrig" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsi" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsiproxy" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ntfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Null" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nvdimm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2pimsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2psvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Parport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\partmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pciide" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcmcia" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcw" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pdc" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PEAUTH" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PerfHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PktMon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PlugPlay" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNPMEM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPAutoReg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\portcfg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Power" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PptpMiniport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintNotify" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintWorkflowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Processor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ProfSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Psched" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVEdrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ramdisk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAcd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAgileVpn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAuto" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Rasl2tp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasPppoe" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasSstp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFSv1" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rhproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RpcEptMapper" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rspndr" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rt640x64" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RTWlanE" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\SamSs" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sbp2port" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Schedule" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\scmbus" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdstor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\seclogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\secnvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorDataService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serial" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sermouse" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ShellHWDetection" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SmartSAMD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SpbCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srv2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srvnet" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SSDPSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StateRepository" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storahci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StorSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storufs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\svsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swprv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SysMain" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SystemEventsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TabletInputService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TapiSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tcpipreg" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tdx" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Themes" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TimeBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\TrkWks" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\TrustedInstaller" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TsUsbFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tunnel" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tzautoupdate" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UASPStor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmTcpciCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiAcpiClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ucx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdeCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\udfs" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdkUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UEFI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ufx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UfxChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ufxsynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\umbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UmPass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UnistoreSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\upnphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsCx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsSynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbccgp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbehci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbhub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBHUB3" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbprint" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbuhci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBXHCI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserDataSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vdrvroot" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vds" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VerifierExt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhdmp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgrx" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VSS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifibus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwififlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifimp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WSearch" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\W32Time" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WacomPen" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarpv6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WarpJITSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcifs" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcnfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wdf01000" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wdiwifi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdmCompanionFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wecsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WEPHOSTSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFDSConMgrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFPLWFS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WiaRpc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WIMMount" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRTProxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Winmgmt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinNat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WINUSB" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WManSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WmiAcpi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wmiApSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wof" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpdUpFltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ws2ifsl" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WudfPf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WUDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xboxgip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\XboxGipSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xinputhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBIOS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBT" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storqosflt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\spaceport" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CimFS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CSC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CscService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorTcgDrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MapsBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndu" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PhoneSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Vid" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo Unnecessary Services, Drivers has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:DisableDiag
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Windows" /v "NoInteractiveServices" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DiagLog" /v "Start" /t REG_DWORD /d "0" /f >nul 2>&1
sc config DPS start=disabled >nul 2>&1
echo.
echo Diagnostics Services has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableEncry
cls
fsutil behavior set disableencryption 1
reg add "HKLM\SYSTEM\CurrentControlSet\Policies" /v "NtfsDisableEncryption" /t REG_DWORD /d "1" /f
echo.
echo Encryption has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:DisableBluetooth
cls
devcon disable BTH* >nul 2>&1
sc config BthA2dp start=disabled >nul 2>&1
sc config BthEnum start=disabled >nul 2>&1
sc config BthHFEnum start=disabled >nul 2>&1
sc config BthLEEnum start=disabled >nul 2>&1
sc config BthMini start=disabled >nul 2>&1
sc config BTHMODEM start=demand >nul 2>&1
sc config BthPan start=disabled >nul 2>&1
sc config BTHPORT start=disabled >nul 2>&1
sc config BTHUSB start=disabled >nul 2>&1
sc config HidBth start=disabled >nul 2>&1
sc config Microsoft_Bluetooth_AvrcpTransport start=disabled >nul 2>&1
sc config RFCOMM start=disabled >nul 2>&1
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
sc config BluetoothUserService start=disabled >nul 2>&1
sc config BTAGService start=disabled >nul 2>&1
sc config BthAvctpSvc start=disabled >nul 2>&1
sc config bthserv start=disabled >nul 2>&1
sc config Modem start=disabled >nul 2>&1
timeout /t 2 /nobreak >nul 2>&1
devcon disable =Bluetooth >nul 2>&1
echo.
echo Bluethooth Services has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableClipboard
cls
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo Clipboard history has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableLanman
cls
sc config rdbss start=demand >nul 2>&1
sc config KSecPkg start=disabled >nul 2>&1
sc config LanmanWorkstation start=disabled >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters" /v "AutoShareWks" /t REG_DWORD /d "0" /f >nul 2>&1
echo.
echo Lanman Workstation has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableNoti
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnService" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v "ToastEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications" /v "NoCloudApplicationNotification" /t REG_DWORD /d "1" /f >nul 2>&1
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f >nul 2>&1
echo.
echo Notifications has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisablePrinting
cls
devcon disable "=Printer" >nul 2>&1
devcon disable "=PrintQueue" >nul 2>&1
sc config Spooler start=disabled >nul 2>&1
sc stop Spooler >nul 2>&1
dism /online /Disable-Feature /FeatureName:Printing-Foundation-InternetPrinting-Client >nul 2>&1
dism /online /Disable-Feature /FeatureName:Printing-Foundation-Features >nul 2>&1
echo.
echo Printing has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableRemote
cls
reg add "HKLM\System\CurrentControlSet\Services\rdpbus" /v "Start" /t REG_DWORD /d "4" /f
devmanview /disable "Remote Dekstop Device Redirector Bus"
echo.
echo Remote Desktop has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableUAC
cls
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableLUA" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\luafv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Appinfo" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ConsentPromptBehaviorAdmin" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ConsentPromptBehaviorUser" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableInstallerDetection" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableSecureUIAPaths" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableVirtualization" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "FilterAdministratorToken" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "PromptOnSecureDesktop" /t REG_DWORD /d "0" /f
echo.
echo UAC has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableVPN
cls
reg add "HKLM\System\CurrentControlSet\Services\IKEEXT" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PolicyAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SstpSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\RasMan" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo VPN Services has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableWifi
cls
reg add "HKLM\System\CurrentControlSet\Services\wlansvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Wcmsvc" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo WiFi Services has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:DisableXbox
cls
reg add "HKLM\System\CurrentControlSet\Services\WpnUserService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\XblAuthManager" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\XblGameSave" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\XboxNetApiSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "ErrorControl" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcCtnrSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\InstallService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wlidsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TokenBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\LicenseManager" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ClipSVC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DoSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\GameInput Service" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServices" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServicesNet" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo Xbox, MsStore Services has been Disabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableServicesDrivers
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Services\1394ohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ACPI" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpiex" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpipagr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiPmi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpitime" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Acx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ADP80XX" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AFD" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\afunix" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ahcache" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdgpio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdxata" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppID" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleKmdfFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleLowerFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\applockerfltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AsyncMac" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\atapi" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0MMCSS\0AudioEndpointBuilder" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicDisplay" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicRender" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bcmfn2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Beep" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bindflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bowser" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BrokerInfrastructure" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bttflt" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\buttonconverter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CAD" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\camsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdrom" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\circlass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cloudidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CmBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CNG" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cnghwassist" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CompositeBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\condrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CoreMessagingRegistrar" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CryptSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcpsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\defragsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceInstall" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dfsc" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dhcp" /v "Start" /t REG_DWORD /d "2" /f
sc config diagnosticshub.standardcollector.service start= disabled
sc config diagsvc start= disabled
sc config DiagTrack start= disabled
sc config RetailDemo start= disabled
reg add "HKLM\SYSTEM\CurrentControlSet\Services\disk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DispBrokerDesktopSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DisplayEnhancementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "DependOnService" /t REG_MULTI_SZ /d "nsi\0Afd" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dot3svc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\drmkaud" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DXGKrnl" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Eaphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EntAppSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ErrDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\exfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fastfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fdPHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FDResPub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Filetrace" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FltMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FsDepends" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Fs_Rec" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\genericusbfn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GPIOClx0101" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RPCSS\0Mup" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GpuEnergyDrv" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HdAudAddService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HDAudBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidinterrupt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidserv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidspi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidUsb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HTTP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HwNClx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hwpolicy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iagpio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iai2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_GPIO" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IaNVMe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorAVC" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorV" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\icssvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IndirectKmd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpFilterDriver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iphlpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSS\0winmgmt\0tcpip\0nsi\0WinHttpAutoProxySvc" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPMIDRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPNAT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\isapnp" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KeyIso" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KSecDD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ksthunk" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdio" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lmhosts" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSI_SSS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSM" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LxpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbhost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\McpManagementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MMCSS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\monitor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mountmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MRxDAV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb20" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSDTC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Msfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msgpiowin32" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidkmdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidumdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msisadrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msiserver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSKSSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsLldp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPCLOCK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPQM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsQuic" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsRPC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mssmbios" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSTEE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MTConfig" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Mup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mvumis" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NativeWifiP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcbService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcdAutoSetup" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDIS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisCap" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisTapi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndisuio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisVirtualBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisWan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndiswanlegacy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDKPing" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetAdapterCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netlogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netman" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\netprofm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetSetupSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "DependOnService" /t REG_MULTI_SZ /d "NSI\0RpcSs\0TcpIp\0Dhcp\0Eventlog" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Npfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\npsvctrig" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsi" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsiproxy" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ntfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Null" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nvdimm" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2pimsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2psvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Parport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\partmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pciide" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcmcia" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcw" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pdc" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PEAUTH" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PerfHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PktMon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PlugPlay" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNPMEM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPAutoReg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\portcfg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Power" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PptpMiniport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintNotify" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintWorkflowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Processor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ProfSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Psched" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVEdrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ramdisk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAcd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAgileVpn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAuto" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Rasl2tp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasPppoe" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasSstp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFSv1" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rhproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RpcEptMapper" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rspndr" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rt640x64" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RTWlanE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sbp2port" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Schedule" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\scmbus" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdstor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\seclogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\secnvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorDataService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serial" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ShellHWDetection" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SmartSAMD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SpbCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srv2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srvnet" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SSDPSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StateRepository" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storahci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StorSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storufs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\svsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swprv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SysMain" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SystemEventsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TabletInputService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TapiSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tcpipreg" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tdx" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Themes" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TimeBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\TrkWks" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TsUsbFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tunnel" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tzautoupdate" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UASPStor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmTcpciCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiAcpiClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ucx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdeCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\udfs" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdkUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UEFI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ufx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UfxChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ufxsynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\umbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UmPass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UnistoreSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\upnphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsCx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsSynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbccgp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbehci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbhub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBHUB3" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbprint" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbuhci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBXHCI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserDataSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0ProfSvc" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vdrvroot" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vds" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VerifierExt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhdmp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgrx" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volume" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VSS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifibus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwififlt" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifimp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WSearch" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\W32Time" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WacomPen" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarpv6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WarpJITSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcifs" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcnfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wdf01000" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wdiwifi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdmCompanionFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wecsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WEPHOSTSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFDSConMgrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFPLWFS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WiaRpc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WIMMount" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRT" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRTProxy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Winmgmt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinNat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WINUSB" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WManSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WmiAcpi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wmiApSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wof" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpdUpFltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ws2ifsl" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WudfPf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WUDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xboxgip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\XboxGipSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xinputhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBIOS" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBT" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storqosflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\spaceport" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CimFS" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CSC" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CscService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorTcgDrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MapsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndu" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PhoneSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Vid" /v "Start" /t REG_DWORD /d "1" /f
echo.
echo Unnecessary Services, Drivers has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:EnableDiag
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Windows" /v "NoInteractiveServices" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DiagLog" /v "Start" /t REG_DWORD /d "1" /f >nul 2>&1
sc config DPS start=auto >nul 2>&1
echo.
echo Diagnostics Services has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableEncry
cls
fsutil behavior set disableencryption 0
reg delete "HKLM\SYSTEM\CurrentControlSet\Policies" /v "NtfsDisableEncryption" /f
echo.
echo Encryption has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:EnableBluetooth
cls
devcon enable =Bluetooth >nul 2>&1
sc config BthA2dp start=demand >nul 2>&1
sc config BthEnum start=demand >nul 2>&1
sc config BthHFEnum start=demand >nul 2>&1
sc config BthLEEnum start=demand >nul 2>&1
sc config BthMini start=demand >nul 2>&1
sc config BTHMODEM start=demand >nul 2>&1
sc config BthPan start=demand >nul 2>&1
sc config BTHPORT start=demand >nul 2>&1
sc config BTHUSB start=demand >nul 2>&1
sc config HidBth start=demand >nul 2>&1
sc config Microsoft_Bluetooth_AvrcpTransport start=demand >nul 2>&1
sc config RFCOMM start=demand >nul 2>&1
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "3" /f >nul 2>&1
sc config BluetoothUserService start=demand >nul 2>&1
sc config BTAGService start=demand >nul 2>&1
sc config BthAvctpSvc start=demand >nul 2>&1
sc config bthserv start=demand >nul 2>&1
sc config Modem start=demand >nul 2>&1
timeout /t 2 /nobreak >nul 2>&1
devcon enable BTH* >nul 2>&1
echo.
echo Bluethooth Services has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableClipboard
cls
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "3" /f
echo.
echo Clipboard history has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableLanman
cls
sc config rdbss start=system >nul 2>&1
sc config KSecPkg start=boot >nul 2>&1
sc config LanmanWorkstation start=auto >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters" /v "AutoShareWks" /t REG_DWORD /d "1" /f >nul 2>&1
echo.
echo Lanman Workstation has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableNoti
cls
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnService" /v "Start" /t REG_DWORD /d "2" /f >nul 2>&1
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnUserService" /v "Start" /t REG_DWORD /d "2" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v "ToastEnabled" /t REG_DWORD /d "1" /f >nul 2>&1
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications" /v "NoCloudApplicationNotification" /f >nul 2>&1
reg delete "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /f >nul 2>&1
echo.
echo Notifications has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnablePrinting
cls
devcon enable "=Printer" >nul 2>&1
devcon enable "=PrintQueue" >nul 2>&1
sc config Spooler start=auto >nul 2>&1
sc start Spooler >nul 2>&1
dism /online /Enable-Feature /FeatureName:Printing-Foundation-Features >nul 2>&1
dism /online /Enable-Feature /FeatureName:Printing-Foundation-InternetPrinting-Client >nul 2>&1
echo.
echo Printing has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableRemote
cls
reg add "HKLM\System\CurrentControlSet\Services\rdpbus" /v "Start" /t REG_DWORD /d "3" /f
devmanview /enable "Remote Dekstop Device Redirector Bus"
echo.
echo Remote Desktop has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableUAC
cls
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableLUA" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\luafv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\Appinfo" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ConsentPromptBehaviorAdmin" /t REG_DWORD /d "5" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ConsentPromptBehaviorUser" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableSecureUIAPaths" /t REG_DWORD /d "1" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "FilterAdministratorToken" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "PromptOnSecureDesktop" /t REG_DWORD /d "1" /f
echo.
echo UAC has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableVPN
cls
reg add "HKLM\System\CurrentControlSet\Services\IKEEXT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\PolicyAgent" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\SstpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\RasMan" /v "Start" /t REG_DWORD /d "3" /f
echo.
echo VPN Services has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableWifi
cls
reg add "HKLM\System\CurrentControlSet\Services\wlansvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\Wcmsvc" /v "Start" /t REG_DWORD /d "2" /f
echo.
echo WiFi Services has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc


:EnableXbox
cls
reg add "HKLM\System\CurrentControlSet\Services\WpnUserService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\XblAuthManager" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\XblGameSave" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\XboxNetApiSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "ErrorControl" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcCtnrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\iphlpsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\InstallService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\wlidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\TokenBroker" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\LicenseManager" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\ClipSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DoSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GameInput Service" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServices" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServicesNet" /v "Start" /t REG_DWORD /d "2" /f
echo.
echo Xbox, MsStore Services has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:DisableAll
cls
reg add "HKLM\System\CurrentControlSet\Services\AarSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AarSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AJRouter" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AppReadiness" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AppXSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\autotimesvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\AxInstSV" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BcastDVRUserService_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BITS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BluetoothUserService_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BTAGService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\BthAvctpSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\bthserv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CaptureService_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CertPropSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ClipSVC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ConsentUxUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\defragsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationBrokerSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicePickerUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicesFlowUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\diagnosticshub.standardcollector.service" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\diagsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DiagTrack" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DispBrokerDesktopSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DisplayEnhancementService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\dmwappushservice" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Dnscache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DPS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DsmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DsSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\EFS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\EntAppSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\EventSystem" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\fdPHost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\FDResPub" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\HvHost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\icssvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\IKEEXT" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\InstallService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\iphlpsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\LanmanServer" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\LanmanWorkstation" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\LicenseManager" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\lltdsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\lmhosts" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\LxpSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\MapsBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\MessagingService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\MessagingService_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\mpssvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\MSDTC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\MSiSCSI" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NaturalAuthentication" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NcbService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NcdAutoSetup" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Netlogon" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcCtnrSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\OneSyncSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\p2pimsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\p2psvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PerfHost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PhoneSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PimIndexMaintenanceSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PlugPlay" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PNRPAutoReg" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PNRPsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PolicyAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PrintWorkflowUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PrintWorkflowUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PushToInstall" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\QWAVE" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\RasMan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\RmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\RpcLocator" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SCardSvr" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ScDeviceEnum" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SCPolicySvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SDRSVC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SEMgrSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SENS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SensorDataService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SensorService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SensrSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SessionEnv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SgrmBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SharedAccess" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\ShellHWDetection" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\smphost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SmsRouter" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Spooler" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SSDPSRV" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\StorSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\svsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\swprv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TabletInputService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TapiSrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TermService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Themes" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TieringEngineService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\TokenBroker" /v "Start" /t REG_DWORD /d "4" /f
sc config TroubleshootingSvc start= disabled
reg add "HKLM\System\CurrentControlSet\Services\UdkUserSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UdkUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UmRdpService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UnistoreSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UnistoreSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\upnphost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UserDataSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\UserDataSvc_2e6d1" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicguestinterface" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicheartbeat" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmickvpexchange" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicrdv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicshutdown" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmictimesync" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicvmsession" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\vmicvss" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\VSS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WalletService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WarpJITSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wbengine" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WbioSrvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wcncsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WdiServiceHost" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Wecsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WEPHOSTSVC" /v "Start" /t REG_DWORD /d "4" /f
sc config wercplsupport start= disabled
sc config WerSvc start= disabled
reg add "HKLM\System\CurrentControlSet\Services\WFDSConMgrSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WiaRpc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WinHttpAutoProxySvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WinRM" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wlidsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wlpasvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WManSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\wmiApSrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WpcMonSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WPDBusEnum" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\WSearch" /v "DelayedAutoStart" /t REG_DWORD /d "0" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\spectrum" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wcncsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\diagsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "4" /f f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TrkWks" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ibtsiva" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ssh-agent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\sshd" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DoSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetTcpPortSharing" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSiSCSI" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\1394ohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ACPI" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpiex" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpipagr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Acx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ADP80XX" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AFD" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\afunix" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ahcache" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppID" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleKmdfFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleLowerFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\applockerfltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AsyncMac" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\atapi" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0MMCSS\0AudioEndpointBuilder" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicDisplay" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicRender" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bcmfn2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Beep" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bindflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bowser" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BrokerInfrastructure" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bttflt" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\buttonconverter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CAD" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\camsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdrom" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\circlass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cloudidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CmBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CNG" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cnghwassist" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CompositeBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\condrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CoreMessagingRegistrar" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CryptSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcpsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceInstall" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dfsc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dhcp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\diagnosticshub.standardcollector.service" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\diagsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DiagTrack" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\disk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DispBrokerDesktopSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DisplayEnhancementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "DependOnService" /t REG_MULTI_SZ /d "nsi" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dot3svc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\drmkaud" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DXGKrnl" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Eaphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EntAppSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ErrDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\exfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fastfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fdPHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FDResPub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Filetrace" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FltMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FsDepends" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Fs_Rec" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\genericusbfn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GPIOClx0101" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RPCSS" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GpuEnergyDrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HdAudAddService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HDAudBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidinterrupt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidserv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidspi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidUsb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HTTP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HwNClx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hwpolicy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iagpio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iai2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_GPIO" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IaNVMe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorAVC" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorV" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\icssvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IndirectKmd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpFilterDriver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iphlpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSS\0winmgmt\0tcpip\0nsi" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPMIDRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPNAT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\isapnp" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KeyIso" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KSecDD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ksthunk" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lmhosts" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSI_SSS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSM" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LxpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbhost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\McpManagementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MMCSS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\monitor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mountmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MRxDAV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb20" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSDTC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Msfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msgpiowin32" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidkmdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidumdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msisadrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msiserver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSKSSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsLldp" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPCLOCK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPQM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsQuic" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsRPC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mssmbios" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSTEE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MTConfig" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Mup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mvumis" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NativeWifiP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcbService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcdAutoSetup" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDIS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisCap" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisTapi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndisuio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisVirtualBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisWan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndiswanlegacy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDKPing" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetAdapterCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netlogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netman" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\netprofm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetSetupSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "DependOnService" /t REG_MULTI_SZ /d "NSI\0RpcSs\0TcpIp\0Dhcp" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Npfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\npsvctrig" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsi" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsiproxy" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ntfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Null" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nvdimm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2pimsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2psvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Parport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\partmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pciide" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcmcia" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcw" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pdc" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PEAUTH" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PerfHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PktMon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PlugPlay" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNPMEM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPAutoReg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\portcfg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Power" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PptpMiniport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintNotify" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintWorkflowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Processor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ProfSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Psched" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVEdrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ramdisk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAcd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAgileVpn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAuto" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Rasl2tp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasPppoe" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasSstp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFSv1" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rhproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RpcEptMapper" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rspndr" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rt640x64" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RTWlanE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sbp2port" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Schedule" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\scmbus" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdstor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\seclogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\secnvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorDataService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serial" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ShellHWDetection" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SmartSAMD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SpbCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srv2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srvnet" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SSDPSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StateRepository" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storahci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StorSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storufs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\svsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swprv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SysMain" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SystemEventsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TabletInputService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TapiSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tcpipreg" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tdx" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Themes" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TimeBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\TrkWks" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TsUsbFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tunnel" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tzautoupdate" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UASPStor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmTcpciCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiAcpiClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ucx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdeCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\udfs" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdkUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UEFI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ufx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UfxChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ufxsynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\umbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UmPass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UnistoreSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\upnphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsCx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsSynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbccgp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbehci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbhub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBHUB3" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbprint" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbuhci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBXHCI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserDataSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vdrvroot" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vds" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VerifierExt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhdmp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgrx" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volume" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VSS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifibus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwififlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifimp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WSearch" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\W32Time" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WacomPen" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarpv6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WarpJITSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcifs" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcnfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wdf01000" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wdiwifi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdmCompanionFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wecsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WEPHOSTSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFDSConMgrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFPLWFS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WiaRpc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WIMMount" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRTProxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Winmgmt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinNat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WINUSB" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WManSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WmiAcpi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wmiApSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wof" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpdUpFltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ws2ifsl" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WudfPf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WUDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xboxgip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\XboxGipSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xinputhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBIOS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBT" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storqosflt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\spaceport" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CimFS" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CSC" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CscService" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorTcgDrv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MapsBroker" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndu" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PhoneSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Vid" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Windows" /v "NoInteractiveServices" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DiagLog" /v "Start" /t REG_DWORD /d "0" /f >nul 2>&1
sc config DPS start=disabled >nul 2>&1
devcon disable BTH* >nul 2>&1
sc config BthA2dp start=disabled >nul 2>&1
sc config BthEnum start=disabled >nul 2>&1
sc config BthHFEnum start=disabled >nul 2>&1
sc config BthLEEnum start=disabled >nul 2>&1
sc config BthMini start=disabled >nul 2>&1
sc config BTHMODEM start=demand >nul 2>&1
sc config BthPan start=disabled >nul 2>&1
sc config BTHPORT start=disabled >nul 2>&1
sc config BTHUSB start=disabled >nul 2>&1
sc config HidBth start=disabled >nul 2>&1
sc config Microsoft_Bluetooth_AvrcpTransport start=disabled >nul 2>&1
sc config RFCOMM start=disabled >nul 2>&1
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
sc config BluetoothUserService start=disabled >nul 2>&1
sc config BTAGService start=disabled >nul 2>&1
sc config BthAvctpSvc start=disabled >nul 2>&1
sc config bthserv start=disabled >nul 2>&1
sc config Modem start=disabled >nul 2>&1
timeout /t 2 /nobreak >nul 2>&1
devcon disable =Bluetooth >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "4" /f
sc config rdbss start=demand >nul 2>&1
sc config KSecPkg start=disabled >nul 2>&1
sc config LanmanWorkstation start=disabled >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters" /v "AutoShareWks" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnService" /v "Start" /t REG_DWORD /d "4" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v "ToastEnabled" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND" /t REG_DWORD /d "0" /f >nul 2>&1
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications" /v "NoCloudApplicationNotification" /t REG_DWORD /d "1" /f >nul 2>&1
reg add "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /t REG_DWORD /d "1" /f >nul 2>&1
devcon disable "=Printer" >nul 2>&1
devcon disable "=PrintQueue" >nul 2>&1
sc config Spooler start=disabled >nul 2>&1
sc stop Spooler >nul 2>&1
dism /online /Disable-Feature /FeatureName:Printing-Foundation-InternetPrinting-Client >nul 2>&1
dism /online /Disable-Feature /FeatureName:Printing-Foundation-Features >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\rdpbus" /v "Start" /t REG_DWORD /d "4" /f
devmanview /disable "Remote Dekstop Device Redirector Bus"
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableLUA" /t REG_DWORD /d "0" /f
reg add "HKLM\System\CurrentControlSet\Services\luafv" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Appinfo" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\IKEEXT" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\PolicyAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\SstpSvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\RasMan" /v "Start" /t REG_DWORD /d "4" /f
reg query HKLM\SYSTEM\CurrentControlSet\Control\Class\{72631E54-78A4-11D0-BCF7-00AA00B7B32A}\0000 >nul
if %errorlevel% equ 1 (
reg add "HKLM\System\CurrentControlSet\Services\wlansvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\System\CurrentControlSet\Services\Wcmsvc" /v "Start" /t REG_DWORD /d "4" /f
)
echo.
echo All Services, Drivers has been Disabled Press enter to go to Drivers Services.
echo (Detects wifi and Not Disable: Eventlog, Xbox, Store)
Pause > Nul
goto DisbleServc

:EnableAll
cls
reg add "HKLM\System\CurrentControlSet\Services\AarSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AarSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AJRouter" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AppReadiness" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AppXSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\autotimesvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\AxInstSV" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BcastDVRUserService_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BITS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BluetoothUserService_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BTAGService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\BthAvctpSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\bthserv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CaptureService_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CDPUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CertPropSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\ClipSVC" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\ConsentUxUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\defragsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationBrokerSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicePickerUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevicesFlowUserSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DevQueryBroker_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DmEnrollmentSvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\dmwappushsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DPS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\EventLog" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\EventSystem" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\FdDevTypeCache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\fhsvc_2e6d1" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServices" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GoogleChromeElevationService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\gpsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\gupdate" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\gupdatem" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\HomeGroupListener" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\HomeGroupProvider" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\irmon" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\KeyIso" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\KtmRm_2e6d1" /v "Start" /t REG
reg add "HKLM\SYSTEM\CurrentControlSet\Services\1394ohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ACPI" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpiex" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpipagr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AcpiPmi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\acpitime" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Acx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ADP80XX" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AFD" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\afunix" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ahcache" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ALG" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdgpio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdsata" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdsbs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\amdxata" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppID" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppIDSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleKmdfFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AppleLowerFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\applockerfltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AsyncMac" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\atapi" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\AudioEndpointBuilder" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Audiosrv" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0MMCSS\0AudioEndpointBuilder" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicDisplay" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BasicRender" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BcastDVRUserService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bcmfn2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Beep" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bindflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bowser" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\BrokerInfrastructure" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\bttflt" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\buttonconverter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CAD" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\camsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CaptureService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cdrom" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\circlass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cloudidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CmBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CNG" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\cnghwassist" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CompositeBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\COMSysApp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\condrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ConsentUxUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CoreMessagingRegistrar" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CredentialEnrollmentManagerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CryptSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcpsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\defragsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceAssociationService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DeviceInstall" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicePickerUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevicesFlowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DevQueryBroker" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dfsc" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dhcp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\diagnosticshub.standardcollector.service" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\diagsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DiagTrack" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\disk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DispBrokerDesktopSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DisplayEnhancementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DmEnrollmentSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Dnscache" /v "DependOnService" /t REG_MULTI_SZ /d "nsi\0Afd" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dot3svc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\drmkaud" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DsSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DXGKrnl" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Eaphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EntAppSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ErrDev" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\exfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fastfat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fdPHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FDResPub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Filetrace" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FltMgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FontCache" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FrameServer" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\FsDepends" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Fs_Rec" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\genericusbfn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GPIOClx0101" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "Start" /t REG_DWORD /d "2" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\gpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RPCSS\0Mup" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GpuEnergyDrv" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HdAudAddService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HDAudBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidBatt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidi2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidinterrupt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidserv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hidspi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidUsb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HTTP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HwNClx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\hwpolicy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iagpio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iai2c" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_GPIO2_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_BXT_P" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_CNL" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSS2i_I2C_GLK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_GPIO" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaLPSSi_I2C" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IaNVMe" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorAVC" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iaStorV" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\icssvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IndirectKmd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpFilterDriver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\iphlpsvc" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSS\0winmgmt\0tcpip\0nsi\0WinHttpAutoProxySvc" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPMIDRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IPNAT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\IpxlatCfgSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\isapnp" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\kbdhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KeyIso" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KSecDD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ksthunk" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\KtmRm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdio" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lltdsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lmhosts" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSI_SSS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LSM" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LxpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbhost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mausbip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\McpManagementService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MMCSS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\monitor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouclass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mouhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mountmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MRxDAV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mrxsmb20" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSDTC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Msfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msgpiowin32" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidkmdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mshidumdf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msisadrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\msiserver" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSKSSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsLldp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPCLOCK" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSPQM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsQuic" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MsRPC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mssmbios" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MSTEE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MTConfig" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Mup" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\mvumis" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NativeWifiP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcbService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NcdAutoSetup" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDIS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisCap" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisTapi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndisuio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisVirtualBus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NdisWan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndiswanlegacy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NDKPing" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ndproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetAdapterCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netlogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Netman" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\netprofm" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetSetupSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NlaSvc" /v "DependOnService" /t REG_MULTI_SZ /d "NSI\0RpcSs\0TcpIp\0Dhcp\0Eventlog" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Npfs" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\npsvctrig" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsi" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nsiproxy" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ntfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Null" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\nvdimm" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2pimsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\p2psvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Parport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\partmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PcaSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pciide" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcmcia" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pcw" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pdc" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PEAUTH" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PerfHost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PimIndexMaintenanceSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PktMon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\pla" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PlugPlay" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNPMEM" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPAutoReg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PNRPsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\portcfg" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Power" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PptpMiniport" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintNotify" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PrintWorkflowUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Processor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ProfSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Psched" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\QWAVEdrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ramdisk" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAcd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAgileVpn" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasAuto" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Rasl2tp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasPppoe" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RasSstp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ReFSv1" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rhproxy" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RmSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RpcEptMapper" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rspndr" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\rt640x64" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\RTWlanE" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sbp2port" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Schedule" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\scmbus" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\sdstor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\seclogon" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\secnvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorDataService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensorService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SensrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SerCx2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Serial" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ShellHWDetection" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SmartSAMD" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SNMPTRAP" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SpbCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srv2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\srvnet" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SSDPSRV" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StateRepository" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stisvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storahci" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\stornvme" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\StorSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storufs" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\svsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swenum" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\swprv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SysMain" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SystemEventsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TabletInputService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TapiSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tcpipreg" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tdx" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Themes" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TimeBrokerSvc" /v "Start" /t REG_DWORD /d "3" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\TrkWks" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\TsUsbFlt" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tunnel" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\tzautoupdate" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UASPStor" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmTcpciCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiAcpiClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UcmUcsiCx0101" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ucx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdeCx" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\udfs" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UdkUserSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UEFI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ufx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UfxChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ufxsynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\umbus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UmPass" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UnistoreSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\upnphost" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsChipidea" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsCx01000" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UrsSynopsys" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbaudio2" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbccgp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbehci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbhub" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBHUB3" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbohci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbprint" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\usbuhci" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\USBXHCI" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserDataSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\UserManager" /v "DependOnService" /t REG_MULTI_SZ /d "RpcSs\0ProfSvc" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VaultSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vdrvroot" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vds" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VerifierExt" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhdmp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vhf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgr" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volmgrx" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\volume" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\VSS" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifibus" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwififlt" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\vwifimp" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WSearch" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\W32Time" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WacomPen" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarp" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wanarpv6" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WarpJITSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcifs" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wcnfs" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wdf01000" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wdiwifi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WdmCompanionFilter" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wecsvc" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WEPHOSTSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFDSConMgrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WFPLWFS" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WiaRpc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WIMMount" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRT" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WindowsTrustedRTProxy" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Winmgmt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WinNat" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WINUSB" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WManSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WmiAcpi" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\wmiApSrv" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WMPNetworkSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Wof" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpdUpFltr" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\ws2ifsl" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WudfPf" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WUDFRd" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xboxgip" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\XboxGipSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\xinputhid" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBIOS" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\NetBT" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\storqosflt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\spaceport" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CimFS" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CldFlt" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CSC" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CscService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dam" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\dcsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\EhStorTcgDrv" /v "Start" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\embeddedmode" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\fhsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MapsBroker" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Ndu" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\PhoneSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Telemetry" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Vid" /v "Start" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Windows" /v "NoInteractiveServices" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\DiagLog" /v "Start" /t REG_DWORD /d "1" /f >nul 2>&1
sc config DPS start=auto >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\EventLog" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\EventSystem" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\SENS" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\CLFS" /v "Start" /t REG_DWORD /d "0" /f
devcon enable =Bluetooth >nul 2>&1
sc config BthA2dp start=demand >nul 2>&1
sc config BthEnum start=demand >nul 2>&1
sc config BthHFEnum start=demand >nul 2>&1
sc config BthLEEnum start=demand >nul 2>&1
sc config BthMini start=demand >nul 2>&1
sc config BTHMODEM start=demand >nul 2>&1
sc config BthPan start=demand >nul 2>&1
sc config BTHPORT start=demand >nul 2>&1
sc config BTHUSB start=demand >nul 2>&1
sc config HidBth start=demand >nul 2>&1
sc config Microsoft_Bluetooth_AvrcpTransport start=demand >nul 2>&1
sc config RFCOMM start=demand >nul 2>&1
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BluetoothUserService" /v "Start" /t REG_DWORD /d "3" /f >nul 2>&1
sc config BluetoothUserService start=demand >nul 2>&1
sc config BTAGService start=demand >nul 2>&1
sc config BthAvctpSvc start=demand >nul 2>&1
sc config bthserv start=demand >nul 2>&1
sc config Modem start=demand >nul 2>&1
timeout /t 2 /nobreak >nul 2>&1
devcon enable BTH* >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\cbdhsvc" /v "Start" /t REG_DWORD /d "3" /f
sc config rdbss start=system >nul 2>&1
sc config KSecPkg start=boot >nul 2>&1
sc config LanmanWorkstation start=auto >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters" /v "AutoShareWks" /t REG_DWORD /d "1" /f >nul 2>&1
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnService" /v "Start" /t REG_DWORD /d "2" /f >nul 2>&1
reg add "HKLM\SYSTEM\CurrentControlSet\Services\WpnUserService" /v "Start" /t REG_DWORD /d "2" /f >nul 2>&1
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\PushNotifications" /v "ToastEnabled" /t REG_DWORD /d "1" /f >nul 2>&1
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Notifications\Settings" /v "NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND" /f >nul 2>&1
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications" /v "NoCloudApplicationNotification" /f >nul 2>&1
reg delete "HKCU\Software\Policies\Microsoft\Windows\Explorer" /v "DisableNotificationCenter" /f >nul 2>&1
devcon enable "=Printer" >nul 2>&1
devcon enable "=PrintQueue" >nul 2>&1
sc config Spooler start=auto >nul 2>&1
sc start Spooler >nul 2>&1
dism /online /Enable-Feature /FeatureName:Printing-Foundation-Features >nul 2>&1
dism /online /Enable-Feature /FeatureName:Printing-Foundation-InternetPrinting-Client >nul 2>&1
reg add "HKLM\System\CurrentControlSet\Services\rdpbus" /v "Start" /t REG_DWORD /d "3" /f
devmanview /enable "Remote Dekstop Device Redirector Bus"
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableLUA" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\luafv" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\Appinfo" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\IKEEXT" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\PolicyAgent" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\SstpSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\RasMan" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\wlansvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\Wcmsvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\WpnUserService" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\XblAuthManager" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\XblGameSave" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\XboxNetApiSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcSvc" /v "ErrorControl" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\NgcCtnrSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\InstallService" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\wlidsvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\TokenBroker" /v "Start" /t REG_DWORD /d "3" /f
sc config TroubleshootingSvc start= disabled
reg add "HKLM\System\CurrentControlSet\Services\LicenseManager" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\ClipSVC" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\CDPUserSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\DoSvc" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "ErrorControl" /t REG_DWORD /d "1" /f
reg add "HKLM\System\CurrentControlSet\Services\WaaSMedicSvc" /v "Start" /t REG_DWORD /d "3" /f
reg add "HKLM\System\CurrentControlSet\Services\GameInput Service" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServices" /v "Start" /t REG_DWORD /d "2" /f
reg add "HKLM\System\CurrentControlSet\Services\GamingServicesNet" /v "Start" /t REG_DWORD /d "2" /f
echo.
echo All Services, Drivers has been Enabled Press enter to go to Drivers Services.
Pause > Nul
goto DisbleServc

:TweaksIntel
cls
echo.
echo.
echo  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
echo  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â€ƒâ€ƒâ–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo  â•šâ•â•â•šâ•â•â–‘â–‘â•šâ•â•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â€ƒâ€ƒâ•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â–‘
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo          [1] Tweaks control panel intel
echo          [2] Add more VRAM (ONLY FOR IGPU USERS, may not work)
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto TweaksControlIntel
if /i %input% == 2 goto TweaksVRAM
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto TweaksIntel

:TweaksControlIntel
cls
reg add "HKCU\Software\Intel\Display\igfxcui\HotKeys" /v "Enable" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\igfxtray" /v "ShowGraphicsBalloon" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\igfxtray" /v "ShowOptimalBalloon" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\igfxtray\TrayIcon" /v "ShowTrayIcon" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "EnableACE" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "EnableFMD" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "EnableNLAS" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "EnableSTE" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "EnableTCC" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "GCompMode" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\Media" /v "GExpMode" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\virtualKeyboard" /v "ShowVirtualKeyBoard" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Intel\Display\igfxcui\3D" /v "Default" /t REG_BINARY /d "0000000000000000000000000000000000000000000000000100000000000000" /f
reg add "HKLM\SOFTWARE\INTEL\Display\igfxcui\MISC" /v "MiracastFeatureEnabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000" /v "XVYCCFeatureEnable" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Class\{4D36E968-E325-11CE-BFC1-08002BE10318}\0000" /v "Disable_OverlayDSQualityEnhancement" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\igfxCUIService2.0.0.0" /v "DependOnService" /t REG_MULTI_SZ /d "" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\igfxCUIService2.0.0.0" /v "Start" /t REG_DWORD /d "4" /f
echo.
echo Intel Control Panel Tweaked. Press enter to go to Back.
Pause > Nul
goto TweaksIntel

:TweaksVRAM
cls
reg add "HKLM\SOFTWARE\Intel\GMM" /v "DedicatedSegmentSize" /t REG_DWORD /d "1298" /f
echo.
echo Extended VRAM FROM 128MB TO 512MB. Press enter to go to Back.
Pause > Nul
goto TweaksIntel

:AutoGpuAffinity
cls
echo.
echo.
echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•
echo  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ•”â•
echo  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘
echo  â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•    â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•   â•šâ•â•      â•šâ•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo    [1] AutoGpuAffinity Use
echo.
echo     Type [ X ] Back To Page
echo     Type [E] To Back From The Other Menu
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
set /p input=:
if /i %input% == 1 goto AutoGpuAffinity14
if /i %input% == X cls & goto TweaksWindowsInterface
if /i %input% == E cls & goto InterfaceUpdate

:AutoGpuAffinity14
cls
echo.
echo    Opening Interrupt Affinity Policy Tool...
echo.
start "" "C:\Windows\BerserkerUsefulTools\AutoGpuAffinity\AutoGpuAffinity.exe"
echo.
echo    Interrupt Affinity Policy Tool has been successfully opened, Press enter to go to Back
echo.
pause
GOTO AutoGpuAffinity

:TaskbarCustom
cls
echo.
echo.
echo  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â€ƒâ€ƒâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â€ƒâ€ƒâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘
echo  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘
echo  â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•‘â–‘â•šâ•â•â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
echo  â•šâ•â•â•â•â•â•â–‘â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â€ƒâ€ƒâ•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•â–‘â•šâ•â•â•â•â•â•â–‘
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    1 - ^< OpenShell  ^>
echo    2 - Disable Or Enable Stock Start Menu, Search
echo.
echo     Type [ X ] Back To Page
echo     Type [E] To Back From The Other Menu
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
set /p input=:
if /i %input% == 1 goto OpenShell
if /i %input% == 2 goto Startstock
if /i %input% == X cls & goto TweaksWindowsInterface
if /i %input% == E cls & goto InterfaceUpdate

:OpenShell
cls
echo.
echo    Downloading and Opening OpenShell...
echo.
powershell -C "Invoke-WebRequest -Uri 'https://github.com/Open-Shell/Open-Shell-Menu/releases/download/v4.4.191/OpenShellSetup_4_4_191.exe' -OutFile '%temp%\OpenShellSetup_4_4_191.exe'"
timeout /t 2 >nul
start "" "%temp%\OpenShellSetup_4_4_191.exe" /qn ADDLOCAL=StartMenu
echo.
cls
taskkill /f /im explorer.exe
Reg add "HKCR\Directory\Background\ShellNew" /v "NullFile" /t REG_SZ /d "" /f
reg delete HKCR\.bmp\ShellNew /f
reg delete HKCR\.rtf\ShellNew /f
reg delete HKCR\.trc\ShellNew /f
reg delete HKCR\Briefcase\ShellNew /f
reg delete HKCR\.contact\ShellNew /f
reg delete "HKCR\Directory\Background\shellex\ContextMenuHandlers\Sharing" /f
reg delete "HKCR\Directory\shellex\ContextMenuHandlers\Sharing" /f
reg delete "HKCR\Drive\shellex\ContextMenuHandlers\Sharing" /f
reg delete "HKCR\LibraryFolder\background\shellex\ContextMenuHandlers\Sharing" /f
reg delete "HKCR\UserLibraryFolder\shellex\ContextMenuHandlers\Sharing" /f
reg delete HKLM\SOFTWARE\Classes\InternetShortcut\shell\print /f
reg delete HKCR\AcroExch.Document.7\shell\print /f
reg delete HKCR\FoxitReader.Document\shell\print /f
reg delete HKCR\SystemFileAssociations\image\shell\print /f
reg delete HKCR\SystemFileAssociations\text\shell\print /f
reg delete HKCR\batfile\shell\print /f
reg delete HKCR\cmdfile\shell\print /f
reg delete HKCR\docfile\shell\print /f
reg delete HKCR\fonfile\shell\print /f
reg delete HKCR\htmlfile\shell\print /f
reg delete HKCR\inffile\shell\print /f
reg delete HKCR\inifile\shell\print /f
reg delete HKCR\JSEFile\shell\print /f
reg delete HKCR\JSFile\shell\print /f
reg delete HKCR\MSInfo.Document\shell\print /f
reg delete HKCR\otffile\shell\print /f
reg delete HKCR\pfmfile\shell\print /f
reg delete HKCR\regfile\shell\print /f
reg delete HKCR\rtffile\shell\print /f
reg delete HKCR\ttcfile\shell\print /f
reg delete HKCR\txtfile\shell\print /f
reg delete HKCR\VBEfile\shell\print /f
reg delete HKCR\VBSfile\shell\print /f
reg delete HKCR\Wordpad.Document.1\shell\print /f
reg delete HKCR\WPEDoc\shell\print /f
reg delete HKCR\WPSDoc\shell\print /f
reg delete HKCR\wrifile\shell\print /f
reg delete HKCR\WSFFile\shell\print /f
reg delete HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\Copy To} /f
reg delete HKCR\AllFilesystemObjects\shellex\ContextMenuHandlers\Move To /f
reg add "HKCR\Directory\Background\shell\Open CMD" /f /v "HasLUAShield" /t REG_SZ /d ""
reg add "HKCR\Directory\Background\shell\Open CMD" /f /v "Icon" /t REG_SZ /d "C:\\Windows\\System32\\cmd.exe"
reg add "HKCR\Directory\Background\shell\Open CMD\command" /f /ve /d "C:\\Windows\\system32\\cmd.exe /s /k pushd %V"
reg add "HKLM\software\microsoft\windows\CurrentVersion\explorer\advanced\folder\hidefileext" /f /v "DefaultValue" /t REG_DWORD /d 0
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /f /v "HideFileExt" /t REG_DWORD /d 0
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{031E4825-7B94-4dc3-B131-E946B44C8DD5} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{2112AB0A-C86A-4ffe-A368-0DE96E47012E} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{491E922F-5643-4af4-A7EB-4E7A138D8174} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{7b0db17d-9cd2-4a93-9733-46cc89022e7c} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{A302545D-DEFF-464b-ABE8-61C8648D939B} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{A990AE9F-A03B-4e80-94BC-9912D7504104} /f
reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel /f /v {031E4825-7B94-4dc3-B131-E946B44C8DD5}
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "HideSCAMeetNow" /t REG_DWORD /d 1 /f
Reg add "HKCR\.bat\ShellNew" /v "NullFile" /t REG_SZ /d "" /f
Reg add "HKCR\.reg\ShellNew" /v "ItemName" /t REG_EXPAND_SZ /d "@%%SystemRoot%%\system32\notepad.exe,-470" /f
Reg add "HKCR\.reg\ShellNew" /v "NullFile" /t REG_SZ /d "" /f
start explorer.exe
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu" /v "ShowedStyle2" /t REG_DWORD /d "1" /f
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu" /v "CSettingsDlg" /t REG_BINARY /d "A8000000420000000000000000000000360D00000100000000000000" /f
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu\Settings" /v "SkinW7" /t REG_SZ /d "Midnight" /f
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu\Settings" /v "SkinVariationW7" /t REG_SZ /d "" /f
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu\Settings" /v "SkinOptionsW7" /t REG_MULTI_SZ /d "USER_IMAGE=1\0SMALL_ICONS=0\0LARGE_FONT=0\0ICON_FRAMES=1\0OPAQUE=0" /f
REG ADD "HKEY_CURRENT_USER\SOFTWARE\OpenShell\StartMenu\Settings" /v "SkipMetro" /t REG_DWORD /d "1" /f
echo.
echo.
echo    OpenShell has been successfully downloaded and installed
echo.
pause
GOTO TaskbarCustom

:Startstock
cls
CHOICE /C YN /M "Disable Start Menu? (Y = Disable, N = Enable)"
IF %ERRORLEVEL% EQU 1 (
call "C:\Windows\NSudoLG.exe" -U:T -P:E cmd /c "cd C:\Windows\SystemApps\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy & takeown /f "StartMenuExperienceHost.exe" & icacls "C:\Windows\SystemApps\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\StartMenuExperienceHost.exe" /grant Administrators:F & ren StartMenuExperienceHost.exe StartMenuExperienceHost.old & cd C:\Windows\SystemApps\MicrosoftWindows.Client.CBS_cw5n1h2txyewy & takeown /f "SearchHost.exe" & icacls "C:\Windows\SystemApps\MicrosoftWindows.Client.CBS_cw5n1h2txyewy\SearchHost.exe" /grant Administrators:F & ren SearchHost.exe SearchHost.old & cd C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy & takeown /f "SearchApp.exe" & icacls "C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.exe" /grant Administrators:F & ren SearchApp.exe SearchApp.old & cd C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy & takeown /f "SearchUI.exe" & icacls "C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe" /grant Administrators:F & ren SearchUI.exe SearchUI.old"
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{1B562E86-B7AA-4131-BADC-B6F3A001407E}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{1B562E86-B7AA-4131-BADC-B6F3A001407E}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{199fe037-2b82-40a9-82ac-e1d46c792b99}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{199fe037-2b82-40a9-82ac-e1d46c792b99}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{b675ec37-bdb6-4648-bc92-f3fdc74d3ca2}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{b675ec37-bdb6-4648-bc92-f3fdc74d3ca2}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{fcbb06bb-6a2a-46e3-abaa-246cb4e508b2}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{fcbb06bb-6a2a-46e3-abaa-246cb4e508b2}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{ed8b9bd3-f66e-4ff2-b86b-75c7925f72a9}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{ed8b9bd3-f66e-4ff2-b86b-75c7925f72a9}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{bab3ad92-fb96-5902-450b-b8421bdec7bd}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{bab3ad92-fb96-5902-450b-b8421bdec7bd}" /v "EnableProperty" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{23b8d46b-67dd-40a3-b636-d43e50552c6d}" /v "Enabled" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{23b8d46b-67dd-40a3-b636-d43e50552c6d}" /v "EnableProperty" /t REG_DWORD /d "0" /f
) else (
call "C:\Windows\NSudoLG.exe" -U:T -P:E cmd /c "cd C:\Windows\SystemApps\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy & takeown /f "StartMenuExperienceHost.old" & icacls "C:\Windows\SystemApps\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\StartMenuExperienceHost.old" /grant Administrators:F & ren StartMenuExperienceHost.old StartMenuExperienceHost.exe & cd C:\Windows\SystemApps\MicrosoftWindows.Client.CBS_cw5n1h2txyewy & takeown /f "SearchHost.old" & icacls "C:\Windows\SystemApps\MicrosoftWindows.Client.CBS_cw5n1h2txyewy\SearchHost.old" /grant Administrators:F & ren SearchHost.old SearchHost.exe & cd C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy & takeown /f "SearchApp.old" & icacls "C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.old" /grant Administrators:F & ren SearchApp.old SearchApp.exe & cd C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy & takeown /f "SearchUI.old" & icacls "C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.old" /grant Administrators:F & ren SearchUI.old SearchUI.exe"
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{1B562E86-B7AA-4131-BADC-B6F3A001407E}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{1B562E86-B7AA-4131-BADC-B6F3A001407E}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{199fe037-2b82-40a9-82ac-e1d46c792b99}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{199fe037-2b82-40a9-82ac-e1d46c792b99}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{b675ec37-bdb6-4648-bc92-f3fdc74d3ca2}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{b675ec37-bdb6-4648-bc92-f3fdc74d3ca2}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{fcbb06bb-6a2a-46e3-abaa-246cb4e508b2}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-System\{fcbb06bb-6a2a-46e3-abaa-246cb4e508b2}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{ed8b9bd3-f66e-4ff2-b86b-75c7925f72a9}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{ed8b9bd3-f66e-4ff2-b86b-75c7925f72a9}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{bab3ad92-fb96-5902-450b-b8421bdec7bd}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{bab3ad92-fb96-5902-450b-b8421bdec7bd}" /v "EnableProperty" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{23b8d46b-67dd-40a3-b636-d43e50552c6d}" /v "Enabled" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\EventLog-Application\{23b8d46b-67dd-40a3-b636-d43e50552c6d}" /v "EnableProperty" /t REG_DWORD /d "1" /f
)
echo.
echo Start Menu stock has been disabled. Press enter to go to Back.
echo.
pause
GOTO TaskbarCustom

:FSO
cls
Echo.
echo.
Echo    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
Echo    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â€ƒâ€ƒâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘
Echo    â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•—â€ƒâ€ƒâ–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–‘â–‘
Echo    â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ•‘â€ƒâ€ƒâ–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo    â•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•â•â•â•â•â–‘â–‘â•šâ•â•â•â•â•â–‘â–‘â•šâ•â€ƒâ€ƒâ•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo          [1] Enable FSO and Disable FSE
echo          [2] Enable FSE and Disable FSO (recommanded but test)
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto FsoOptimal1
if /i %input% == 2 goto FseOptimal2
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto FSO

:FsoOptimal1
cls
reg delete "HKCU\Software\Microsoft\GameBar" /v "AllowAutoGameMode" /f
reg delete "HKCU\Software\Microsoft\GameBar" /v "AutoGameModeEnabled" /f
reg delete "HKCU\Software\Microsoft\GameBar" /v "GamePanelStartupTipIndex" /f
reg delete "HKCU\Software\Microsoft\GameBar" /v "ShowStartupPanel" /f
reg delete "HKCU\Software\Microsoft\GameBar" /v "UseNexusForGameBarEnabled" /f
reg add "HKCU\Software\Microsoft\GameBar" /f
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "AppCaptureEnabled" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /f
reg delete "HKCU\System\GameConfigStore" /v "GameDVR_DSEBehavior" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_DXGIHonorFSEWindowsCompatible" /t REG_DWORD /d "0" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_EFSEFeatureFlags" /t REG_DWORD /d "0" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d "0" /f
reg delete "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehavior" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehaviorMode" /t REG_DWORD /d "2" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_HonorUserFSEBehaviorMode" /t REG_DWORD /d "0" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v "AllowGameDVR" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /f
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameDVR" /v "value" /t REG_DWORD /d "1" /f
echo.
echo Enabled FSO and Disabled FSE Press enter to go to Back.
Pause > Nul
goto FSO

:FseOptimal2
cls
reg add "HKCU\Software\Microsoft\GameBar" /v "AllowAutoGameMode" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\GameBar" /v "AutoGameModeEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\GameBar" /v "GamePanelStartupTipIndex" /t REG_DWORD /d "3" /f
reg add "HKCU\Software\Microsoft\GameBar" /v "ShowStartupPanel" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\GameBar" /v "UseNexusForGameBarEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v "AppCaptureEnabled" /t REG_DWORD /d "0" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_DSEBehavior" /t REG_DWORD /d "2" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_DXGIHonorFSEWindowsCompatible" /t REG_DWORD /d "1" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_EFSEFeatureFlags" /t REG_DWORD /d "0" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d "0" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehavior" /t REG_DWORD /d "2" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehaviorMode" /t REG_DWORD /d "2" /f
reg add "HKCU\System\GameConfigStore" /v "GameDVR_HonorUserFSEBehaviorMode" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v "AllowGameDVR" /t REG_DWORD /d "0" /f
reg add "HKLM\SOFTWARE\Microsoft\PolicyManager\default\ApplicationManagement\AllowGameDVR" /v "value" /t REG_DWORD /d "0" /f
echo.
echo Enabled FSE and Disabled FSO Press enter to go to Back.
Pause > Nul
goto FSO

:Network
cls
CHOICE /C YN /M "Tweak Network?"
IF %ERRORLEVEL% EQU 2 (
	echo.
    echo You Decided Not to Apply Network Tweaks
    echo -- Press Any Key To Back Menu ---
	goto TweaksWindowsInterface 
IF %ERRORLEVEL% EQU 1 (
netsh int isatap set state disable 
netsh interface teredo set state servername=default 
netsh int ipv6 set teredo enterpriseclient 
netsh int ip set global sourceroutingbehavior=drop 
netsh int ip set global neighborcachelimit=4096 
netsh int tcp set heuristics disabled 
netsh int tcp set global autotuninglevel=normal
netsh int tcp set global nonsackrttresiliency=disabled 
netsh int tcp set global rss=enabled
netsh int tcp set security mpp=disabled >nul 
netsh int tcp set security profiles=disabled 
if %NUMBER_OF_CORES% GTR 4 (
    netsh int tcp set global rsc=disabled 
)
reg add "HKLM\SYSTEM\CurrentControlSet\services\NDIS\Parameters" /v "TrackNblOwner" /t REG_DWORD /d "0" /f
for /f %%a in ('reg query "HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e972-e325-11ce-bfc1-08002be10318}" /v "*SpeedDuplex" /s ^| findstr  "HKEY"') do (
    for /f %%i in ('reg query "%%a" /v "*MaxRssProcessors" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*MaxRssProcessors" /t REG_SZ /d "2" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*NumRssQueues" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*NumRssQueues" /t REG_SZ /d "2" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*ReceiveBuffers" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*ReceiveBuffers" /t REG_SZ /d "1024" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*TransmitBuffers" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*TransmitBuffers" /t REG_SZ /d "1024" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*AlternateSemaphoreDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*AlternateSemaphoreDelay" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*LsoV1IPv4" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*LsoV1IPv4" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*DeviceSleepOnDisconnect" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*DeviceSleepOnDisconnect" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*EEE" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*EEE" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*FlowControl" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*FlowControl" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*IPChecksumOffloadIPv4" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*IPChecksumOffloadIPv4" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*LsoV2IPv4" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*LsoV2IPv4" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*LsoV2IPv6" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*LsoV2IPv6" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*ModernStandbyWoLMagicPacket" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*ModernStandbyWoLMagicPacket" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*Node" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*Node" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*PMARPOffload" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*PMARPOffload" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*PMNSOffload" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*PMNSOffload" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*PriorityVLANTag" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*PriorityVLANTag" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*TCPChecksumOffloadIPv4" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*TCPChecksumOffloadIPv4" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*TCPChecksumOffloadIPv6" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*TCPChecksumOffloadIPv6" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*UDPChecksumOffloadIPv4" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*UDPChecksumOffloadIPv4" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*UDPChecksumOffloadIPv6" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*UDPChecksumOffloadIPv6" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*RssBaseProcNumber" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*RssBaseProcNumber" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*RxAbsIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*RxAbsIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*RxIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*RxIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*SelectiveSuspend" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*SelectiveSuspend" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*TxAbsIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*TxAbsIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*TxIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*TxIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*WakeOnMagicPacket" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*WakeOnMagicPacket" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "*WakeOnPattern" ^| findstr "HKEY"') do (
        reg add "%%i" /v "*WakeOnPattern" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "AdvancedEEE" ^| findstr "HKEY"') do (
        reg add "%%i" /v "AdvancedEEE" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "AutoDisableGigabit" ^| findstr "HKEY"') do (
        reg add "%%i" /v "AutoDisableGigabit" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "AutoPowerSaveModeEnabled" ^| findstr "HKEY"') do (
        reg add "%%i" /v "AutoPowerSaveModeEnabled" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "EEELinkAdvertisement" ^| findstr "HKEY"') do (
        reg add "%%i" /v "EEELinkAdvertisement" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "EeePhyEnable" ^| findstr "HKEY"') do (
        reg add "%%i" /v "EeePhyEnable" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "EnableGreenEthernet" ^| findstr "HKEY"') do (
        reg add "%%i" /v "EnableGreenEthernet" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "EnableModernStandby" ^| findstr "HKEY"') do (
        reg add "%%i" /v "EnableModernStandby" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "GigaLite" ^| findstr "HKEY"') do (
        reg add "%%i" /v "GigaLite" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "LogLevelWarn" ^| findstr "HKEY"') do (
        reg add "%%i" /v "LogLevelWarn" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "Node" ^| findstr "HKEY"') do (
        reg add "%%i" /v "Node" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "PnPCapabilities" ^| findstr "HKEY"') do (
        reg add "%%i" /v "PnPCapabilities" /t REG_DWORD /d "24" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "PowerDownPll" ^| findstr "HKEY"') do (
        reg add "%%i" /v "PowerDownPll" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "PowerSavingMode" ^| findstr "HKEY"') do (
        reg add "%%i" /v "PowerSavingMode" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "ReduceSpeedOnPowerDown" ^| findstr "HKEY"') do (
        reg add "%%i" /v "ReduceSpeedOnPowerDown" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "RxAbsIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "RxAbsIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "RxIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "RxIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "S5WakeOnLan" ^| findstr "HKEY"') do (
        reg add "%%i" /v "S5WakeOnLan" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "SavePowerNowEnabled" ^| findstr "HKEY"') do (
        reg add "%%i" /v "SavePowerNowEnabled" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "TxAbsIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "TxAbsIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "TxIntDelay" ^| findstr "HKEY"') do (
        reg add "%%i" /v "TxIntDelay" /t REG_SZ /d "1" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "ULPMode" ^| findstr "HKEY"') do (
        reg add "%%i" /v "ULPMode" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "WakeOnLink" ^| findstr "HKEY"') do (
        reg add "%%i" /v "WakeOnLink" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "WakeOnSlot" ^| findstr "HKEY"') do (
        reg add "%%i" /v "WakeOnSlot" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "WakeUpModeCap" ^| findstr "HKEY"') do (
        reg add "%%i" /v "WakeUpModeCap" /t REG_SZ /d "0" /f >nul 2>&1
    )
    for /f %%i in ('reg query "%%a" /v "WolShutdownLinkSpeed" ^| findstr "HKEY"') do (
        reg add "%%i" /v "WolShutdownLinkSpeed" /t REG_SZ /d "2" /f >nul 2>&1
    )
) >nul 2>&1
powerShell -Mta -NoProfile -C "disable-netadapterbinding -name "*" -componentid ms_lldp, ms_lltdio, ms_implat, ms_tcpip6, ms_rspndr, ms_server, ms_msclient"
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters" /v "EnableLMHOSTS" /t REG_DWORD /d "0" /f
for /f %%i in ('reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\Interfaces" /s /f NetbiosOptions ^| find /i "Interfaces\" ') do (
	echo %%i...
	reg add "%%i" /v "NetbiosOptions" /t REG_DWORD /d "2" /f
)
devmanview /disable "Microsoft Kernel Debug Network Adapter" >nul 2>&1
devmanview /disable "WAN Miniport (IKEv2)" >nul 2>&1
devmanview /disable "WAN Miniport (IP)" >nul 2>&1
devmanview /disable "WAN Miniport (IPv6)" >nul 2>&1
devmanview /disable "WAN Miniport (L2TP)" >nul 2>&1
devmanview /disable "WAN Miniport (Network Monitor)" >nul 2>&1
devmanview /disable "WAN Miniport (PPPOE)" >nul 2>&1
devmanview /disable "WAN Miniport (PPTP)" >nul 2>&1
devmanview /disable "WAN Miniport (SSTP)" >nul 2>&1
devmanview /disable "Microsoft ISATAP Adapter" >nul 2>&1
:: Disable Nagle's Algorithm
for /f %%i in ('wmic path win32_networkadapter get GUID^| findstr "{"') do (
            reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\%%i" /v "TcpAckFrequency" /t REG_DWORD /d "1" /f
            reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\%%i" /v "TcpDelAckTicks" /t REG_DWORD /d "0" /f
            reg add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\%%i" /v "TCPNoDelay" /t REG_DWORD /d "1" /f
        ) >nul 2>&1
)
reg add "HKLM\SYSTEM\ControlSet001\Services\Tcpip6\Parameters" /v "DisabledComponents" /t REG_DWORD /d "50" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v "NetworkThrottlingIndex" /t REG_DWORD /d "10" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v "SystemResponsiveness" /t REG_DWORD /d "10" /freg add "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Parameters" /v "UseDomainNameDevolution" /t REG_DWORD /d "0" /f
reg add "HKLM\SYSTEM\ControlSet001\Services\Tcpip\QoS" /v "Do not use NLA" /t REG_DWORD /d "1" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Tcpip\Parameters" /v "EnableICMPRedirect" /t REG_DWORD /d "0" /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Tcpip\Parameters" /v "IGMPLevel" /t REG_DWORD /d "0" /f
)
cls
echo.
echo Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:DebloatWindows
cls
echo.
echo.
echo  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
echo  â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•¦â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘
echo  â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘
echo  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•¦â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–‘
echo  â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â–‘â•šâ•â•â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo      [1] â€¢ Windows Store Apps      â”‚ â€¢ Delete Windows Store Apps Pre-installed by Microsoft
echo      [2] â€¢ OEM(Out-Of-the-Box)     â”‚ â€¢ Delete OEM Bloatware maded by (Dell, HP, Lenovo, etc.)
echo      [3] â€¢ System                  â”‚ â€¢ Delete Windows System Components %yellow%(ADVANCED USERS ONLY) [Beta]%reset%
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto DebloatManual
if /i %input% == 2 goto DebloatOEM
if /i %input% == 3 goto DebloatSystem
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatWindows

:CleanWindows
cls
echo.
echo.
echo  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
echo  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ–ˆâ•‘
echo  â–‘â•šâ•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â–‘â–‘â•šâ•â•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo.
echo      [1] Clean All Cache Windows, Temp
echo      [3] Usabillity [ Windows Sounds Disable ]
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=: 
if /i %input% == 1  goto CleanCache
if /i %input% == 3  goto Usabillity
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto CleanWindows

:CleanCache
cls
for /D %%x in ("%USERPROFILES%\*") do (
    del /F /Q "%%x\Documents\*.tmp" 2>NUL
    del /F /Q "%%x\My Documents\*.tmp" 2>NUL
    del /F /S /Q "%%x\*.blf" 2>NUL
    del /F /S /Q "%%x\*.regtrans-ms" 2>NUL
    del /F /S /Q "%%x\AppData\LocalLow\Sun\Java\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Internet Explorer\Recovery\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Terminal Server Client\Cache\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\Caches\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\Explorer\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\History\low\*" /AH 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\INetCache\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\Temporary Internet Files\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\WER\ReportArchive\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\WER\ReportQueue\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Microsoft\Windows\WebCache\*" 2>NUL
    del /F /S /Q "%%x\AppData\Local\Temp\*" 2>NUL
    del /F /S /Q "%%x\Application Data\Microsoft\Windows\WER\ReportArchive\*" 2>NUL
    del /F /S /Q "%%x\Application Data\Microsoft\Windows\WER\ReportQueue\*" 2>NUL
    del /F /S /Q "%%x\Application Data\Sun\Java\*" 2>NUL
    del /F /S /Q "%%x\Local Settings\Application Data\ApplicationHistory\*" 2>NUL
    del /F /S /Q "%%x\Local Settings\Application Data\Microsoft\Internet Explorer\Recovery\*" 2>NUL
    del /F /S /Q "%%x\Local Settings\Application Data\Microsoft\Terminal Server Client\Cache\*" 2>NUL
    del /F /S /Q "%%x\Local Settings\Temp\*" 2>NUL
    del /F /S /Q "%%x\Local Settings\Temporary Internet Files\*" 2>NUL
    del /F /S /Q "%%x\Recent\*" 2>NUL
)
del /F /S /Q "%WINDIR%\TEMP\*" 2>NUL
takeown /f "%ProgramData%\Microsoft\Diagnosis" /r /d y
takeown /f "%ProgramData%\Microsoft\Diagnosis\ETLLogs\AutoLogger\AutoLogger-Diagtrack-Listener.etl" /r /d y
icacls "%ProgramData%\Microsoft\Diagnosis\ETLLogs\AutoLogger\AutoLogger-Diagtrack-Listener.etl" /grant administrators:F /t
echo " > "%ProgramData%\Microsoft\Diagnosis\ETLLogs\AutoLogger\AutoLogger-Diagtrack-Listener.etl"
"%ProgramData%\Microsoft\Diagnosis\ETLLogs\AutoLogger\AutoLogger-Diagtrack-Listener.etl"
DEL "C:\ProgramData\Microsoft\Diagnosis\ETLLogs\AutoLogger\AutoLogger-Diagtrack-Listener.etl" /s
ATTRIB -r "C:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb"

ATTRIB +r "C:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb"

:: JOB: Remove the Office installation cache. Usually around ~1.5 GB
if exist %SystemDrive%\MSOCache rmdir /S /Q %SystemDrive%\MSOCache

:: JOB: Clear queued and archived Windows Error Reporting (WER) reports
echo. >> %LOGPATH%\%LOGFILE%
if exist "%ALLUSERSPROFILE%\Microsoft\Windows\WER" rmdir /s /q "%ALLUSERSPROFILE%\Microsoft\Windows\WER"
:: JOB: Clear Windows Defender Scan Results
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c if exist "%ALLUSERSPROFILE%\Microsoft\Windows Defender\Scans\History\Results\Quick" rmdir /s /q "%ALLUSERSPROFILE%\Microsoft\Windows Defender\Scans\History\Results\Quick"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c if exist "%ALLUSERSPROFILE%\Microsoft\Windows Defender\Scans\History\Results\Resource" rmdir /s /q "%ALLUSERSPROFILE%\Microsoft\Windows Defender\Scans\History\Results\Resource"
:: JOB: Clear Windows Search Temp Data
if exist "%ALLUSERSPROFILE%\Microsoft\Search\Data\Temp" rmdir /s /q "%ALLUSERSPROFILE%\Microsoft\Search\Data\Temp"
:: JOB: Windows update logs & built-in backgrounds (space waste)
del /F /Q %WINDIR%\*.log 2>NUL
del /F /Q %WINDIR%\*.txt 2>NUL
del /F /Q %WINDIR%\*.bmp 2>NUL
del /F /Q %WINDIR%\*.tmp 2>NUL
rmdir /S /Q %WINDIR%\Web\Wallpaper\Dell 2>NUL
:: JOB: Clear cached NVIDIA driver updates
if exist "%ProgramFiles%\NVIDIA Corporation\Installer" rmdir /s /q "%ProgramFiles%\NVIDIA Corporation\Installer" 2>NUL
if exist "%ProgramFiles%\NVIDIA Corporation\Installer2" rmdir /s /q "%ProgramFiles%\NVIDIA Corporation\Installer2" 2>NUL
if exist "%ProgramFiles(x86)%\NVIDIA Corporation\Installer" rmdir /s /q "%ProgramFiles(x86)%\NVIDIA Corporation\Installer" 2>NUL
if exist "%ProgramFiles(x86)%\NVIDIA Corporation\Installer2" rmdir /s /q "%ProgramFiles(x86)%\NVIDIA Corporation\Installer2" 2>NUL
if exist "%ProgramData%\NVIDIA Corporation\Downloader" rmdir /s /q "%ProgramData%\NVIDIA Corporation\Downloader" 2>NUL
if exist "%ProgramData%\NVIDIA\Downloader" rmdir /s /q "%ProgramData%\NVIDIA\Downloader" 2>NUL
del /F /Q %WINDIR%\logs\CBS\* 2>NUL
echo.
echo Windows cache has been cleaned Press enter to go to Back.
Pause > Nul
goto CleanWindows


:Usabillity
cls
cls
    echo.
    set /P "choice=Disable all system sounds? [Y/N] "
    if /I "%choice%"=="Y" (
        reg add "HKEY_CURRENT_USER\AppEvents\Schemes" /ve /t REG_SZ /d ".None" /f
    )
cls
echo.
echo System Sounds You Choice! Press Any Key To Back CleanWindows
pause >nul
goto CleanWindows

:DebloatSystem
cls
echo                               [SYSTEM]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•%blue%
echo [1] Windows Defender [260.00MB] %green%
echo [2] MultiPoint Connector [1.03MB]
echo [3] Webcam Experience [1.80MB]
echo [4] TFTP Client [0.04MB]
echo [5] Telnet Client [0.10MB]
echo [6] PowerShell V2 [0.07MB]
echo [7] Print To PDF [0.12MB]
echo [8] XPS Document Writer [1.50MB]%blue%
echo [9] DeviceGuard   depends on: hyper-v [0.60MB]%green%
echo [10] Offline Files [3.00MB]
echo [11] Services For NFS [1.11MB]
echo [12] Microsoft Message Queue (MSMQ) [3.21MB]
echo [13] Secure Assessment (in systemapps) [5.51MB]
echo [14] Internet Information Server (IIS) Depends on: MSMQ [14.30MB]
echo [15] Embedded Experience (Device Lockdown) [1.31MB]%blue%
echo [16] Data Center Bridging [0.17MB]%green%
echo [17] Assigned Accesss Lock App (in systemapps)%blue%
echo [18] HyperV [48.73MB]%green%
echo [19] Tablet PC Math
echo [20] Windows Error Reporting (Windows 11) [3.50MB]%blue%
echo [21] Spelling [100.00MB]%green%
echo [22] DesktopFileExplorer (hidden in systemapps, not needed also unused)%blue%
echo [23] ProjFS [0.08MB]%reset%
echo                   [Page 1 of 4] [D = right] [24] Remove all here
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto DefenderRemove
if /i %input% == 2 goto MultiPointRemove
if /i %input% == 3 goto WebcamExperienceRemove
if /i %input% == 4 goto TFTPRemove
if /i %input% == 5 goto TelnetRemove
if /i %input% == 6 goto PowerShellV2Remove
if /i %input% == 7 goto PrintToPDFRemove
if /i %input% == 8 goto XPSDocumentWriterRemove
if /i %input% == 9 goto DeviceGuardRemove
if /i %input% == 10 goto OfflineFilesRemove
if /i %input% == 11 goto ServicesForNFSRemove
if /i %input% == 12 goto MSMQRemove
if /i %input% == 13 goto SecureAssessmentRemove
if /i %input% == 14 goto IISRemove
if /i %input% == 15 goto EmbeddedRemove
if /i %input% == 16 goto DataCenterBridgingRemove
if /i %input% == 17 goto AssignedAccessRemove
if /i %input% == 18 goto HyperVRemove
if /i %input% == 19 goto TabletPCMathRemove
if /i %input% == 20 goto WReportRemove
if /i %input% == 21 goto SpellingRemove
if /i %input% == 22 goto DesktopFileExplorerRemove
if /i %input% == 23 goto ProjFSRemove
if /i %input% == 24 goto RemoveAll1
if /i %input% == D goto DebloatSystem2
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatSystem

:DebloatSystem2
cls
echo                               [SYSTEM]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•%blue%
echo [1] Remote Differential Compression (RDC) [0.36MB]%green%
echo [2] ScreenSavers [2.44MB]
echo [3] ShellWallpaper(default wallpapers) [17.05MB]
echo [4] TextPrediction depends on: Spelling [12.60MB]
echo [5] ContentExtendedWallpaper(windows 11)
echo [6] WinSAT Tools [6.90MB]%blue%
echo [7] Old Windows Photo Viewer [40.00MB]%green%
echo [8] BranchCache [9.46MB]
echo [9] BioEnrollment (in systemapps) [4.40MB]
echo [10] PPIProjection (in systemapps, 1909)%blue%
echo [11] PenService
echo [12] Containers    (Depends on:Storage Qos) [3.50MB]
echo [13] Storage QoS [0.17MB]%green%
echo [14] Remote Assistance [1.44MB]
echo [15] Simple TCP/IP Services [0.04MB]%blue%
echo [16] Smb v1 [0.50MB]
echo [17] Smb Direct [0.80MB]
echo [18] Windows TIFF IFilter [2.10MB]%green%
echo [19] WMP Network Sharing Service [2.60MB]%yellow%
echo [20] Dolby atmos codec pack [2.00MB]
echo [21] Windows Firewall UI (may not work) [20.00MB]%green%
echo [22] Rights Management support [5.84MB]%blue%
echo [23] Guarded Host    depends on: hyper-v [0.33MB]%reset%
echo        [A = left] [Page 2 of 4] [D = right] [24] Remove all here
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto RDCRemove
if /i %input% == 2 goto ScreenSaversRemove
if /i %input% == 3 goto ShellWallpaperRemove
if /i %input% == 4 goto TextPredictionRemove
if /i %input% == 5 goto ContentExtendedRemove
if /i %input% == 6 goto WinSATRemove
if /i %input% == 7 goto PhotoBasicRemove
if /i %input% == 8 goto PeerDistRemove
if /i %input% == 9 goto BioEnrollmentRemove
if /i %input% == 10 goto PPIProjectionRemove
if /i %input% == 11 goto PenServ
if /i %input% == 12 goto ContainersRemove
if /i %input% == 13 goto StorageQoSRemove
if /i %input% == 14 goto RemoteAssistanceRemove
if /i %input% == 15 goto SimpleTCPRemove
if /i %input% == 16 goto Smbv1Remove
if /i %input% == 17 goto SmbDirectRemove
if /i %input% == 18 goto OCRRemove
if /i %input% == 19 goto WMPNetworkSharingServiceRemove
if /i %input% == 20 goto DolbyRemove
if /i %input% == 21 goto FirewallUIRemove
if /i %input% == 22 goto HelpPackageRemove
if /i %input% == 23 goto HgsClientRemove
if /i %input% == 24 goto RemoveAll2
if /i %input% == A goto DebloatSystem
if /i %input% == D goto DebloatSystem3
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatSystem

:DebloatSystem3
cls
echo                               [SYSTEM]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•%blue%
echo [1] Virtualization-based security (VBS)   depends on: hyper-v [10.10MB]%green%
echo [2] Windows Fax and Scan [36.20MB]%blue%
echo [3] RemoteFX depends on: Containers [8.60MB]%reset%
echo [4] enterpriseclient dont know what is that for%green%
echo [5] File Server Resource Manager [5.27MB]
echo [6] Windows Help Content [2.00MB]%blue%
echo [7] Diagnostics and troubleshooting [15.67MB]
echo [8] BitLocker Drive Encryption [6.50MB]%reset%
echo [9] SQL-Lite dont know what is that for%green%
echo [10] Customer Experience Improvement Program (CEIPEnable) (Windows 11) [1.13MB]%blue%
echo [11] Kernel LA57 57-bit Linear Addressing (Windows 11) [37.60MB]
echo [12] Powershell ISE [4.30MB]
echo [13] Sync Host [10.00MB]%green%
echo [14] Device Update Center [2.00MB]%blue%
echo [15] Microsoft Cloud Identity Service [0.60MB]%green%
echo [16] Embedded Mode [0.16MB]%blue%
echo [17] User Experience Virtualization (UEV) [17.00MB]%yellow%
echo [18] Active Directory Lightweight Services [5.60MB]%blue%
echo [19] WindowsMixedReality [80.00MB]%green%
echo [20] StepsRecorder [1.80MB]
echo [21] Support.QuickAssist (not exist on windows 11)
echo [22] Hello.Face%reset%
echo        [A = left] [Page 3 of 4] [D = right] [23] Remove all here
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto VBSRemove
if /i %input% == 2 goto FaxRemove
if /i %input% == 3 goto RemoteFXRemove
if /i %input% == 4 goto enterpriseclientRemove
if /i %input% == 5 goto FCIRemove
if /i %input% == 6 goto WindowsHelpContentRemove
if /i %input% == 7 goto DiagAndTRemove
if /i %input% == 8 goto SecureStartupRemove
if /i %input% == 9 goto SQL-LiteRemove
if /i %input% == 10 goto CeipRemove
if /i %input% == 11 goto KernelLA57Remove
if /i %input% == 12 goto PowershellISERemove
if /i %input% == 13 goto OneSyncRemove
if /i %input% == 14 goto DeviceUpdateCenterRemove
if /i %input% == 15 goto CloudIdentityRemove
if /i %input% == 16 goto IoTRemove
if /i %input% == 17 goto UEVRemove
if /i %input% == 18 goto DirectoryServicesRemove
if /i %input% == 19 goto MixedRealityRemove
if /i %input% == 20 goto StepsR
if /i %input% == 21 goto SupportQuick
if /i %input% == 22 goto HelloFacee
if /i %input% == 23 goto RemoveAll3
if /i %input% == A goto DebloatSystem2
if /i %input% == D goto DebloatSystem4
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatSystem

:DebloatSystem4
cls
echo                               [SYSTEM]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•%green%
echo [1] MathRecognizer
echo [2] WordPad [8.81MB]
echo [3] XPS.Viewer
echo [4] OpenSSH [5.70MB]%yellow%
echo [5] Windows Recovery [500.00MB]
echo [6] Microsoft Client License Flexible Platform [1.80MB]
echo [7] User Choice Protection(windows 11)
echo [8] FlipGridPWA[not exist app?](windows 11)%reset%
echo        [A = left] [Page 4 of 4]             [9] Remove all here
Echo            Type [X] To Back First Page
echo            Type [E] To Back From The Other Menu
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto MathRecognizerr
if /i %input% == 2 goto WordPadd
if /i %input% == 3 goto XPSViewerr
if /i %input% == 4 goto OpenSHHH
if /i %input% == 5 goto WRecoveryRemove
if /i %input% == 6 goto FlexibleRemove
if /i %input% == 7 goto UserProtectionRemove
if /i %input% == 8 goto FlipGridRemove
if /i %input% == 9 goto RemoveAll4
if /i %input% == A goto DebloatSystem3
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatSystem


:DefenderRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCoreUAP-AppRuntime-RemoteAppLifetimeManager-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCoreUAP-AppRuntime-RemoteAppLifetimeManager-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Components-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Components-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AM-Default-Definitions-OptionalWrapper-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AM-Default-Definitions-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Group-Policy-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Group-Policy-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AppLayer-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AppLayer-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Client-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Client-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-MDM-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-MDM-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Powershell-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Powershell-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Nis-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Windows-Defender-ApplicationGuard" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.SecHealthUI | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SecHealthUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Windows\SystemApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SecHealthUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.6365217CE6EB4 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.6365217CE6EB4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiVirus" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Sense" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmBroker" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService" /v "Start" /t REG_DWORD /d "4" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "SecurityHealth" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "SecurityHealth" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "EnableSmartScreen" /t REG_DWORD /d "0" /f
schtasks /delete /TN "Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh" /f
schtasks /delete /TN "Microsoft\Windows\ExploitGuard" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Cleanup" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Verification" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"windowsdefender;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!windowsdefender;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Windows Defender removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:DeviceGuardRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-onecore-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
echo DeviceGuard removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:MultiPointRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Connector-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Connector-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Help-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Help-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Tools-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Tools-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
echo MultiPoint removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:WebcamExperienceRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Windows-WebcamExperience" /f
echo Webcam Experience removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:TFTPRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TFTP-Client" ^| findstr "~~"') do (set "TFTP_Client=%%i")
if defined TFTP_Client (
		echo Removing %TFTP_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TFTP_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%" /f
	) else (
		echo TFTP Client not found, skipping.
	)
echo TFTP Client removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:TelnetRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Opt-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Opt-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
echo Telnet Client removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:PowerShellV2Remove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\MicrosoftWindowsPowerShellV2" /f
echo PowerShell V2 removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:PrintToPDFRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-PrintToPDF" ^| findstr "~~"') do (set "PrintToPDF=%%i")
if defined PrintToPDF (
		echo Removing %PrintToPDF%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PrintToPDF% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /f
	) else (
		echo Print To PDF Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-PrintToPDF" ^| findstr "~~"') do (set "PrintToPDF=%%i")
if defined PrintToPDF (
		echo Removing %PrintToPDF%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PrintToPDF% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /f
	) else (
		echo Print To PDF Client not found, skipping.
	)
echo Print To PDF removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:XPSDocumentWriterRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-X" ^| findstr "~~"') do (set "XPSDocumentWriter=%%i")
if defined XPSDocumentWriter (
		echo Removing %XPSDocumentWriter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%XPSDocumentWriter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /f
	) else (
		echo XPS Document Writer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-X" ^| findstr "~~"') do (set "XPSDocumentWriter=%%i")
if defined XPSDocumentWriter (
		echo Removing %XPSDocumentWriter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%XPSDocumentWriter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /f
	) else (
		echo XPS Document Writer not found, skipping.
	)
echo XPS Document Writer removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:OfflineFilesRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-merged-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-merged-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-UI-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-UI-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
echo Offline Files removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:ServicesForNFSRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientCore-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientLocalUI-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientLocalUI-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ClientForNFS-Infrastructure-OptGroup-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ClientForNFS-Infrastructure-OptGroup-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
echo Services For NFS removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:MSMQRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-adintegration-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-adintegration-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-multicast-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-multicast-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-server-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-server-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MSMQ-Driver-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MSMQ-Driver-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
echo MSMQ removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:SecureAssessmentRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.SecureAssessmentBrowser_cw5n1h2txyewy" /q /s
echo Secure Assessment removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:IISRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
echo IIS removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:EmbeddedRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-IoTUAP-ShellExt-Tools-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-IoTUAP-ShellExt-Tools-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-AssignedAccessCsp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-BootExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-BootExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-CustomShellHost-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-CustomShellHost-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-DeviceLockdown" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-KeyboardFilter" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-UnifiedWriteFilter" /f
echo Embedded removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:DataCenterBridgingRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\DataCenterBridging" /f
echo DataCenterBridging removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:AssignedAccessRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-AssignedAccessCsp-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.AssignedAccessLockApp_cw5n1h2txyewy" /q /s
echo Assigned Access removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:HyperVRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-onecore-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-ds-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-onecore-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-servercommon-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Shielded-VM-Service-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-merged-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Chipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Chipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-AzureVirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-AzureVirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "\HyperV-Compute-System-AzureVirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "\HyperV-Compute-System-AzureVirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-DynamicMemory-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-DynamicMemory-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-ApplicationGuard-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-ApplicationGuard-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KMCL-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KMCL-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-Interop-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-Interop-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HvSocket-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HvSocket-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Core-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Core-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Server-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Server-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-mergedcomponents-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-mergedcomponents-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KMCL-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KMCL-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Primitive-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Primitive-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VID-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VID-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Virtio-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Virtio-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmSerial-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmSerial-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmTpm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmTpm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmUiDevices-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmUiDevices-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-servercommon-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-servercommon-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-ComputeStorage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-IsolatedVM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-IsolatedVM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Hypervisor" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Management-PowerShell" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Services" /f
echo HyperV Setup removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:TabletPCMathRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-tabletpcmath-package-Wrapper" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Base" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Base" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Package" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Package" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
echo Tablet PC Math removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:WReportRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
echo Windows Error Reporting removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:SpellingRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TextPrediction" ^| findstr "~~"') do (set "TextPrediction=%%i")
if defined TextPrediction (
		echo Removing %TextPrediction%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TextPrediction% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /f
	) else (
		echo TextPrediction not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Spelling" ^| findstr "~~"') do (set "SpelingD=%%i")
if defined SpelingD (
		echo Removing %SpelingD%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SpelingD% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%" /f
	) else (
		echo Spelling not found, skipping.
	)
echo Spelling removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:DesktopFileExplorerRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.FileExplorer_cw5n1h2txyewy" /q /s
echo Desktop File Explorer removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:ProjFSRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS-OptionalFeature-Package" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS-Package" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
echo ProjFS removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:RemoveAll1
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCoreUAP-AppRuntime-RemoteAppLifetimeManager-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCoreUAP-AppRuntime-RemoteAppLifetimeManager-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Components-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Components-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HVSI-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SenseClient-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AM-Default-Definitions-OptionalWrapper-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AM-Default-Definitions-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-ApplicationGuard-Inbox-WOW64-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Group-Policy-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Group-Policy-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AppLayer-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-AppLayer-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Client-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Client-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Core-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-amcore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-onecore-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-MDM-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-MDM-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Powershell-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Management-Powershell-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Windows-Defender-Nis-Group-Package" ^| findstr "~~"') do (set "Windows_Defender=%%i")
if defined Windows_Defender (
		echo Removing %Windows_Defender%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Windows_Defender% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Windows_Defender%" /f
	) else (
		echo Windows Defender not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Windows-Defender-ApplicationGuard" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.SecHealthUI | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SecHealthUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Windows\SystemApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SecHealthUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.6365217CE6EB4 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.6365217CE6EB4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SOFTWARE\Microsoft\Windows Defender" /v "DisableAntiVirus" /t REG_DWORD /d "1" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\Sense" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmAgent" /v "Start" /t REG_DWORD /d "4" /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\SgrmBroker" /v "Start" /t REG_DWORD /d "4" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c reg add "HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService" /v "Start" /t REG_DWORD /d "4" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "SecurityHealth" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\StartupApproved\Run" /v "SecurityHealth" /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "EnableSmartScreen" /t REG_DWORD /d "0" /f
schtasks /delete /TN "Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh" /f
schtasks /delete /TN "Microsoft\Windows\ExploitGuard" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Cleanup" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender\Windows Defender Verification" /f
schtasks /delete /TN "Microsoft\Windows\Windows Defender" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"windowsdefender;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!windowsdefender;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Windows Defender removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-onecore-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
echo DeviceGuard removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MultiPoint-Connector-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Connector-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Connector-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Help-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Help-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Tools-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MultiPoint-Tools-Opt-Package" ^| findstr "~~"') do (set "Multi_Point=%%i")
if defined Multi_Point (
		echo Removing %Multi_Point%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Multi_Point% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Multi_Point%" /f
	) else (
		echo MultiPoint not found, skipping.
	)
echo MultiPoint removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WebcamExperience-WOW64-Package" ^| findstr "~~"') do (set "Webcam_Experience=%%i")
if defined Webcam_Experience (
		echo Removing %Webcam_Experience%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Webcam_Experience% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Webcam_Experience%" /f
	) else (
		echo Webcam Experience not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Windows-WebcamExperience" /f
echo Webcam Experience removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TFTP-Client" ^| findstr "~~"') do (set "TFTP_Client=%%i")
if defined TFTP_Client (
		echo Removing %TFTP_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TFTP_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TFTP_Client%" /f
	) else (
		echo TFTP Client not found, skipping.
	)
echo TFTP Client removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Opt-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Opt-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Telnet-Client-Package" ^| findstr "~~"') do (set "Telnet_Client=%%i")
if defined Telnet_Client (
		echo Removing %Telnet_Client%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Telnet_Client% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Telnet_Client%" /f
	) else (
		echo Telnet Client not found, skipping.
	)
echo Telnet Client removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-V2" ^| findstr "~~"') do (set "PowerShell_V2=%%i")
if defined PowerShell_V2 (
		echo Removing %PowerShell_V2%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PowerShell_V2% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PowerShell_V2%" /f
	) else (
		echo PowerShell V2 Client not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\MicrosoftWindowsPowerShellV2" /f
echo PowerShell V2 removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-PrintToPDF" ^| findstr "~~"') do (set "PrintToPDF=%%i")
if defined PrintToPDF (
		echo Removing %PrintToPDF%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PrintToPDF% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /f
	) else (
		echo Print To PDF Client not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-PrintToPDF" ^| findstr "~~"') do (set "PrintToPDF=%%i")
if defined PrintToPDF (
		echo Removing %PrintToPDF%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PrintToPDF% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PrintToPDF%" /f
	) else (
		echo Print To PDF Client not found, skipping.
	)
echo Print To PDF removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-X" ^| findstr "~~"') do (set "XPSDocumentWriter=%%i")
if defined XPSDocumentWriter (
		echo Removing %XPSDocumentWriter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%XPSDocumentWriter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /f
	) else (
		echo XPS Document Writer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Printing-X" ^| findstr "~~"') do (set "XPSDocumentWriter=%%i")
if defined XPSDocumentWriter (
		echo Removing %XPSDocumentWriter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%XPSDocumentWriter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%XPSDocumentWriter%" /f
	) else (
		echo XPS Document Writer not found, skipping.
	)
echo XPS Document Writer removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-merged-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-merged-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-UI-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-UI-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OfflineFiles-WOW64-Package" ^| findstr "~~"') do (set "Offline_Files=%%i")
if defined Offline_Files (
		echo Removing %Offline_Files%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Offline_Files% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Offline_Files%" /f
	) else (
		echo Offline Files not found, skipping.
	)
echo Offline Files removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-Administration-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientCore-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientLocalUI-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientLocalUI-D-Opt-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NFS-ClientSKU-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ClientForNFS-Infrastructure-OptGroup-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ClientForNFS-Infrastructure-OptGroup-Package" ^| findstr "~~"') do (set "Services_For_NFS=%%i")
if defined Services_For_NFS (
		echo Removing %Services_For_NFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Services_For_NFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Services_For_NFS%" /f
	) else (
		echo Services For NFS not found, skipping.
	)
echo Services For NFS removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-COM-MSMQ-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-adintegration-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-adintegration-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-Client-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-dcomproxy-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-http-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-MSMQ-MMC-OptGroup-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-mmc-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-multicast-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-multicast-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-powershell-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-runtime-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-server-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-server-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-msmq-triggers-Opt-WOW64-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MSMQ-Driver-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "MSMQ-Driver-Package" ^| findstr "~~"') do (set "MS_MQ=%%i")
if defined MS_MQ (
		echo Removing %MS_MQ%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MS_MQ% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MS_MQ%" /f
	) else (
		echo MSMQ not found, skipping.
	)
echo MSMQ removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Management-SecureAssessment-Package" ^| findstr "~~"') do (set "Secure_Assessment=%%i")
if defined Secure_Assessment (
		echo Removing %Secure_Assessment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Secure_Assessment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Secure_Assessment%" /f
	) else (
		echo Secure Assessment not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.SecureAssessmentBrowser_cw5n1h2txyewy" /q /s
echo Secure Assessment removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-2-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-AddOn-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-IIS-WebServer-ServerCommon-Package" ^| findstr "~~"') do (set "IIS_WebServer=%%i")
if defined IIS_WebServer (
		echo Removing %IIS_WebServer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IIS_WebServer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IIS_WebServer%" /f
	) else (
		echo IIS not found, skipping.
	)
echo IIS removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-IoTUAP-ShellExt-Tools-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-IoTUAP-ShellExt-Tools-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-AssignedAccessCsp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-BootExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-BootExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-DialogBlocking-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-EmbeddedLogon-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Core-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-KeyboardFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilterCSP-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-UnifiedWriteFilter-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-CustomShellHost-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-CustomShellHost-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-EmbeddedExp-WOW64-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-ShellLauncher-Package" ^| findstr "~~"') do (set "Embedded_things=%%i")
if defined Embedded_things (
		echo Removing %Embedded_things%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Embedded_things% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Embedded_things%" /f
	) else (
		echo Embedded not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-DeviceLockdown" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-KeyboardFilter" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Client-UnifiedWriteFilter" /f
echo Embedded removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Opt-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DataCenterBridging-WOW64-Package" ^| findstr "~~"') do (set "DataCenter_Bridging=%%i")
if defined DataCenter_Bridging (
		echo Removing %DataCenter_Bridging%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DataCenter_Bridging% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DataCenter_Bridging%" /f
	) else (
		echo DataCenterBridging not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\DataCenterBridging" /f
echo DataCenterBridging removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Embedded-AssignedAccessCsp-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access Embedded not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Client-AssignedAccess-WOW64-Package" ^| findstr "~~"') do (set "Assigned_Access=%%i")
if defined Assigned_Access (
		echo Removing %Assigned_Access%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Assigned_Access% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Assigned_Access%" /f
	) else (
		echo Assigned Access not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.AssignedAccessLockApp_cw5n1h2txyewy" /q /s
echo Assigned Access removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-base-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-onecore-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DeviceGuard-GPEXT-Package" ^| findstr "~~"') do (set "DeviceGuard=%%i")
if defined DeviceGuard (
		echo Removing %DeviceGuard%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DeviceGuard% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DeviceGuard%" /f
	) else (
		echo DeviceGuard not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-ds-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-onecore-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-servercommon-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Shielded-VM-Service-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-merged-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Chipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Chipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-AzureVirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-AzureVirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "\HyperV-Compute-System-AzureVirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "\HyperV-Compute-System-AzureVirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Host-VirtualMachines-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-Storage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VirtualMachine-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Compute-System-VmDirect-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-DynamicMemory-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-DynamicMemory-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-ApplicationGuard-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-ApplicationGuard-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Feature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KernelInt-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KMCL-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Guest-KMCL-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-Interop-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-Interop-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Compute-PowerShell-Module-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Host-Devices-EmulatedChipset-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HvSocket-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HvSocket-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-minkernel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Core-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Core-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Server-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IntegrationComponents-VirtualDevice-Server-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KernelInt-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-LegacyChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-mergedcomponents-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-mergedcomponents-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-IsolatedVM-SVC-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KMCL-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-KMCL-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Containers-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Emulated-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Networking-VirtualDevice-Synthetic-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Primitive-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Primitive-VirtualMachine-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-RDP4VS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-QoS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-FibreChannel-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-IDE-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-PMEM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SCSI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VirtualDevice-SMB-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Storage-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-PowerShell-Module-HyperV-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-62-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-63-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Client-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-termsrv-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-UX-UI-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VID-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VID-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Virtio-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Virtio-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-Host-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmBus-VirtualDevice-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmChipset-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VMMS-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmSerial-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmSerial-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmTpm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmTpm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmUiDevices-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-VmUiDevices-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-DDA-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-FlexIo-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VirtualDevice-Gpup-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Vpci-VSP-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Worker-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Updates" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-ClientEdition-WOW64-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-servercommon-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-servercommon-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-vm-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-onecore-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-ComputeStorage-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-IsolatedVM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ApiSetSchemaExtension-HyperV-IsolatedVM-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Common-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Offline-Core-Group-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Online-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-merged-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Package-base-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Services-Package" ^| findstr "~~"') do (set "HyperV=%%i")
if defined HyperV (
		echo Removing %HyperV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HyperV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HyperV%" /f
	) else (
		echo HyperV not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Hypervisor" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Management-PowerShell" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Hyper-V-Services" /f
echo HyperV Setup removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-tabletpcmath-package-Wrapper" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Base" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Base" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Package" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TabletPCMath-Package" ^| findstr "~~"') do (set "TabletPCMath=%%i")
if defined TabletPCMath (
		echo Removing %TabletPCMath%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TabletPCMath% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TabletPCMath%" /f
	) else (
		echo Tablet PC Math not found, skipping.
	)
echo Tablet PC Math removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingCompatibility-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingConsole-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-merged-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingPowershell-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingUI-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReporting-Adm-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ErrorReportingDumpTypeControl-Package" ^| findstr "~~"') do (set "WReport=%%i")
if defined WReport (
		echo Removing %WReport%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WReport% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WReport%" /f
	) else (
		echo Windows Error Reporting not found, skipping.
	)
echo Windows Error Reporting removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TextPrediction" ^| findstr "~~"') do (set "TextPrediction=%%i")
if defined TextPrediction (
		echo Removing %TextPrediction%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TextPrediction% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /f
	) else (
		echo TextPrediction not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Spelling" ^| findstr "~~"') do (set "SpelingD=%%i")
if defined SpelingD (
		echo Removing %SpelingD%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SpelingD% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SpelingD%" /f
	) else (
		echo Spelling not found, skipping.
	)
echo Spelling removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DesktopFileExplorer" ^| findstr "~~"') do (set "DesktopFileExplorer=%%i")
if defined DesktopFileExplorer (
		echo Removing %DesktopFileExplorer%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%DesktopFileExplorer% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DesktopFileExplorer%" /f
	) else (
		echo Desktop File Explorer not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.Windows.FileExplorer_cw5n1h2txyewy" /q /s
echo Desktop File Explorer removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS-OptionalFeature-Package" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS-Package" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ProjFS" ^| findstr "~~"') do (set "ProjFS=%%i")
if defined ProjFS (
		echo Removing %ProjFS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ProjFS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ProjFS%" /f
	) else (
		echo ProjFS not found, skipping.
	)
echo ProjFS removed
echo Removed all here. Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem

:RDCRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
echo RDC removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:ScreenSaversRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ScreenSavers" ^| findstr "~~"') do (set "ScreenSavers=%%i")
if defined ScreenSavers (
		echo Removing %ScreenSavers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ScreenSavers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%" /f
	) else (
		echo ScreenSavers not found, skipping.
	)
echo ScreenSavers removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:ShellWallpaperRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-Wallpaper" ^| findstr "~~"') do (set "ShellWallpaper=%%i")
if defined ShellWallpaper (
		echo Removing %ShellWallpaper%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ShellWallpaper% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%" /f
	) else (
		echo ShellWallpaper not found, skipping.
	)
echo ShellWallpaper removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:TextPredictionRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TextPrediction" ^| findstr "~~"') do (set "TextPrediction=%%i")
if defined TextPrediction (
		echo Removing %TextPrediction%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TextPrediction% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /f
	) else (
		echo TextPrediction not found, skipping.
	)
echo TextPrediction removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:ContentExtendedRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-wallpaper-content-extended-fod-package-Wrapper" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Wallpaper-Content-Extended-FoD-Package" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Wallpaper-Content-Extended-Package" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
echo WallpaperContentExtended removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:WinSATRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinSATMediaFiles-Package" ^| findstr "~~"') do (set "WinSAT=%%i")
if defined WinSAT (
		echo Removing %WinSAT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WinSAT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /f
	) else (
		echo WinSAT not found, skipping.
	)
echo WinSAT removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:PhotoBasicRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
echo PhotoBasic removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:PeerDistRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\PeerDist" /f
echo BranchCache removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:BioEnrollmentRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BioEnrollment" ^| findstr "~~"') do (set "BioEnrollment=%%i")
if defined BioEnrollment (
		echo Removing %BioEnrollment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%BioEnrollment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /f
	) else (
		echo BioEnrollment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BioEnrollment" ^| findstr "~~"') do (set "BioEnrollment=%%i")
if defined BioEnrollment (
		echo Removing %BioEnrollment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%BioEnrollment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /f
	) else (
		echo BioEnrollment not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.BioEnrollment_cw5n1h2txyewy" /q /s
echo BioEnrollment removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:PPIProjectionRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-PPIProjection-Package" ^| findstr "~~"') do (set "PPIProjectionPackage=%%i")
if defined PPIProjectionPackage (
		echo Removing %PPIProjectionPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PPIProjectionPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /f
	) else (
		echo PPIProjectionPackage not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-PPIProjection-Package" ^| findstr "~~"') do (set "PPIProjectionPackage=%%i")
if defined PPIProjectionPackage (
		echo Removing %PPIProjectionPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PPIProjectionPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /f
	) else (
		echo PPIProjectionPackage not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.PPIProjection_cw5n1h2txyewy" /q /s
echo PPIProjection removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:PenServ
cls
sc delete PenService_
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"pen;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!pen;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Pen service removed. Press any key to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:ContainersRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-SDN-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-SDN-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-HNS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-HNS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Client-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Client-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-windows-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-windows-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-OptionalFeature-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-OptionalFeature-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-EventLogAPI-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-EventLogAPI-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Http-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Http-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVm-SetupAgent-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVm-SetupAgent-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-DISM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-DISM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-RemoteFS-Client-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-RemoteFS-Client-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-ApplicationGuard-Shared-Gated" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-Guest-Gating" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-Server-For-Application-Guard" /f
echo Containers removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:StorageQoSRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
echo Storage QoS removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:RemoteAssistanceRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
echo Remote Assistance removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:SimpleTCPRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SimpleTCP-Opt-Package" ^| findstr "~~"') do (set "SimpleTCP=%%i")
if defined SimpleTCP (
		echo Removing %SimpleTCP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SimpleTCP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /f
	) else (
		echo SimpleTCP not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SimpleTCP-Package" ^| findstr "~~"') do (set "SimpleTCP=%%i")
if defined SimpleTCP (
		echo Removing %SimpleTCP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SimpleTCP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /f
	) else (
		echo SimpleTCP not found, skipping.
	)
echo SimpleTCP removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:Smbv1Remove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Server-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Server-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Browser-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Browser-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\SMB1Browser" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\SMB1Protocol" /f
echo Smbv1 removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:SmbDirectRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SmbDirect-Opt-Package" ^| findstr "~~"') do (set "SmbDirect=%%i")
if defined SmbDirect (
		echo Removing %SmbDirect%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SmbDirect% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /f
	) else (
		echo SmbDirect not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SmbDirect-Package" ^| findstr "~~"') do (set "SmbDirect=%%i")
if defined SmbDirect (
		echo Removing %SmbDirect%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SmbDirect% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /f
	) else (
		echo SmbDirect not found, skipping.
	)
echo SmbDirect removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:OCRRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-LanguageFeatures-OCR" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Opt-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Opt-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
echo Windows TIFF IFilter OCR removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:WMPNetworkSharingServiceRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Windows-WMPNetworkSharingService-Update" /f
echo WMPNetworkSharingService removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:DolbyRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
echo Dolby removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:FirewallUIRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-net-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-onecore-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
echo FirewallUI removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:HelpPackageRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Server-Help-Package.ClientEnterprise" ^| findstr "~~"') do (set "HelpPackage=%%i")
if defined HelpPackage (
		echo Removing %HelpPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HelpPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%" /f
	) else (
		echo Rights Management support not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Server-Help-Package_ClientEnterprise-Update" /f
echo Rights Management support removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:HgsClientRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-ds-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-onecore-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-servercommon-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Shielded-VM-Service-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
echo Guarded Host removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:RemoveAll2
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Opt-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RDC-Package" ^| findstr "~~"') do (set "RDC=%%i")
if defined RDC (
		echo Removing %RDC%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RDC% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RDC%" /f
	) else (
		echo RDC not found, skipping.
	)
echo RDC removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ScreenSavers" ^| findstr "~~"') do (set "ScreenSavers=%%i")
if defined ScreenSavers (
		echo Removing %ScreenSavers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ScreenSavers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ScreenSavers%" /f
	) else (
		echo ScreenSavers not found, skipping.
	)
echo ScreenSavers removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Shell-Wallpaper" ^| findstr "~~"') do (set "ShellWallpaper=%%i")
if defined ShellWallpaper (
		echo Removing %ShellWallpaper%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ShellWallpaper% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ShellWallpaper%" /f
	) else (
		echo ShellWallpaper not found, skipping.
	)
echo ShellWallpaper removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-TextPrediction" ^| findstr "~~"') do (set "TextPrediction=%%i")
if defined TextPrediction (
		echo Removing %TextPrediction%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%TextPrediction% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%TextPrediction%" /f
	) else (
		echo TextPrediction not found, skipping.
	)
echo TextPrediction removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-wallpaper-content-extended-fod-package-Wrapper" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Wallpaper-Content-Extended-FoD-Package" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Wallpaper-Content-Extended-Package" ^| findstr "~~"') do (set "ContentExtended=%%i")
if defined ContentExtended (
		echo Removing %ContentExtended%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ContentExtended% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ContentExtended%" /f
	) else (
		echo WallpaperContentExtended not found, skipping.
	)
echo WallpaperContentExtended removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinSATMediaFiles-Package" ^| findstr "~~"') do (set "WinSAT=%%i")
if defined WinSAT (
		echo Removing %WinSAT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WinSAT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WinSAT%" /f
	) else (
		echo WinSAT not found, skipping.
	)
echo WinSAT removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Feature-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-PictureTools-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-merged-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PhotoBasic-WOW64-Package" ^| findstr "~~"') do (set "PhotoBasic=%%i")
if defined PhotoBasic (
		echo Removing %PhotoBasic%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PhotoBasic% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PhotoBasic%" /f
	) else (
		echo PhotoBasic not found, skipping.
	)
echo PhotoBasic removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Group-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PeerDist-Client-WOW64-Package" ^| findstr "~~"') do (set "PeerDist=%%i")
if defined PeerDist (
		echo Removing %PeerDist%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PeerDist% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PeerDist%" /f
	) else (
		echo BranchCache not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\PeerDist" /f
echo BranchCache removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BioEnrollment" ^| findstr "~~"') do (set "BioEnrollment=%%i")
if defined BioEnrollment (
		echo Removing %BioEnrollment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%BioEnrollment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /f
	) else (
		echo BioEnrollment not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BioEnrollment" ^| findstr "~~"') do (set "BioEnrollment=%%i")
if defined BioEnrollment (
		echo Removing %BioEnrollment%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%BioEnrollment% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%BioEnrollment%" /f
	) else (
		echo BioEnrollment not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.BioEnrollment_cw5n1h2txyewy" /q /s
echo BioEnrollment removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-PPIProjection-Package" ^| findstr "~~"') do (set "PPIProjectionPackage=%%i")
if defined PPIProjectionPackage (
		echo Removing %PPIProjectionPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PPIProjectionPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /f
	) else (
		echo PPIProjectionPackage not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-PPIProjection-Package" ^| findstr "~~"') do (set "PPIProjectionPackage=%%i")
if defined PPIProjectionPackage (
		echo Removing %PPIProjectionPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%PPIProjectionPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%PPIProjectionPackage%" /f
	) else (
		echo PPIProjectionPackage not found, skipping.
	)
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.PPIProjection_cw5n1h2txyewy" /q /s
echo PPIProjection removed
sc delete PenService_
schtasks /delete /TN "Microsoft\Windows\Input\PenSyncDataAvailable" /f
schtasks /delete /TN "Microsoft\Windows\Input" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"pen;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!pen;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo.
echo Pen service removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-ApplicationGuard-Shared-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-SDN-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-SDN-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Guest-Gated-WOW64-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-HNS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-HNS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Client-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Client-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Manager-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Client-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-windows-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-DisposableClientVM-windows-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-OptionalFeature-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-OptionalFeature-DisposableClientVM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Containers-Server-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-EventLogAPI-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-EventLogAPI-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Http-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Http-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-onecore-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVm-SetupAgent-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-UtilityVm-SetupAgent-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-DISM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-DISM-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneCore-Containers-Opt-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-RemoteFS-Client-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CoreSystem-RemoteFS-Client-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-UtilityVM-Containers-Setup-Shared-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-merged-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-Containers-Guest-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Containers not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-ApplicationGuard-Shared-Gated" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-Guest-Gating" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Containers-Server-For-Application-Guard" /f
echo Containers removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "DiskIo-QoS-Package" ^| findstr "~~"') do (set "Containers=%%i")
if defined Containers (
		echo Removing %Containers%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Containers% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Containers%" /f
	) else (
		echo Storage QoS not found, skipping.
	)
echo Storage QoS removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteAssistance-Package-Client" ^| findstr "~~"') do (set "RemoteA=%%i")
if defined RemoteA (
		echo Removing %RemoteA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteA%" /f
	) else (
		echo Remote Assistance not found, skipping.
	)
echo Remote Assistance removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SimpleTCP-Opt-Package" ^| findstr "~~"') do (set "SimpleTCP=%%i")
if defined SimpleTCP (
		echo Removing %SimpleTCP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SimpleTCP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /f
	) else (
		echo SimpleTCP not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SimpleTCP-Package" ^| findstr "~~"') do (set "SimpleTCP=%%i")
if defined SimpleTCP (
		echo Removing %SimpleTCP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SimpleTCP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SimpleTCP%" /f
	) else (
		echo SimpleTCP not found, skipping.
	)
echo SimpleTCP removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Client-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Group-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Deprecation-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Server-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SMB1Server-D-Opt-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Browser-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Browser-Package" ^| findstr "~~"') do (set "Smbv1=%%i")
if defined Smbv1 (
		echo Removing %Smbv1%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Smbv1% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Smbv1%" /f
	) else (
		echo Smbv1 not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\SMB1Browser" /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\SMB1Protocol" /f
echo Smbv1 removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SmbDirect-Opt-Package" ^| findstr "~~"') do (set "SmbDirect=%%i")
if defined SmbDirect (
		echo Removing %SmbDirect%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SmbDirect% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /f
	) else (
		echo SmbDirect not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SmbDirect-Package" ^| findstr "~~"') do (set "SmbDirect=%%i")
if defined SmbDirect (
		echo Removing %SmbDirect%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SmbDirect% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SmbDirect%" /f
	) else (
		echo SmbDirect not found, skipping.
	)
echo SmbDirect removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-LanguageFeatures-OCR" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Opt-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Opt-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WinOcr-Package" ^| findstr "~~"') do (set "OCR=%%i")
if defined OCR (
		echo Removing %OCR%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OCR% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OCR%" /f
	) else (
		echo Windows TIFF IFilter OCR not found, skipping.
	)
echo Windows TIFF IFilter OCR removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Opt-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WMPNetworkSharingService-WOW64-Package" ^| findstr "~~"') do (set "WMPNetworkSharingService=%%i")
if defined WMPNetworkSharingService (
		echo Removing %WMPNetworkSharingService%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WMPNetworkSharingService% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WMPNetworkSharingService%" /f
	) else (
		echo WMPNetworkSharingService not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Microsoft-Windows-WMPNetworkSharingService-Update" /f
echo WMPNetworkSharingService removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Multimedia-RestrictedCodecsDolby-WOW64-Package" ^| findstr "~~"') do (set "Dolby=%%i")
if defined Dolby (
		echo Removing %Dolby%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Dolby% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Dolby%" /f
	) else (
		echo Dolby not found, skipping.
	)
echo Dolby removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-net-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-onecore-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Networking-MPSSVC-Rules-EnterpriseEdition-Package" ^| findstr "~~"') do (set "FirewallUI=%%i")
if defined FirewallUI (
		echo Removing %FirewallUI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FirewallUI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FirewallUI%" /f
	) else (
		echo FirewallUI not found, skipping.
	)
echo FirewallUI removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Server-Help-Package.ClientEnterprise" ^| findstr "~~"') do (set "HelpPackage=%%i")
if defined HelpPackage (
		echo Removing %HelpPackage%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HelpPackage% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HelpPackage%" /f
	) else (
		echo Rights Management support not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\Server-Help-Package_ClientEnterprise-Update" /f
echo Rights Management support removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-ds-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-onecore-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-HgsClient-Core-servercommon-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Feature-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PAW-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-merged-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Host-Guardian-Deployment-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Shielded-VM-Service-Package" ^| findstr "~~"') do (set "HgsClient=%%i")
if defined HgsClient (
		echo Removing %HgsClient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HgsClient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HgsClient%" /f
	) else (
		echo Guarded Host not found, skipping.
	)
echo Guarded Host removed
echo Removed all here 2. Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem2

:VBSRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-merged-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo Virtualization-based security VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo Virtualization-based security VBS not found, skipping.
	)
echo Virtualization-based security VBS removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:FaxRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Fax-Client-Feature-Opt-Package" ^| findstr "~~"') do (set "Fax=%%i")
if defined Fax (
		echo Removing %Fax%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Fax% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /f
	) else (
		echo Windows Fax and Scan not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Fax-Client-Feature-Opt-Package" ^| findstr "~~"') do (set "Fax=%%i")
if defined Fax (
		echo Removing %Fax%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Fax% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /f
	) else (
		echo Windows Fax and Scan not found, skipping.
	)
echo Windows Fax and Scan removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:RemoteFXRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Remotefx-Clientvm-Rdvgwddmdx11-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Remotefx-Clientvm-Rdvgwddmdx11-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-RemoteFX-clientVM-RemoteFXWDDMDriver-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-RemoteFX-clientVM-RemoteFXWDDMDriver-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-Graphics-Virtualization-Host-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-Graphics-Virtualization-Host-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-HyperV-Integration-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-HyperV-Integration-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-termsrv-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-termsrv-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
echo RemoteFX removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:enterpriseclientRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
echo enterpriseclient removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:FCIRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-WOW64-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-WOW64-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
echo File Server Resource Manager removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:WindowsHelpContentRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-ua-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-ua-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
echo Windows Help Content removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:DiagAndTRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NetworkDiagnostics-DirectAccessEntry-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DiagnosticInfrastructure-Adm-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DiagnosticInfrastructure-Adm-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
echo Diagnostics and troubleshooting removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:SecureStartupRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Subsystem-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Subsystem-WOW64-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\BitLocker" /f
echo BitLocker Drive Encryption removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:CeipRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
echo Ceip removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:KernelLA57Remove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-kernel-la57-fod-package-Wrapper" ^| findstr "~~"') do (set "KernelLA57=%%i")
if defined KernelLA57 (
		echo Removing %KernelLA57%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%KernelLA57% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /f
	) else (
		echo KernelLA57 Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Kernel-LA57-FoD-Package" ^| findstr "~~"') do (set "KernelLA57=%%i")
if defined KernelLA57 (
		echo Removing %KernelLA57%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%KernelLA57% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /f
	) else (
		echo KernelLA57 not found, skipping.
	)
echo KernelLA57 removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:PowershellISERemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-powershell-ise-fod-package-Wrapper" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
echo Powershell ISE removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:OneSyncRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-onecore-applicationmodel-sync-desktop-fod-package-Wrapper" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-ApplicationModel-Sync-Desktop-FOD-Package" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-ApplicationModel-Sync-Desktop-FOD-Package" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync not found, skipping.
	)
echo OneSync removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:DeviceUpdateCenterRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-DeviceUpdateCenter-Package" ^| findstr "~~"') do (set "UpdateCenter=%%i")
if defined UpdateCenter (
		echo Removing %UpdateCenter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UpdateCenter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /f
	) else (
		echo Device Update Center not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-DeviceUpdateCenter-Package" ^| findstr "~~"') do (set "UpdateCenter=%%i")
if defined UpdateCenter (
		echo Removing %UpdateCenter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UpdateCenter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /f
	) else (
		echo Device Update Center not found, skipping.
	)
echo Device Update Center removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:CloudIdentityRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-WOW64-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
echo Microsoft Cloud Identity Service removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:IoTRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-WindowsIoT-Package" ^| findstr "~~"') do (set "IoT=%%i")
if defined IoT (
		echo Removing %IoT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IoT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /f
	) else (
		echo Embedded Mode not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-WindowsIoT-Package" ^| findstr "~~"') do (set "IoT=%%i")
if defined IoT (
		echo Removing %IoT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IoT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /f
	) else (
		echo Embedded Mode not found, skipping.
	)
echo Embedded Mode removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:UEVRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-WOW64-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-WOW64-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
echo User Experience Virtualization UEV removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:DirectoryServicesRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-Admin-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-OptGroup-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Core-Client-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Install-Group-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Snapins-Admin-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Snapins-Group-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-merged-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-merged-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
echo Active Directory Lightweight Services removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:MixedRealityRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-WOW64-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
echo WindowsMixedReality removed Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:StepsR
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-stepsrecorder-package-Wrapper" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
echo Steps Recorder Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem3

:SupportQuick
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-QuickAssist-Package" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-QuickAssist-Package" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-quickassist-package-Wrapper" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist Wrapper not found, skipping.
	)
echo Support QuickAssist Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem3

:HelloFacee
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-hello-face-migration-package-Wrapper" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Migration Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-hello-face-package-Wrapper" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Hello-Face-Package" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Wrapper not found, skipping.
	)
echo Hello Face Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem3

:RemoveAll3
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "HyperV-Hypervisor-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Hyper-V-Hypervisor-merged-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-IsolatedUserMode-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-VirtualizationBasedSecurity-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo Virtualization-based security VBS not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecConfig-Package" ^| findstr "~~"') do (set "VBS=%%i")
if defined VBS (
		echo Removing %VBS%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%VBS% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%VBS%" /f
	) else (
		echo Virtualization-based security VBS not found, skipping.
	)
echo Virtualization-based security VBS removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Fax-Client-Feature-Opt-Package" ^| findstr "~~"') do (set "Fax=%%i")
if defined Fax (
		echo Removing %Fax%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Fax% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /f
	) else (
		echo Windows Fax and Scan not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Fax-Client-Feature-Opt-Package" ^| findstr "~~"') do (set "Fax=%%i")
if defined Fax (
		echo Removing %Fax%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Fax% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Fax%" /f
	) else (
		echo Windows Fax and Scan not found, skipping.
	)
echo Windows Fax and Scan removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Remotefx-Clientvm-Rdvgwddmdx11-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Remotefx-Clientvm-Rdvgwddmdx11-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-RemoteFX-clientVM-RemoteFXWDDMDriver-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-RemoteFX-clientVM-RemoteFXWDDMDriver-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-Graphics-Virtualization-Host-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-Graphics-Virtualization-Host-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-HyperV-Integration-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-HyperV-Integration-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-termsrv-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-termsrv-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RemoteFX-VM-Setup-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Virtualization-RemoteFX-User-Mode-Transport-WOW64-Package" ^| findstr "~~"') do (set "RemoteFX=%%i")
if defined RemoteFX (
		echo Removing %RemoteFX%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%RemoteFX% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%RemoteFX%" /f
	) else (
		echo RemoteFX not found, skipping.
	)
echo RemoteFX removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Onecore-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-ConfigCI-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Enterprise-Desktop-Shared-WOW64-Package" ^| findstr "~~"') do (set "enterpriseclient=%%i")
if defined enterpriseclient (
		echo Removing %enterpriseclient%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%enterpriseclient% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%enterpriseclient%" /f
	) else (
		echo enterpriseclient not found, skipping.
	)
echo enterpriseclient removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-WOW64-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FCI-Client-WOW64-Package" ^| findstr "~~"') do (set "FCI=%%i")
if defined FCI (
		echo Removing %FCI%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%FCI% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%FCI%" /f
	) else (
		echo File Server Resource Manager not found, skipping.
	)
echo File Server Resource Manager removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientOOBE-Feature-Package" ^| findstr "~~"') do (set "ClientOOBE=%%i")
if defined ClientOOBE (
		echo Removing %ClientOOBE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientOOBE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientOOBE%" /f
	) else (
		echo Help-ClientOOBE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-ua-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Help-ClientUA-Client-ua-Package" ^| findstr "~~"') do (set "ClientUA=%%i")
if defined ClientUA (
		echo Removing %ClientUA%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ClientUA% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ClientUA%" /f
	) else (
		echo Help-ClientUA not found, skipping.
	)
echo Windows Help Content removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-NetworkDiagnostics-DirectAccessEntry-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DiagnosticInfrastructure-Adm-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DiagnosticInfrastructure-Adm-Package" ^| findstr "~~"') do (set "Troubleshoo=%%i")
if defined Troubleshoo (
		echo Removing %Troubleshoo%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Troubleshoo% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Troubleshoo%" /f
	) else (
		echo Diagnostics and troubleshooting not found, skipping.
	)
echo Diagnostics and troubleshooting removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Subsystem-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-SecureStartup-Subsystem-WOW64-Package" ^| findstr "~~"') do (set "SecStartup=%%i")
if defined SecStartup (
		echo Removing %SecStartup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%SecStartup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%SecStartup%" /f
	) else (
		echo BitLocker Drive Encryption not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\UpdateDetect\BitLocker" /f
echo BitLocker Drive Encryption removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-CEIPEnable-Adm-Package" ^| findstr "~~"') do (set "Ceip=%%i")
if defined Ceip (
		echo Removing %Ceip%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Ceip% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Ceip%" /f
	) else (
		echo Ceip not found, skipping.
	)
echo Ceip removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-kernel-la57-fod-package-Wrapper" ^| findstr "~~"') do (set "KernelLA57=%%i")
if defined KernelLA57 (
		echo Removing %KernelLA57%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%KernelLA57% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /f
	) else (
		echo KernelLA57 Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Kernel-LA57-FoD-Package" ^| findstr "~~"') do (set "KernelLA57=%%i")
if defined KernelLA57 (
		echo Removing %KernelLA57%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%KernelLA57% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%KernelLA57%" /f
	) else (
		echo KernelLA57 not found, skipping.
	)
echo KernelLA57 removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-powershell-ise-fod-package-Wrapper" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-PowerShell-ISE-FOD-Package" ^| findstr "~~"') do (set "ISE=%%i")
if defined ISE (
		echo Removing %ISE%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%ISE% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%ISE%" /f
	) else (
		echo Powershell ISE not found, skipping.
	)
echo Powershell ISE removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-onecore-applicationmodel-sync-desktop-fod-package-Wrapper" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-ApplicationModel-Sync-Desktop-FOD-Package" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-ApplicationModel-Sync-Desktop-FOD-Package" ^| findstr "~~"') do (set "OneSync=%%i")
if defined OneSync (
		echo Removing %OneSync%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneSync% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneSync%" /f
	) else (
		echo OneSync not found, skipping.
	)
echo OneSync removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-DeviceUpdateCenter-Package" ^| findstr "~~"') do (set "UpdateCenter=%%i")
if defined UpdateCenter (
		echo Removing %UpdateCenter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UpdateCenter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /f
	) else (
		echo Device Update Center not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-DeviceUpdateCenter-Package" ^| findstr "~~"') do (set "UpdateCenter=%%i")
if defined UpdateCenter (
		echo Removing %UpdateCenter%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UpdateCenter% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UpdateCenter%" /f
	) else (
		echo Device Update Center not found, skipping.
	)
echo Device Update Center removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Onecore-Identity-TenantRestrictions-WOW64-Package" ^| findstr "~~"') do (set "CloudIdentity=%%i")
if defined CloudIdentity (
		echo Removing %CloudIdentity%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%CloudIdentity% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%CloudIdentity%" /f
	) else (
		echo Microsoft Cloud Identity Service not found, skipping.
	)
echo Microsoft Cloud Identity Service removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-WindowsIoT-Package" ^| findstr "~~"') do (set "IoT=%%i")
if defined IoT (
		echo Removing %IoT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IoT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /f
	) else (
		echo Embedded Mode not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-WindowsIoT-Package" ^| findstr "~~"') do (set "IoT=%%i")
if defined IoT (
		echo Removing %IoT%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%IoT% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%IoT%" /f
	) else (
		echo Embedded Mode not found, skipping.
	)
echo Embedded Mode removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-WOW64-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-AppManagement-UEV-WOW64-Package" ^| findstr "~~"') do (set "UEV=%%i")
if defined UEV (
		echo Removing %UEV%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UEV% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UEV%" /f
	) else (
		echo User Experience Virtualization UEV not found, skipping.
	)
echo User Experience Virtualization UEV
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-Admin-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-OptGroup-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Client-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Core-Client-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Install-Group-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Snapins-Admin-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Snapins-Group-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-merged-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-merged-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-DirectoryServices-ADAM-Tools-Opt-Package" ^| findstr "~~"') do (set "DirectoryServices=%%i")
if defined DirectoryServices (
		echo Removing %DirectoryServices%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%DirectoryServices% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%DirectoryServices%" /f
	) else (
		echo Active Directory Lightweight Services not found, skipping.
	)
echo Active Directory Lightweight Services removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Composable-PlatformExtension-DragDropCommon-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Analog-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-WOW64-merged-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Holographic-Desktop-Merged-WOW64-Package" ^| findstr "~~"') do (set "MixedReality=%%i")
if defined MixedReality (
		echo Removing %MixedReality%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%MixedReality% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%MixedReality%" /f
	) else (
		echo WindowsMixedReality not found, skipping.
	)
echo WindowsMixedReality removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-stepsrecorder-package-Wrapper" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-StepsRecorder-Package" ^| findstr "~~"') do (set "StepsRec=%%i")
if defined StepsRec (
		echo Removing %StepsRec%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%StepsRec% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%StepsRec%" /f
	) else (
		echo Steps Recorder Wrapper not found, skipping.
	)
echo Steps Recorder Removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-QuickAssist-Package" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-QuickAssist-Package" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-quickassist-package-Wrapper" ^| findstr "~~"') do (set "quicka=%%i")
if defined quicka (
		echo Removing %quicka%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%quicka% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%quicka%" /f
	) else (
		echo Support QuickAssist Wrapper not found, skipping.
	)
echo Support QuickAssist Removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-hello-face-migration-package-Wrapper" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Migration Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-hello-face-package-Wrapper" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Hello-Face-Package" ^| findstr "~~"') do (set "HeloFace=%%i")
if defined HeloFace (
		echo Removing %HeloFace%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%HeloFace% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%HeloFace%" /f
	) else (
		echo Hello Face Wrapper not found, skipping.
	)
echo Hello Face Removed
echo Removed all here 3. Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatSystem3

:MathRecognizerr
cls
Powershell -C "Get-WindowsCapability -Online -Name MathRecognizer* | Remove-WindowsCapability -Online"
echo MathRecognizer Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:WordPadd
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-wordpad-fod-package-Wrapper" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
echo WordPad Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:XPSViewerr
cls
Powershell -C "Get-WindowsCapability -Online -Name XPS.Viewer* | Remove-WindowsCapability -Online"
echo XPS Viewer Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:OpenSHHH
cls
Powershell -C "Get-WindowsCapability -Online -Name OpenSSH-Client-Package* | Remove-WindowsCapability -Online"
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-OpenSSH-ClientOnly-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-OpenSSH-Common-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "openssh-client-package-Wrapper" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-LibreSSL-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "OpenSSH-Client-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
echo OpenSSH Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:WRecoveryRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RecDisc-SDP-removable-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WRecovery% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /f
	) else (
		echo Windows Recovery not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RecoveryDrive-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WRecovery% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /f
	) else (
		echo Windows Recovery not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BootEnvironment-Dvd-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
	) else (
		echo Windows Recovery not found, skipping.
	)
echo Windows Recovery removed. Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:FlexibleRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Client-License-Flexible-Platform-Package" ^| findstr "~~"') do (set "Flexible=%%i")
if defined Flexible (
		echo Removing %Flexible%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Flexible% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /f
	) else (
		echo Microsoft Client License Flexible Platform not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Client-License-Flexible-Platform-Package" ^| findstr "~~"') do (set "Flexible=%%i")
if defined Flexible (
		echo Removing %Flexible%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Flexible% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /f
	) else (
		echo Microsoft Client License Flexible Platform not found, skipping.
	)
echo Microsoft Client License Flexible Platform removed. Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:UserProtectionRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-User-Choice-Protection-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-User-Choice-Protection-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
echo User Choice Protection removed. Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:FlipGridRemove
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FlipGridPWA-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FlipGridPWA-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
echo User Choice Protection removed. Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:RemoveAll4
cls
Powershell -C "Get-WindowsCapability -Online -Name MathRecognizer* | Remove-WindowsCapability -Online"
echo MathRecognizer Removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-WordPad-FoD-Package" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "microsoft-windows-wordpad-fod-package-Wrapper" ^| findstr "~~"') do (set "WordPade=%%i")
if defined WordPade (
		echo Removing %WordPade%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WordPade% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WordPade%" /f
	) else (
		echo Wordpad Wrapper not found, skipping.
	)
echo WordPad Removed
Powershell -C "Get-WindowsCapability -Online -Name XPS.Viewer* | Remove-WindowsCapability -Online"
echo XPS Viewer Removed
Powershell -C "Get-WindowsCapability -Online -Name OpenSSH-Client-Package* | Remove-WindowsCapability -Online"
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-OpenSSH-ClientOnly-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-OpenSSH-Common-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "openssh-client-package-Wrapper" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-OneCore-LibreSSL-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "OpenSSH-Client-Package" ^| findstr "~~"') do (set "OpenSH=%%i")
if defined OpenSH (
		echo Removing %OpenSH%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OpenSH% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OpenSH%" /f
	) else (
		echo OpenSSH Wrapper not found, skipping.
	)
echo OpenSSH Removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RecDisc-SDP-removable-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WRecovery% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /f
	) else (
		echo Windows Recovery not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-RecoveryDrive-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%WRecovery% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%" /f
	) else (
		echo Windows Recovery not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-BootEnvironment-Dvd-Package" ^| findstr "~~"') do (set "WRecovery=%%i")
if defined WRecovery (
		echo Removing %WRecovery%...
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%WRecovery%\Owners" /va /f
	) else (
		echo Windows Recovery not found, skipping.
	)
echo Windows Recovery removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Client-License-Flexible-Platform-Package" ^| findstr "~~"') do (set "Flexible=%%i")
if defined Flexible (
		echo Removing %Flexible%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Flexible% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /f
	) else (
		echo Microsoft Client License Flexible Platform not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Client-License-Flexible-Platform-Package" ^| findstr "~~"') do (set "Flexible=%%i")
if defined Flexible (
		echo Removing %Flexible%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Flexible% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Flexible%" /f
	) else (
		echo Microsoft Client License Flexible Platform not found, skipping.
	)
echo Microsoft Client License Flexible Platform removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-User-Choice-Protection-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-User-Choice-Protection-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
echo User Choice Protection removed
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FlipGridPWA-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-FlipGridPWA-Package" ^| findstr "~~"') do (set "UserP=%%i")
if defined UserP (
		echo Removing %UserP%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%UserP% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%UserP%" /f
	) else (
		echo User Choice Protection not found, skipping.
	)
echo User Choice Protection removed
echo User Choice Protection removed. Press enter to go to Debloat menu
Pause > Nul
goto DebloatSystem4

:DebloatManual
cls
echo                      [Store Apps]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo %green%                       [Recommanded]
echo [1] OneDrive              [16] App Connector
echo [2] Microsoft Edge        [17] Cortana
echo [3] 3D Builder            %blue%[18] App Installer(Needed for: winget)%green%
echo [4] 3D Viewer             [19] Get Help
echo [5] MSN News              [20] Tips
echo [6] MSN Weather           [21] Messaging
echo [7] HEIF Image Extensions [22] Mixed Reality Portal
echo [8] VP9 Video Extensions  [23] Feedback Hub
echo [9] Web Media Extensions  [24] Alarms and Clock
echo [10] Webp Image Extensions[25] Windows Camera app
echo [11] My Office            [26] Paint 3D
echo [12] OneNote              [27] Windows Maps
echo %blue%[13] Groove Music%green%         [28] Other Pre-installed
echo %blue%[14] Movies and TV%green%        [29] Microsoft People
echo [15] Your Phone           [30] Microsoft Pay
echo                           [31] Remove all here green
echo                           %blue%[32] Remove all here blue
echo. %reset%
echo                   [Page 1 of 3] [D = right]
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto OneDrive
if /i %input% == 2 goto Edge
if /i %input% == 3 goto 3DBuilder
if /i %input% == 4 goto 3DViewer
if /i %input% == 5 goto MSNNews
if /i %input% == 6 goto MSNWeather
if /i %input% == 7 goto HEIF
if /i %input% == 8 goto VP9
if /i %input% == 9 goto Web
if /i %input% == 10 goto Webp
if /i %input% == 11 goto MyOffice
if /i %input% == 12 goto OneNote
if /i %input% == 13 goto Groove
if /i %input% == 14 goto Movies
if /i %input% == 15 goto Phone
if /i %input% == 16 goto Connector
if /i %input% == 17 goto Cortana
if /i %input% == 18 goto AppInstaller
if /i %input% == 19 goto GetHelp
if /i %input% == 20 goto Tips
if /i %input% == 21 goto Messaging
if /i %input% == 22 goto Mixed
if /i %input% == 23 goto FeedbackHub
if /i %input% == 24 goto AlarmsClock
if /i %input% == 25 goto WCamera
if /i %input% == 26 goto Paint3D
if /i %input% == 27 goto WMaps
if /i %input% == 28 goto OtherPreinstalled
if /i %input% == 29 goto MPeople
if /i %input% == 30 goto MPay
if /i %input% == 31 goto removeallhere1
if /i %input% == 32 goto removeallhereblue2
if /i %input% == D cls & goto DebloatManual2
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatManual

:OneDrive
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneDrive-Setup-Package" ^| findstr "~~"') do (set "OneDrive_Setup=%%i")
if defined OneDrive_Setup (
		echo Removing %OneDrive_Setup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneDrive_Setup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /f
	) else (
		echo OneDrive Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneDrive-Setup-WOW64-Package" ^| findstr "~~"') do (set "OneDrive_Setup=%%i")
if defined OneDrive_Setup (
		echo Removing %OneDrive_Setup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%OneDrive_Setup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /f
	) else (
		echo OneDrive Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneDrive-Setup-WOW64-Package" ^| findstr "~~"') do (set "OneDrive_Setup=%%i")
if defined OneDrive_Setup (
		echo Removing %OneDrive_Setup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%OneDrive_Setup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /f
	) else (
		echo OneDrive Setup not found, skipping.
	)
reg delete "HKEY_USERS\S-1-5-19\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDriveSetup" /f
reg delete "HKEY_USERS\S-1-5-20\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDriveSetup" /f
tasklist /fi "ImageName eq OneDrive.exe" /fo csv 2>NUL | find /i "OneDrive.exe">NUL && (
    taskkill /f /im OneDrive.exe
)
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDrive" /f 2>nul
cd /d "%HOMEPATH%\AppData\Local\Microsoft"
for /f "tokens=1 delims=\" %%i in ('dir /B /A:D "%HOMEPATH%\AppData\Local\Microsoft\OneDrive" ^| find "."') do (set "onedrive_package_version=%%i")
if defined onedrive_package_version (
		echo Removing %onedrive_package_version%...
		OneDrive\%onedrive_package_version%\OneDriveSetup.exe /uninstall
	) else (
		echo Failed to uninstall, uninstaller could not be found.
	)
if exist "%UserProfile%\OneDrive" (
    rd "%UserProfile%\OneDrive" /q /s
)
if exist "%LocalAppData%\Microsoft\OneDrive" (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%LocalAppData%\Microsoft\OneDrive" /q /s
)
if exist "%ProgramData%\Microsoft OneDrive" (
    rd "%ProgramData%\Microsoft OneDrive" /q /s
)
if exist "%SystemDrive%\OneDriveTemp" (
    rd "%SystemDrive%\OneDriveTemp" /q /s
)
if exist "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Microsoft OneDrive.lnk" (
    del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Microsoft OneDrive.lnk" /s /f /q
)
if exist "%APPDATA%\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
if exist "%USERPROFILE%\Links\OneDrive.lnk" (
    del "%USERPROFILE%\Links\OneDrive.lnk" /s /f /q
)
if exist "%SystemDrive%\Windows\ServiceProfiles\LocalService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%SystemDrive%\Windows\ServiceProfiles\LocalService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
if exist "%SystemDrive%\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%SystemDrive%\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /t REG_DWORD /v "DisableFileSyncNGSC" /d 1 /f
reg add "HKCR\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" /v "System.IsPinnedToNameSpaceTree" /d "0" /t REG_DWORD /f
reg add "HKCR\Wow6432Node\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" /v "System.IsPinnedToNameSpaceTree" /d "0" /t REG_DWORD /f
reg delete "HKCU\Environment" /v "OneDrive" /f 2>nul
echo OneDrive uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Edge
cls
reg add "HKLM\SOFTWARE\Microsoft\EdgeUpdate" /v "DoNotUpdateToEdgeWithChromium" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\WOW6432Node\Microsoft\EdgeUpdateDev" /v "AllowUninstall" /t REG_DWORD /d "1" /f
schtasks /Change /TN "MicrosoftEdgeUpdateTaskMachineCore" /Disable
schtasks /Change /TN "MicrosoftEdgeUpdateTaskMachineUA" /Disable
echo Killing Microsoft Edge...
taskkill /F /IM msedge.exe
cd /d "%ProgramFiles(x86)%\Microsoft"
for /f "tokens=1 delims=\" %%i in ('dir /B /A:D "%ProgramFiles(x86)%\Microsoft\Edge\Application" ^| find "."') do (set "edge_chromium_package_version=%%i")
if defined edge_chromium_package_version (
		echo Removing %edge_chromium_package_version%...
		Edge\Application\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeCore\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeUpdate\MicrosoftEdgeUpdate.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeWebView\Application\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		PowerShell -C "Get-AppxPackage 'Microsoft.MicrosoftEdge.Stable' | Remove-AppxPackage"
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftEdge.Stable*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
	) else (
		echo Microsoft Edge [Chromium] not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Internet-Browser-Package" ^| findstr "~~"') do (set "edge_legacy_package_version=%%i")
if defined edge_legacy_package_version (
		echo Removing %edge_legacy_package_version%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%edge_legacy_package_version%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%edge_legacy_package_version%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%edge_legacy_package_version% /NoRestart
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -C "Get-AppxPackage *edge* | Remove-AppxPackage"
	) else (
		echo Microsoft Edge [Legacy/UWP] not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Edge" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.MicrosoftEdge_8wekyb3d8bbwe" /q /s
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
del "%HOMEPATH%\Desktop\Microsoft Edge.lnk" /s /f /q
echo Edge uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:3DBuilder
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.3DBuilder' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.3DBuilder*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
echo 3DBuilder uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:3DViewer
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Microsoft3DViewer' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Microsoft3DViewer*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
echo 3DViewer uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:MSNNews
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.BingNews' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.BingNews*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo MSN News uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:MSNWeather
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.BingWeather' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.BingWeather*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo MSN Weather uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:HEIF
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.HEIFImageExtension' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.HEIFImageExtension*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo HEIF Video Extension uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:VP9
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VP9VideoExtensions' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VP9VideoExtensions*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VP9 Video Extension uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Web
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WebMediaExtensions' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WebMediaExtensions*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Web Video Extension uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Webp
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WebpImageExtension' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WebpImageExtension*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Webp Video Extension uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:MyOffice
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftOfficeHub' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftOfficeHub*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping > nul 2>&1
) else (
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
)
echo My Office uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:OneNote
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Office.OneNote' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Office.OneNote*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo OneNote uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Groove
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ZuneMusic' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ZuneMusic*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Groove Music uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Movies
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ZuneVideo' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ZuneVideo*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Movies and TV uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Phone
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.YourPhone' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.YourPhone*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"mobile-devices;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!mobile-devices;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Your Phone uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Connector
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Appconnector' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Appconnector*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo App Connector uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Cortana
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.549981C3F5F10' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.549981C3F5F10*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCloudSearch /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortanaAboveLock /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowSearchToUseLocation /t REG_DWORD /d 0 /f
echo Cortana uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:AppInstaller
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.DesktopAppInstaller' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.DesktopAppInstaller*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg add "HKCR\.msixbundle" /ve /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle" /v "FriendlyTypeName" /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msixbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.appxbundle" /ve /t REG_SZ /d "AppX Bundle" /f
reg add "HKCR\.appxbundle" /v "FriendlyTypeName" /t REG_SZ /d "AppX Bundle" /f
reg add "HKCR\.appxbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.appxbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.cab" /ve /t REG_SZ /d "Cab File" /f
reg add "HKCR\.cab" /v "FriendlyTypeName" /t REG_SZ /d "Cab File" /f
reg add "HKCR\.cab\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.cab\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.appx" /ve /t REG_SZ /d "AppX Package" /f
reg add "HKCR\.appx" /v "FriendlyTypeName" /t REG_SZ /d "AppX Package" /f
reg add "HKCR\.appx\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.appx\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.eappxbundle" /ve /t REG_SZ /d "eAppX Bundle" /f
reg add "HKCR\.eappxbundle" /v "FriendlyTypeName" /t REG_SZ /d "eAppX Bundle" /f
reg add "HKCR\.eappxbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.eappxbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.msix" /ve /t REG_SZ /d "MsiX Package" /f
reg add "HKCR\.msix" /v "FriendlyTypeName" /t REG_SZ /d "MsiX Package" /f
reg add "HKCR\.msix\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msix\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.msixbundle" /ve /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle" /v "FriendlyTypeName" /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msixbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
echo AppInstaller uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:GetHelp
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GetHelp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GetHelp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Get Help uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Tips
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Getstarted' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Getstarted*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Tips Windows uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Messaging
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Messaging' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Messaging*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Messaging uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Mixed
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MixedReality.Portal' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MixedReality.Portal*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mixed uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:FeedbackHub
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsFeedbackHub' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsFeedbackHub*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Feedback Hub uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:AlarmsClock
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsAlarms' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAlarms*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Alarms and Clock uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:WCamera
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsCamera' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsCamera*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Windows Camera uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:Paint3D
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MSPaint' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MSPaint*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.3mf\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.bmp\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.fbx\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.gif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.glb\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.jfif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpg\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.obj\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.ply\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.png\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.stl\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.tif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.tiff\Shell\3D Edit" /f
echo Paint 3D uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:WMaps
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsMaps' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsMaps*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
schtasks /delete /TN "Microsoft\Windows\Maps\MapsToastTask" /f
schtasks /delete /TN "Microsoft\Windows\Maps\MapsUpdateTask" /f
schtasks /delete /TN "Microsoft\Windows\Maps" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"maps;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!maps;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Windows Maps uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:OtherPreinstalled
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ShazamEntertainmentLtd.Shazam' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ShazamEntertainmentLtd.Shazam*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Flipboard.Flipboard' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Flipboard.Flipboard*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '9E2F88E3.Twitter' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*9E2F88E3.Twitter*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ClearChannelRadioDigital.iHeartRadio' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ClearChannelRadioDigital.iHeartRadio*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'D5EA27B7.Duolingo-LearnLanguagesforFree' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*D5EA27B7.Duolingo-LearnLanguagesforFree*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'AdobeSystemIncorporated.AdobePhotoshop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AdobeSystemIncorporated.AdobePhotoshop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'PandoraMediaInc.29680B314EFC2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*PandoraMediaInc.29680B314EFC2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '46928bounde.EclipseManager' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*46928bounde.EclipseManager*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ActiproSoftwareLLC.562882FEEB491' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ActiproSoftwareLLC.562882FEEB491*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NetworkSpeedTest' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NetworkSpeedTest*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *QuickAssist* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*QuickAssist*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Disney.37853FC22B2CE' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Disney.37853FC22B2CE*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '4DF9E0F8.Netflix' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*4DF9E0F8.Netflix*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '7EE7776C.LinkedInforWindows' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*7EE7776C.LinkedInforWindows*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *DolbyLaboratories* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*DolbyLaboratories*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'king.com.*' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*king.com.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Office.Sway' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Office.Sway*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *AutodeskSketchBook* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AutodeskSketchBook*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Facebook.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Facebook.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *5319275A.WhatsAppDesktop* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*5319275A.WhatsAppDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *SpotifyAB.SpotifyMusic* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SpotifyAB.SpotifyMusic*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *RealtekAudioControl* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*RealtekAudioControl*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage SonicWALL* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SonicWALL*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Other Pre-installed uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:MPeople
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.People' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.People*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft People uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:MPay
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Wallet' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Wallet*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Pay uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual

:removeallhere1
cls
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneDrive-Setup-Package" ^| findstr "~~"') do (set "OneDrive_Setup=%%i")
if defined OneDrive_Setup (
		echo Removing %OneDrive_Setup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%OneDrive_Setup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /f
	) else (
		echo OneDrive Setup not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OneDrive-Setup-WOW64-Package" ^| findstr "~~"') do (set "OneDrive_Setup=%%i")
if defined OneDrive_Setup (
		echo Removing %OneDrive_Setup%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%OneDrive_Setup% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%OneDrive_Setup%" /f
	) else (
		echo OneDrive Setup not found, skipping.
	)
reg delete "HKEY_USERS\S-1-5-19\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDriveSetup" /f
reg delete "HKEY_USERS\S-1-5-20\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDriveSetup" /f
tasklist /fi "ImageName eq OneDrive.exe" /fo csv 2>NUL | find /i "OneDrive.exe">NUL && (
    taskkill /f /im OneDrive.exe
)
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "OneDrive" /f 2>nul
cd /d "%HOMEPATH%\AppData\Local\Microsoft"
for /f "tokens=1 delims=\" %%i in ('dir /B /A:D "%HOMEPATH%\AppData\Local\Microsoft\OneDrive" ^| find "."') do (set "onedrive_package_version=%%i")
if defined onedrive_package_version (
		echo Removing %onedrive_package_version%...
		OneDrive\%onedrive_package_version%\OneDriveSetup.exe /uninstall
	) else (
		echo Failed to uninstall, uninstaller could not be found.
	)
if exist "%UserProfile%\OneDrive" (
    rd "%UserProfile%\OneDrive" /q /s
)
if exist "%LocalAppData%\Microsoft\OneDrive" (
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%LocalAppData%\Microsoft\OneDrive" /q /s
)
if exist "%ProgramData%\Microsoft OneDrive" (
    rd "%ProgramData%\Microsoft OneDrive" /q /s
)
if exist "%SystemDrive%\OneDriveTemp" (
    rd "%SystemDrive%\OneDriveTemp" /q /s
)
if exist "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Microsoft OneDrive.lnk" (
    del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Microsoft OneDrive.lnk" /s /f /q
)
if exist "%APPDATA%\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
if exist "%USERPROFILE%\Links\OneDrive.lnk" (
    del "%USERPROFILE%\Links\OneDrive.lnk" /s /f /q
)
if exist "%SystemDrive%\Windows\ServiceProfiles\LocalService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%SystemDrive%\Windows\ServiceProfiles\LocalService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
if exist "%SystemDrive%\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" (
    del "%SystemDrive%\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" /s /f /q
)
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /t REG_DWORD /v "DisableFileSyncNGSC" /d 1 /f
reg add "HKCR\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" /v "System.IsPinnedToNameSpaceTree" /d "0" /t REG_DWORD /f
reg add "HKCR\Wow6432Node\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" /v "System.IsPinnedToNameSpaceTree" /d "0" /t REG_DWORD /f
reg delete "HKCU\Environment" /v "OneDrive" /f 2>nul
echo OneDrive uninstalled
reg add "HKLM\SOFTWARE\Microsoft\EdgeUpdate" /v "DoNotUpdateToEdgeWithChromium" /t REG_DWORD /d "1" /f
reg add "HKLM\SOFTWARE\WOW6432Node\Microsoft\EdgeUpdateDev" /v "AllowUninstall" /t REG_DWORD /d "1" /f
schtasks /Change /TN "MicrosoftEdgeUpdateTaskMachineCore" /Disable
schtasks /Change /TN "MicrosoftEdgeUpdateTaskMachineUA" /Disable
echo Killing Microsoft Edge...
taskkill /F /IM msedge.exe
cd /d "%ProgramFiles(x86)%\Microsoft"
for /f "tokens=1 delims=\" %%i in ('dir /B /A:D "%ProgramFiles(x86)%\Microsoft\Edge\Application" ^| find "."') do (set "edge_chromium_package_version=%%i")
if defined edge_chromium_package_version (
		echo Removing %edge_chromium_package_version%...
		Edge\Application\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeCore\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeUpdate\MicrosoftEdgeUpdate.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		EdgeWebView\Application\%edge_chromium_package_version%\Installer\setup.exe --uninstall --force-uninstall --msedge --system-level --verbose-logging
		PowerShell -C "Get-AppxPackage 'Microsoft.MicrosoftEdge.Stable' | Remove-AppxPackage"
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftEdge.Stable*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
	) else (
		echo Microsoft Edge [Chromium] not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-Internet-Browser-Package" ^| findstr "~~"') do (set "edge_legacy_package_version=%%i")
if defined edge_legacy_package_version (
		echo Removing %edge_legacy_package_version%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%edge_legacy_package_version%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%edge_legacy_package_version%\Owners" /va /f
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c dism /online /Remove-Package /PackageName:%edge_legacy_package_version% /NoRestart
		call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -C "Get-AppxPackage *edge* | Remove-AppxPackage"
	) else (
		echo Microsoft Edge [Legacy/UWP] not found, skipping.
	)
reg delete "HKLM\SOFTWARE\Policies\Microsoft\Edge" /f
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c rd "%windir%\SystemApps\Microsoft.MicrosoftEdge_8wekyb3d8bbwe" /q /s
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\EdgeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\EdgeUpdate" /f
del "%HOMEPATH%\Desktop\Microsoft Edge.lnk" /s /f /q
echo Edge uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.3DBuilder' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.3DBuilder*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
echo 3DBuilder uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Microsoft3DViewer' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Microsoft3DViewer*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
reg delete "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}" /f
echo 3DViewer uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.BingNews' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.BingNews*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo MSN News uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.BingWeather' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.BingWeather*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo MSN Weather
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.HEIFImageExtension' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.HEIFImageExtension*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo HEIF Video Extension uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VP9VideoExtensions' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VP9VideoExtensions*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VP9 Video Extension uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WebMediaExtensions' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WebMediaExtensions*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Web Video Extension uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftOfficeHub' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftOfficeHub*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping > nul 2>&1
) else (
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\MACUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\MACUpdate" /f
)
echo My Office uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Office.OneNote' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Office.OneNote*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo OneNote uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.YourPhone' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.YourPhone*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"mobile-devices;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!mobile-devices;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Your Phone uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Appconnector' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Appconnector*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo App Connector uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.549981C3F5F10' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.549981C3F5F10*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCloudSearch /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowCortanaAboveLock /t REG_DWORD /d 0 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search" /v AllowSearchToUseLocation /t REG_DWORD /d 0 /f
echo Cortana uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GetHelp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GetHelp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Get Help uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Getstarted' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Getstarted*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Tips Windows uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Messaging' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Messaging*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Messaging uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MixedReality.Portal' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MixedReality.Portal*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mixed uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsFeedbackHub' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsFeedbackHub*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Feedback Hub uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsAlarms' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAlarms*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Alarms and Clock uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsCamera' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsCamera*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Windows Camera uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MSPaint' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MSPaint*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.3mf\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.bmp\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.fbx\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.gif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.glb\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.jfif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpg\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.obj\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.ply\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.png\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.stl\Shell" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.tif\Shell\3D Edit" /f
reg delete "HKLM\SOFTWARE\Classes\SystemFileAssociations\.tiff\Shell\3D Edit" /f
echo Paint 3D uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsMaps' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsMaps*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
schtasks /delete /TN "Microsoft\Windows\Maps\MapsToastTask" /f
schtasks /delete /TN "Microsoft\Windows\Maps\MapsUpdateTask" /f
schtasks /delete /TN "Microsoft\Windows\Maps" /f
set "regKey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
reg query "%regKey%" /v "SettingsPageVisibility" >nul
if %errorlevel% equ 1 (
    reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "hide:" /f
)
for /f "tokens=2,*" %%A in ('reg query "%regKey%" /v "SettingsPageVisibility"') do set "currentValue=%%B"
echo !currentValue! | findstr /c:"maps;" > nul
if %errorlevel% neq 0 (
    set "currentValue=!currentValue!maps;"
)
reg add "%regKey%" /v "SettingsPageVisibility" /t REG_SZ /d "!currentValue!" /f
echo Windows Maps uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ShazamEntertainmentLtd.Shazam' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ShazamEntertainmentLtd.Shazam*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Flipboard.Flipboard' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Flipboard.Flipboard*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '9E2F88E3.Twitter' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*9E2F88E3.Twitter*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ClearChannelRadioDigital.iHeartRadio' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ClearChannelRadioDigital.iHeartRadio*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'D5EA27B7.Duolingo-LearnLanguagesforFree' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*D5EA27B7.Duolingo-LearnLanguagesforFree*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'AdobeSystemIncorporated.AdobePhotoshop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AdobeSystemIncorporated.AdobePhotoshop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'PandoraMediaInc.29680B314EFC2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*PandoraMediaInc.29680B314EFC2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '46928bounde.EclipseManager' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*46928bounde.EclipseManager*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'ActiproSoftwareLLC.562882FEEB491' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ActiproSoftwareLLC.562882FEEB491*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NetworkSpeedTest' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NetworkSpeedTest*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *QuickAssist* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*QuickAssist*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Disney.37853FC22B2CE' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Disney.37853FC22B2CE*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '4DF9E0F8.Netflix' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*4DF9E0F8.Netflix*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage '7EE7776C.LinkedInforWindows' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*7EE7776C.LinkedInforWindows*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *DolbyLaboratories* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*DolbyLaboratories*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'king.com.*' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*king.com.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Office.Sway' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Office.Sway*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *AutodeskSketchBook* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AutodeskSketchBook*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Facebook.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Facebook.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *5319275A.WhatsAppDesktop* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*5319275A.WhatsAppDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *SpotifyAB.SpotifyMusic* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SpotifyAB.SpotifyMusic*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *RealtekAudioControl* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*RealtekAudioControl*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage SonicWALL* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SonicWALL*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Other Pre-installed uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.People' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.People*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft People uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Wallet' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Wallet*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Pay uninstalled
Pause > Nul
goto DebloatManual

:removeallhereblue2
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ZuneMusic' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ZuneMusic*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Groove Music uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ZuneVideo' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ZuneVideo*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Movies and TV uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.DesktopAppInstaller' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.DesktopAppInstaller*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg add "HKCR\.msixbundle" /ve /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle" /v "FriendlyTypeName" /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msixbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.appxbundle" /ve /t REG_SZ /d "AppX Bundle" /f
reg add "HKCR\.appxbundle" /v "FriendlyTypeName" /t REG_SZ /d "AppX Bundle" /f
reg add "HKCR\.appxbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.appxbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.cab" /ve /t REG_SZ /d "Cab File" /f
reg add "HKCR\.cab" /v "FriendlyTypeName" /t REG_SZ /d "Cab File" /f
reg add "HKCR\.cab\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.cab\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.appx" /ve /t REG_SZ /d "AppX Package" /f
reg add "HKCR\.appx" /v "FriendlyTypeName" /t REG_SZ /d "AppX Package" /f
reg add "HKCR\.appx\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.appx\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.eappxbundle" /ve /t REG_SZ /d "eAppX Bundle" /f
reg add "HKCR\.eappxbundle" /v "FriendlyTypeName" /t REG_SZ /d "eAppX Bundle" /f
reg add "HKCR\.eappxbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.eappxbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.msix" /ve /t REG_SZ /d "MsiX Package" /f
reg add "HKCR\.msix" /v "FriendlyTypeName" /t REG_SZ /d "MsiX Package" /f
reg add "HKCR\.msix\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msix\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
reg add "HKCR\.msixbundle" /ve /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle" /v "FriendlyTypeName" /t REG_SZ /d "Msix Bundle" /f
reg add "HKCR\.msixbundle\DefaultIcon" /ve /t REG_SZ /d "shell32.dll,245" /f
reg add "HKCR\.msixbundle\shell\Install Package\command" /ve /t REG_SZ /d "cmd /c echo Installing %%1 & echo. & powershell -NoProfile \"Add-AppPackage -path '%%1'\" & pause" /f
echo AppInstaller uninstalled
Pause > Nul
goto DebloatManual

:DebloatManual2
cls
echo                      [Store Apps]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo %green%                       [Recommanded]
echo  [1] Snip And Sketch                     [16] Microsoft Teams [Windows 11]
echo  [2] Mobile Plans                        [17] Clipchamp [Windows 11]
echo  [3] Solitaire Collection                [18] Widgets [Windows 11]
echo  [4] Sticky Notes                        [19] Terminal [Windows 11]
echo  [5] Mail and Calendar                   [20] Dev Home [Windows 11]
echo %blue% [6] Windows Calculator%green%                  [21] Microsoft Family [Windows 11]
echo %blue% [7] Microsoft Photos%green%                    [22] Outlook [Windows 11]
echo  [8] Skype                               [23] Power Automate [Windows 11]
echo  [9] Windows Voice Recorder              [24] Quick Assist [Windows 11]
echo  [10] Microsoft Advertising              [25] WindowsAppRuntime [Windows 11]
echo  [11] Remote Desktop                     %blue%[26] Notepad [Windows 11, Revert old]%green%
echo  [12] Microsoft To Do                    %blue%[27] Paint [Windows 11, Revert old]%green%
echo  [13] Old Xbox app (not needed)          [28] Remove all here green
echo  [14] Xbox Game Bar Plugin (not needed)  %blue%[29] Remove all here blue%green%
echo  [15] Xbox Speech To Text Overlay (not needed)
echo. %reset%
echo        [A = left] [Page 2 of 3] [D = right]
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto Snip
if /i %input% == 2 goto MobilePlans
if /i %input% == 3 goto Solitaire
if /i %input% == 4 goto Sticky
if /i %input% == 5 goto MailandCalendar
if /i %input% == 6 goto WCalc
if /i %input% == 7 goto MPhotos
if /i %input% == 8 goto Skype
if /i %input% == 9 goto VoiceRecorder
if /i %input% == 10 goto Advertising
if /i %input% == 11 goto RemoteDekstop
if /i %input% == 12 goto MsToDo
if /i %input% == 13 goto xboxapp
if /i %input% == 14 goto xboxplugin
if /i %input% == 15 goto xboxspeech
if /i %input% == 16 goto MsTeams
if /i %input% == 17 goto Clipchamp
if /i %input% == 18 goto WidgetsW
if /i %input% == 19 goto TerminalW
if /i %input% == 20 goto DevHome
if /i %input% == 21 goto MFamily
if /i %input% == 22 goto Outlook
if /i %input% == 23 goto PowerAutomate
if /i %input% == 24 goto QuickAssist
if /i %input% == 25 goto AppRuntime
if /i %input% == 26 goto Notepad
if /i %input% == 27 goto Paint
if /i %input% == 28 goto removeallhere2
if /i %input% == 29 goto removeallhereblue
if /i %input% == A cls & goto DebloatManual
if /i %input% == D cls & goto DebloatManual3
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatManual2

:Snip
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ScreenSketch' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ScreenSketch*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Snip and Sketch uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:MobilePlans
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.OneConnect' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.OneConnect*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mobile Plans uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:Solitaire
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftSolitaireCollection' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftSolitaireCollection*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Solitaire Collection uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:Sticky
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftStickyNotes' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftStickyNotes*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Sticky Notes uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:MailandCalendar
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'microsoft.windowscommunicationsapps' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*microsoft.windowscommunicationsapps*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mail and Calendar uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:WCalc
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsCalculator' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsCalculator*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Windows Calculator uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:MPhotos
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Windows.Photos' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Windows.Photos*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Photos uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:Skype
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.SkypeApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SkypeApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Skype uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:VoiceRecorder
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsSoundRecorder' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsSoundRecorder*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Voice Recorder uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:Advertising
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Advertising.Xaml' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Advertising.Xaml*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Advertising App uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:RemoteDekstop
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.RemoteDesktop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.RemoteDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Remote Desktop App uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:MsToDo
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Todos' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Todos*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft To Do App uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:xboxapp
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Xbox App uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:xboxplugin
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxGameOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxGameOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxGameOverlay uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:xboxspeech
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxSpeechToTextOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxSpeechToTextOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxSpeechToTextOverlay uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual2

:MsTeams
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat" /v "ChatIcon" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v "ConfigureChatAutoInstall" /t REG_DWORD /d "0" /f
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftTeams* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftTeams*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Teams uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:Clipchamp
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *Clipchamp* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Clipchamp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Clipchamp uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:WidgetsW
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftWindows.Client.WebExperience | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftWindows.Client.WebExperience*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Widgets uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:TerminalW
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsTerminal | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsTerminal*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Terminal uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:DevHome
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.Windows.DevHome | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Windows.DevHome*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
echo DevHome uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:MFamily
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftCorporationII.MicrosoftFamily | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftCorporationII.MicrosoftFamily*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Family uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:Outlook
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OutlookPWA" ^| findstr "~~"') do (set "Outlook=%%i")
if defined Outlook (
		echo Removing %Outlook%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Outlook% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /f
	) else (
		echo Outlook not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OutlookPWA" ^| findstr "~~"') do (set "Outlook=%%i")
if defined Outlook (
		echo Removing %Outlook%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Outlook% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /f
	) else (
		echo Outlook not found, skipping.
	)
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.OutlookForWindows | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.OutlookForWindows*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
echo Outlook uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:PowerAutomate
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.PowerAutomateDesktop | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.PowerAutomateDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Power Automate uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:QuickAssist
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftCorporationII.QuickAssist | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftCorporationII.QuickAssist*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Quick Assist uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:AppRuntime
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.2 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.3 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.4 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo WindowsAppRuntime uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:Notepad
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsNotepad | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsNotepad*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKCR\Applications\notepad.exe" /v "NoOpenWith" /f
reg add "HKCR\Applications\notepad.exe" /f
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\App Paths\notepad.exe" /f
reg add "HKCR\txtfilelegacy\DefaultIcon" /ve /t REG_SZ /d "imageres.dll,-102" /f
reg add "HKCR\txtfilelegacy\shell\open\command" /ve /t REG_SZ /d "C:\Windows\System32\notepad.exe \"%%1\"" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe" /v "UseFilter" /t REG_DWORD /d "0" /f
echo Notepad uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:Paint
cls
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.Paint | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Paint*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Paint\mspaint.exe" "%windir%\System32"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E cmd /c move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Paint\en-US\mspaint.exe.mui" "%windir%\System32\en-US"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Paint\Paint.lnk" "%ProgramData%\Microsoft\Windows\Start Menu\Programs\Accessories"
echo Paint uninstalled
)
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatManual2

:removeallhere2
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.ScreenSketch' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.ScreenSketch*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Snip and Sketch uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.OneConnect' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.OneConnect*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mobile Plans uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftSolitaireCollection' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftSolitaireCollection*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Solitaire Collection uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.MicrosoftStickyNotes' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.MicrosoftStickyNotes*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Sticky Notes uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'microsoft.windowscommunicationsapps' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*microsoft.windowscommunicationsapps*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Mail and Calendar uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.SkypeApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.SkypeApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Skype uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsSoundRecorder' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsSoundRecorder*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Voice Recorder uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Advertising.Xaml' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Advertising.Xaml*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Advertising App uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.RemoteDesktop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.RemoteDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Remote Desktop App uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Todos' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Todos*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft To Do App uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Xbox App uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxGameOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxGameOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxGameOverlay uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxSpeechToTextOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxSpeechToTextOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxSpeechToTextOverlay uninstalled
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat" /v "ChatIcon" /t REG_DWORD /d "3" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v "ConfigureChatAutoInstall" /t REG_DWORD /d "0" /f
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftTeams* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftTeams*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Teams uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *Clipchamp* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Clipchamp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Clipchamp uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftWindows.Client.WebExperience | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftWindows.Client.WebExperience*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Widgets uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsTerminal | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsTerminal*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Terminal uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.Windows.DevHome | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Windows.DevHome*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\DevHomeUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f
echo DevHome uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftCorporationII.MicrosoftFamily | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftCorporationII.MicrosoftFamily*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Family uninstalled
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OutlookPWA" ^| findstr "~~"') do (set "Outlook=%%i")
if defined Outlook (
		echo Removing %Outlook%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Outlook% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /f
	) else (
		echo Outlook not found, skipping.
	)
for /f "tokens=8 delims=\" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages" ^| findstr "Microsoft-Windows-OutlookPWA" ^| findstr "~~"') do (set "Outlook=%%i")
if defined Outlook (
		echo Removing %Outlook%...
		reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /v Visibility /t REG_DWORD /d 1 /f
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%\Owners" /va /f
		dism /online /Remove-Package /PackageName:%Outlook% /NoRestart
		reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\Packages\%Outlook%" /f
	) else (
		echo Outlook not found, skipping.
	)
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.OutlookForWindows | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.OutlookForWindows*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator\UScheduler\OutlookUpdate" /f
reg delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f
echo Outlook uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.PowerAutomateDesktop | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.PowerAutomateDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Power Automate uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MicrosoftCorporationII.QuickAssist | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MicrosoftCorporationII.QuickAssist*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Quick Assist uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.2 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.3 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsAppRuntime.1.4 | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsAppRuntime.1.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo WindowsAppRuntime uninstalled
)
Pause > Nul
goto DebloatManual3

:removeallhereblue
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsCalculator' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsCalculator*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Windows Calculator uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Windows.Photos' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Windows.Photos*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Photos uninstalled
for /f "tokens=3" %%A in ('reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion" /v "CurrentBuild" 2^>nul ^| findstr "REG_SZ"') do (
    set "build=%%A"
)
set /a build_num=!build!
if !build_num! LSS 22000 (
echo its not windows 11, skipping
) else (
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.WindowsNotepad | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsNotepad*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
reg delete "HKCR\Applications\notepad.exe" /v "NoOpenWith" /f
reg add "HKCR\Applications\notepad.exe" /f
reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\App Paths\notepad.exe" /f
reg add "HKCR\txtfilelegacy\DefaultIcon" /ve /t REG_SZ /d "imageres.dll,-102" /f
reg add "HKCR\txtfilelegacy\shell\open\command" /ve /t REG_SZ /d "C:\Windows\System32\notepad.exe \"%%1\"" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe" /v "UseFilter" /t REG_DWORD /d "0" /f
echo Notepad uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.Paint | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Paint*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Paint uninstalled
)
Pause > Nul
goto DebloatManual3

:DebloatManual3
cls
echo                      [Store Apps]
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo %red%                     [Not Recommanded]
echo [1] gaming app                             [12] UI.Xaml.2.3
echo [2] gaming services                        [13] UI.Xaml.2.4
echo [3] NET.Native.Framework.1.3               [14] UI.Xaml.2.4
echo [4] NET.Native.Framework.1.7               [15] UI.Xaml.2.7
echo [5] NET.Native.Framework.2.2               [16] UI.Xaml.2.8
echo [6] NET.Native.Runtime.1.4                 [17] VCLibs.140.00.UWPDesktop
echo [7] NET.Native.Runtime.1.7                 [18] VCLibs.140.00
echo [8] NET.Native.Runtime.2.2                 [19] Microsoft Store
echo [9] Store Purchase                         [20] Xbox TCUI [Live in-game experience]
echo [10] UI.Xaml.2.0                           [21] Xbox Game Bar
echo [11] UI.Xaml.2.1                           [22] Xbox Identity Provider
echo                                            [23] Remove all here%reset%
echo        [A = left] [Page 3 of 3]
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto gamingapp
if /i %input% == 2 goto gamingservices
if /i %input% == 3 goto netframework13
if /i %input% == 4 goto netframework17
if /i %input% == 5 goto netframework22
if /i %input% == 6 goto netruntime14
if /i %input% == 7 goto netruntime17
if /i %input% == 8 goto netruntime22
if /i %input% == 9 goto storepurchase
if /i %input% == 10 goto xaml20
if /i %input% == 11 goto xaml21
if /i %input% == 12 goto xaml23
if /i %input% == 13 goto xaml24
if /i %input% == 14 goto xaml27
if /i %input% == 15 goto xaml28
if /i %input% == 16 goto vclibsuwpdesktop
if /i %input% == 17 goto vclibs
if /i %input% == 18 goto msstore
if /i %input% == 19 goto xboxtcui
if /i %input% == 20 goto xgamebar
if /i %input% == 21 goto xidentity
if /i %input% == 22 goto removeallhere3
if /i %input% == A cls & goto DebloatManual2
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatManual3

:gamingapp
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GamingApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GamingApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Gaming app uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:gamingservices
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GamingServices' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GamingServices*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Gaming Services uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netframework13
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.1.3' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.1.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.1.3 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netframework17
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.1.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.1.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.1.7 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netframework22
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.2.2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.2.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.2.2 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netruntime14
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.1.4' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.1.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.1.4 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netruntime17
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.1.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.1.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.1.7 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:netruntime22
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.2.2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.2.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.2.2 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:StorePucharse
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.StorePurchaseApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.StorePurchaseApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Store Pucharse uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml20
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.0' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.0*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.0 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml21
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.1' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.1*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.1 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml23
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.3' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.3 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml24
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.4' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.4 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml27
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.7 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xaml28
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.8' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.8*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.8 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:vclibsuwpdesktop
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VCLibs.140.00.UWPDesktop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VCLibs.140.00.UWPDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VCLibs.140.00.UWPDesktop uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:vclibs
cls
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VCLibs.140.00' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VCLibs.140.00*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VCLibs.140.00 uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:MsStore
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsStore' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsStore*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Store uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xboxtcui
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Xbox.TCUI' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Xbox.TCUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Xbox TCUI uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xgamebar
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxGamingOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxGamingOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxGamingOverlay uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:xidentity
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxIdentityProvider' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxIdentityProvider*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxIdentityProvider uninstalled Press enter to go to Debloat Menu.
Pause > Nul
goto DebloatManual3

:removeallhere3
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GamingApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GamingApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Gaming app uninstalled
owerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.GamingServices' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.GamingServices*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Gaming Services uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.1.3' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.1.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.1.3 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.1.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.1.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.1.7 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Framework.2.2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Framework.2.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Framework.2.2
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.1.4' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.1.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.1.4 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.1.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.1.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.1.7 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.NET.Native.Runtime.2.2' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.NET.Native.Runtime.2.2*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo NET.Native.Runtime.2.2 uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.StorePurchaseApp' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.StorePurchaseApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Store Pucharse uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.0' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.0*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.0 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.1' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.1*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.1 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.3' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.3*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.3 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.4' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.4*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.4 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.7' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.7*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.7 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.UI.Xaml.2.8' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.UI.Xaml.2.8*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo UI.Xaml.2.8 uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VCLibs.140.00.UWPDesktop' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VCLibs.140.00.UWPDesktop*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VCLibs.140.00.UWPDesktop uninstalled
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.VCLibs.140.00' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.VCLibs.140.00*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo VCLibs.140.00 uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.WindowsStore' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.WindowsStore*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Microsoft Store uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.Xbox.TCUI' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Xbox.TCUI*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo Xbox TCUI uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxGamingOverlay' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxGamingOverlay*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxGamingOverlay uninstalled
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 'Microsoft.XboxIdentityProvider' | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.XboxIdentityProvider*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
echo XboxIdentityProvider uninstalled
Pause > Nul
goto DebloatManual3

:DebloatOEM
cls
echo.
echo.
echo  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ•—
echo  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘
echo  â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘
echo  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â•šâ•â•â–‘â–ˆâ–ˆâ•‘
echo  â–‘â•šâ•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [1] DELL
echo [2] HP
echo [3] Lenovo
echo [4] ASUS
echo [5] VAIO (SONY)
echo [6] SAMSUNG
echo [7] LG
echo [8] Acer
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i %input% == 1 goto DELLOEM
if /i %input% == 2 goto HPOEM
if /i %input% == 3 goto LenovoOEM
if /i %input% == 4 goto ASUSOEM
if /i %input% == 5 goto VAIOOEM
if /i %input% == 6 goto SAMSUNGOEM
if /i %input% == 7 goto LGOEM
if /i %input% == 8 goto AcerOEM
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto DebloatOEM

:DELLOEM
cls
sc config cplspcon start= disabled
sc config ihi_service start= disabled
sc config igccservice start= disabled
sc config LMS start= disabled
sc config WMIRegistrationService start= disabled
sc config DSAService start= disabled
sc config DSAUpdateService start= disabled
sc config ESRV_SVC_QUEENCREEK start= disabled
sc config SystemUsageReportSvc_QUEENCREEK start= disabled
sc config USER_ESRV_SVC_QUEENCREEK start= disabled
sc config "Intel(R) SUR QC SAM" start= disabled
sc config XTU3Service start= demand
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage RivetNetworks.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*RivetNetworks.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AdobeNotificationClient | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AdobeNotificationClient*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage MSWP.DellTypeCStatus | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*MSWP.DellTypeCStatus*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage ScreenovateTechnologies.DellMobileConnect | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ScreenovateTechnologies.DellMobileConnect*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage STMicroelectronicsMEMS.DellFreeFallDataProtection | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*STMicroelectronicsMEMS.DellFreeFallDataProtection*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage DellInc.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*DellInc.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage DB6EA5DB.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*DB6EA5DB.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage SynapticsIncorporated* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SynapticsIncorporated*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *McAfee* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*McAfee*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *ExpressVPN* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ExpressVPN*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AppUp.IntelOptaneMemoryandStorageManagement | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AppUp.IntelOptaneMemoryandStorageManagement*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *McAfee* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*McAfee*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call "C:\Program Files\McAfee\WebAdvisor\uninstaller.exe" /s
rd /s /q "C:\Program Files\McAfee\WebAdvisor"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Mobile Connect Drivers" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell SupportAssist Remediation" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "SmartByte Drivers and Services" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Update - SupportAssist Update Plugin" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Update - SupportAssist" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Update - SupportAssist Remediation" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Update Optimizer Service" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Dell Digital Delivery Services" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Digital Delivery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Customer Connect' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell ControlVault' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Control Point' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Backup and Recovery Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Foundation Services' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Help and Support' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Mobile Broadband Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Mobile Broadband Utility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Mobile Connect Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Power Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Product Registration' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Stage' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Support Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell SupportAssist' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell SupportAssist Remediation' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell SupportAssistAgent' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell System Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Threat Defense' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Trusted Drive Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Client System Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell ControlPoint' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Customer Connect' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dell Embassy Suite' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Dolby Advanced Audio' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'DTS Sound' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'CyberLink Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Components' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton 360' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Internet Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Online Backup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sql Server Customer Experience Improvement Program' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Synaptics Pointing Device Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Nero 9 Essentials' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Google Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Backup and Sync from Google' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo DELL Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:HPOEM
cls
sc config HPAppHelperCap start= disabled
sc config HPTouchpointAnalyticsService start= disabled
sc config HPDiagsCap start= disabled
sc config HPNetworkCap start= disabled
sc config HPSysInfoCap start= disabled
sc config "HP Comm Recover" start= disabled
sc config cplspcon start= disabled
sc config ihi_service start= disabled
sc config igccservice start= disabled
sc config LMS start= disabled
sc config WMIRegistrationService start= disabled
sc config DSAService start= disabled
sc config DSAUpdateService start= disabled
sc config ESRV_SVC_QUEENCREEK start= disabled
sc config SystemUsageReportSvc_QUEENCREEK start= disabled
sc config USER_ESRV_SVC_QUEENCREEK start= disabled
sc config "Intel(R) SUR QC SAM" start= disabled
sc config XTU3Service start= demand
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AD2F1837.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AD2F1837.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage 0E3921EB.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*0E3921EB.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage SynapticsIncorporated* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SynapticsIncorporated*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage CyberLinkCorp* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*CyberLinkCorp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage C27EB4BA.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*C27EB4BA.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *McAfee* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*McAfee*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *ExpressVPN* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ExpressVPN*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AdobeAcrobatReaderCoreApp | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AdobeAcrobatReaderCoreApp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage Microsoft.Whiteboard | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*Microsoft.Whiteboard*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AppUp.IntelOptaneMemoryandStorageManagement | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AppUp.IntelOptaneMemoryandStorageManagement*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage RealtekSemiconductorCorp.HPAudioControl | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*RealtekSemiconductorCorp.HPAudioControl*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call "C:\Program Files\McAfee\WebAdvisor\uninstaller.exe" /s
rd /s /q "C:\Program Files\McAfee\WebAdvisor"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP MAC Address Manager" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Device Access Manager" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Documentation" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Guide" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Energy Star" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "StatusAlerts" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Support Assistant" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Print SW" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Notifications" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Pixel Sharp" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Discover HP Touchpoint Manager" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Welcome" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Registration Service" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Software Setup" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Sure Run" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Sure Recover" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Sure Click Application Support for Windows" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Sure Click" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP JumpStart Launch" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP JumpStart Bridge" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Customer Experience Enhancements" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP ESU for Microsoft Windows 10" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Connection Optimizer" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Performance Advisor" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Hotkey Support" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP System Default Settings" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Support Solutions Framework" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Wolf Security" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Wolf 2 Security" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Wolf Security Application Support for Sure Sense" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Wolf Security Application Support for Windows" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Sure Sense Installer" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "HP Battery Recall Utility" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Theft Recovery for HP ProtectTools" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP 3D DriveGuard' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP 64 Bit HP CIO Components Installer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP 32 bit HP CIO Components Installer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ActiveCheck component for HP Active Support Libary' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Active Support Library' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Advisor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Application Assistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Batery Calibration' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP BIOS Configuration Utility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Boot Optimizer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP BufferChm' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP BPDSoftware' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Client Security Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Collaboration Keyboard For Cisco UCC' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Collaboration Keyboard for Skype for Business' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Collaboration Keyboard Runtime' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Connected Remote' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Connection Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP CoolSense' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Copy' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP CUE Status' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Customer Experience Enhancements' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Customer Feedback' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Launch Box' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Deskjet Series Help' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Destinations' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Device Access Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP DeviceManagementQFolder' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Discover hp Touchpoint Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP DisplayLink Core Software and DisplayLink Graphics' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Documentation' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP DocProc' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Dropbox Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HPDiagnosticAlert' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP DisableMSDefender' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Drive Encryption for HP ProtectTools' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Easy Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP EmailSMTP Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Energy Star' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ENVY series Help' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ENVY series Aid' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ePrint SW' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ESU for Microsoft Windows' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP eSupportQFolder' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Face Recognition for HP ProtectTools' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP File Sanitizer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP FTP Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP FWUpdateEDO2' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Google Drive Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP GPBaseService2' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP InstantShare' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Insight Diagnostics Online Edition for Windows' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Launch Box' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Lights-Out Configuration Utility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP LinkUp' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Help' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP eDocs and User Guide' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP JumpStart Bridge' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP JumpStart Launch' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP PC Hardware Diagnostics UEFI' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Performance Advisor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP PhoneWise Drivers' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Photosmart Aide' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product FWUpdater' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP MAC Address Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP MediaSmart TV' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP MediaSmart SmartMenu' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP MediaSmart Netflix' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP TouchSmart Netflix' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP MyRoom' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Notifications' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HPProductAssistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product Improvement Studies' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP QuickTouch' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP QuickWeb' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SimplePass' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Spot SmartCenter Launcher' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Software Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Software Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SoftPaq Download Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Sure Click' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Sure Sense' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Sure Recover' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Sure Run' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SFTP Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SystemDiagnostics' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP System Default Settings' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP System Event Utility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP On Screen Display' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP OneDrive Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP opensource' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Orbit' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Photosmart Essential' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product Assistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product Detection' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product Documentation Launcher' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Product Improvement Study' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Power Assistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Power Data' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Power Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP ProtectTools' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Quick Launch' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Quick Start' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP QuickTransfer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Recovery Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Registration Service' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Remote Solution' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Rescue and Recovery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP RSS' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SharePoint Plugin' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SmartWebPrinting' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Smart Web Printing' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Status Alerts' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Software Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Software Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Solution Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Support Assistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Support Information' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Support Solutions Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Theft Recovery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SoftPaq Download Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Toolbox' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Total Care Advisor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP TouchSmart Browser' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP TrayApp' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Trust Circles' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP SolutionCenter' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP HP Unified IO' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP UnloadSupport' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP UserGuide' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Utility Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Wolf Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP WebReg' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Wireless Assistant' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Wireless Hotspot' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Connection Optimizer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Wolf Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Wolf 2 Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP TechPulse' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Touchpoint Analytics Client - Dependencies' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'HP Touchpoint Analytics Client' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ICS' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo HP Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:LenovoOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage LenovoCorporation* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*LenovoCorporation*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *E046963F* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*E046963F*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *E0469640* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*E0469640*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *ThinkVantage* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*ThinkVantage*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage CyberLinkCorp* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*CyberLinkCorp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *McAfee* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*McAfee*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Lenovo Patch Utility" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -ExecutionPolicy Unrestricted -C "Get-Package -Name "Lenovo System Update" | Uninstall-Package -Force -ErrorAction SilentlyContinue"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Components' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Message Center Plus' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Metric Collection SDK' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Levovo OneKey Optimizer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo OneKey Theater' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Patch Utility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Reach and REACHit' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo SimpleTap' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Solution Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo System Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo ThinkVantage Active Protection System' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo ThinkVantage Active Protection Sensor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo ThinkVantage Access Connections' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo ThinkVantage Fingerprint Software' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo ThinkVantage System Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo User Guide' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo User Manuals' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Warranty Info' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Yoga Pro Demos' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Solutions for Small Business' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo QuickOptimizer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Motion Control' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton 360' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Internet Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Online Backup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Synaptics Pointing Device Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Registration' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Lenovo PowerDVD10' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Google Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Backup and Sync from Google' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files (x86)\Lenovo\RapidBoot HDD Accelerator\Uninstall.exe" /S
call "C:\Program Files (x86)\Lenovo\SHAREit\unins000.exe" /SILENT
call "C:\Program Files\Lenovo\Communications Utility\unins000.exe" /SILENT /NORESTART
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo Lenovo Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:ASUSOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage B9ECED6F* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*B9ECED6F*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage DTSInc.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*DTSInc.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *McAfee* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*McAfee*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Dispslay Control Service' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Hello' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Refreshrate Control' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Promotion' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'XSplit Gamecaster' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Ai Charger' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AI Recovery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AI Suite II' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS App Box' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AudioWizard' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AudioCaptureNotificationConfigurator' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AURA Display Component' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS AURA Odd Component' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS CopyProtect' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Data Security Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Device Activation' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Device Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Easy Update 2 ALU Application' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS eManual' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS FaceLogon' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS FancyStart' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Fast Boot by ASUS' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS FlipLock' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Giftbox Desktop' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS HID Control Service' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS HiPost' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Instant Connect' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS InstantOn' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Key Suite' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Keyboard Lock' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS LifeFrame' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Live Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Manager - Ai Booting' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Manager - PC Cleanup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Manager - SyncUp' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Manager - Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS MB Peripheral Products' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Mouse HAL' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Music Maker' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS MX Suite MAGIX Media Suite' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS PWR Option' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Power4Gear Hybrid' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS ProductDaemonSetup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Product Demo Kit' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Product Register Program' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Asus ProfileSwitcherCleanup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Promotion' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS S Series Product Demo' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Secure Delete' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Security Protect Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Screensaver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS SoncicRadar3Setup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Splendid Video Enhancement Technology' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Tutor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS USB Charger Plus' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Video easy' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Virtual Camera' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Virtual Touch' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS VivoBook' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS WinFlash' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'CyberLink Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Components' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton 360' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Internet Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Online Backup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sql Server Customer Experience Improvement Program' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Smart Doctor' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'ASUS Smart Gesture' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Synaptics Pointing Device Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Nero 9 Essentials' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Google Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Backup and Sync from Google' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo ASUS Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:VAIOOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage VAIOCorporation.VAIO* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*VAIOCorporation.VAIO*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage BD9B8345* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*BD9B8345*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony PlayMemories Home' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony Reader for PC' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony Quick Web Access' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Care' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Content Metadata Intelligent Analyzing Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Content Metadata Intelligent Network Service Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Content Metadata Manager Settings' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO - Media Gallery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO - PMB VAIO Edition Guide' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Care Recovery' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Help and Support' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Control Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO CPU Fan Diagnostic' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Data Restore Tool' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Easy Connect' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Hardware Diagnostics' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony VAIO Media plus Opening Movie' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Sony Xperia Link' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo VAIO(SONY) Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:SAMSUNGOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage SAMSUNGELECTRONICSCO* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*SAMSUNGELECTRONICSCO*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'CyberLink Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Components' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton 360' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Internet Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Online Backup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Samsung SW Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Samsung Update' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Synaptics Pointing Device Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Google Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Backup and Sync from Google' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo SAMSUNG Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:LGOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage LGElectronics* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*LGElectronics*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage *.cyberlink.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*.cyberlink.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo LG Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:AcerOEM
cls
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage AcerIncorporated.* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*AcerIncorporated.*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -ExecutionPolicy Unrestricted -C "Get-AppxPackage CyberLinkCorp* | Remove-AppxPackage"
call NSudoLG.exe -ShowWindowMode:hide -U:T -P:E PowerShell -ExecutionPolicy Bypass -NoProfile -C "Get-ChildItem -Path 'C:\Program Files\WindowsApps' -Directory -Recurse | Where-Object { $_.Name -like '*CyberLinkCorp*' } | ForEach-Object { Remove-Item -Recurse -Force $_.FullName }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Care Center' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Collection' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Configuration Manager' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Quick Access' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer UEIP Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'App Explorer' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Theft Shield' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer abDocs' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer abFiles Shell Extension' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer abMedia' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer abPhoto' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer AOP Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Arcade Instant On' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Crystal Eye webcam' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Device Fast-lane' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer DriverSetupUtility' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Hover Access' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Instant Update Service' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Jumpstart' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Live Updater' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Portal' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Power Management' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Touch Tools' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Tour' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Product Registration' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Updater' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer User Experience Improvement Program' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer User Experience Improvement Program Framework' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer User Experience Improvement Program Service' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer System Information' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Video Player' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'CyberLink Power2Go' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Components' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Intel Management Engine Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton 360' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Internet Security' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Norton Online Backup' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Synaptics Pointing Device Driver' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Nero 9 Essentials' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Acer Registration' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Bing Bar' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Google Drive' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
PowerShell -C "Get-WmiObject Win32_Product | Where-Object { $_.Name -like 'Backup and Sync from Google' } | ForEach-Object { cmd /c "msiexec /uninstall $($_.IdentifyingNumber) /qn /norestart" }"
for %%i in (Office NvTmRep ACC Acer HP ealth novo Asus ell _Feed_ ooster UAC) do (for /f "tokens=1 delims=," %%a in ('schtasks /query /fo csv ^| findstr /v "TaskName" ^| findstr "%%~i" ^| findstr /v "Microsoft\\Windows"') do (schtasks /change /tn %%a /disable))
call "C:\Program Files\McAfee\MSC\mcuihost.exe" /body:misp://MSCJsRes.dll::uninstall.html /id:uninstall
echo Acer Bloatware Removed
echo.
echo Press enter to go to Debloat menu
Pause > Nul
goto DebloatOEM

:AppsForAudioLatency
cls
echo.
echo.
Echo   â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
Echo   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—
Echo   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘      â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•šâ–ˆâ–ˆâ•”â•      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
Echo   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
Echo   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•šâ•â•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•       â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo           Best Audio Latency Is Your New Friend [ Press 1 Or 2 ]
echo.
echo        [1] Install [ Low Audio App ]             [2] Install [ Real Github ]
echo.
echo.
Echo            Type [X] To Back First Page
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
if /i "%input%"== "1" goto NoConsole
if /i "%input%"== "2" goto REALAUDIOINSTALL
if /i "%input%"=="E" cls & goto InterfaceUpdate
if /i "%input%"=="X" cls & goto TweaksWindowsInterface

:NoConsole
cls
::Audio tweaks
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v "AllowHeadlessExecution"       /t Reg_DWORD /d "1"          /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v "AllowMultipleBackgroundTasks" /t Reg_DWORD /d "1"          /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v "InactivityTimeoutMs"          /t Reg_DWORD /d "0xFFFFFFFF" /f

:: Change Sound Communication to Do Nothing
reg add "HKEY_CURRENT_USER\Software\Microsoft\Multimedia\Audio" /v UserDuckingPreference /t Reg_DWORD /d 3 /f

:: Disable audio exclusive mode on all devices
for /f "delims=" %%a in ('reg QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Capture"') do (
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},3" /t Reg_DWORD /d 0 /f
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},4" /t Reg_DWORD /d 0 /f
)
for /f "delims=" %%a in ('reg QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render"') do (
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},3" /t Reg_DWORD /d 0 /f
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},4" /t Reg_DWORD /d 0 /f
)
cls
echo.
echo [ Starting ]
timeout /t 2 >Nul /nobreak
Start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Audio Latency\one\low_audio_latency_no_console.exe"
cls
echo.
echo Already Download And Open Automated! Press Enter To Go Back
Pause >Nul
goto AppsForAudioLatency

:REALAUDIOINSTALL
cls
::Audio tweaks
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v AllowHeadlessExecution /t Reg_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v AllowMultipleBackgroundTasks /t Reg_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\BackgroundModel\BackgroundAudioPolicy" /v InactivityTimeoutMs /t Reg_DWORD /d 0xFFFFFFFF /f

:: Change Sound Communication to Do Nothing
reg add "HKEY_CURRENT_USER\Software\Microsoft\Multimedia\Audio" /v UserDuckingPreference /t Reg_DWORD /d 3 /f

:: Disable audio exclusive mode on all devices
for /f "delims=" %%a in ('reg QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Capture"') do (
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},3" /t Reg_DWORD /d 0 /f
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},4" /t Reg_DWORD /d 0 /f
)
for /f "delims=" %%a in ('reg QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render"') do (
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},3" /t Reg_DWORD /d 0 /f
    reg add "%%a\Properties" /v "{b3f8fa53-0004-438e-9003-51a46e139bfc},4" /t Reg_DWORD /d 0 /f
)
cls
echo.
echo [ Starting ]
timeout /t 2 >Nul /nobreak
Start "" "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Audio Latency\two\REAL.exe"
move /y "C:\Windows\BerserkerUsefulToolsV1.3\Something Else\Audio Latency\two\REAL.exe" "C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"
cls
echo.
echo Already Download And Open Automated! Press Enter To Go Back
Pause >Nul
goto AppsForAudioLatency

:ToolBox
cls
echo.
echo.
echo â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
echo â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•
echo    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ•”â•
echo    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—
echo    â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—
echo    â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•
echo  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo        ^> Note [ Download Winget ] If You Want To Download These Apps
echo.
echo      [1] Soon                           [2] Visual +CC
echo.
echo      [3] DirectX                        [4] 7^-Zip
echo.
echo      [5] Discord                        [6] WinRAR
echo.
echo      [7] Notepad  - Version 8.5.6       [8] Visual Code
echo.
echo      [9] VirtualBox                     [10] Lighshot
echo.
echo.     [11] Phyton                        [12] Everything [Not added]
echo.
Echo             [ From Navegators ]
echo.
echo      [13] Edge [Not added]              [14] Google Chrome [Not added]
echo.
echo.
echo      [15] Brave                         [16] Opera GX [Not added]
echo.
echo             [ From Lauchers Music, Games ]
echo.
echo      [17] Spotify                       [18] Steam
Echo.
Echo      [19] EpicGamerLaucher              [20] Microsoft Teams
echo.
echo      [21] Malwarebytes                  [22] TeamViewer
echo.
Echo            Type [X] To Back  First [ Page About Tweaks For Windows ]
echo.
echo            Type [E] To Back From The Other Menu
echo.
echo   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
set /p input=:
=="" goto ToolBox
if /i %input% == 1 goto Idk.
if /i %input% == 2 goto Visual+CC
if /i %input% == 3 goto DirectX
if /i %input% == 4 goto Zip
if /i %input% == 5 goto Discord
if /i %input% == 6 goto WinRAR
if /i %input% == 7 goto notepad
if /i %input% == 8 goto VirtualBox
if /i %input% == 9 goto VisualCode
if /i %input% == 10 goto Lighshot
if /i %input% == 11 goto Phyton
if /i %input% == 12 goto Everything
if /i %input% == 13 goto Edge
if /i %input% == 14 goto GoogleChrome
if /i %input% == 15 goto Brave
if /i %input% == 16 goto Opera
if /i %input% == 17 goto Spotify
if /i %input% == 18 goto Steam
if /i %input% == 19 goto EpicGamerLaucher
if /i %input% == 20 goto MicrosoftTeams
if /i %input% == 21 goto Malwarebytes
if /i %input% == 22 goto TeamViewer
if /i %input% == E cls & goto InterfaceUpdate
if /i %input% == X cls & goto TweaksWindowsInterface
) ELSE (
echo Invalid Input & goto MisspellRedirect

:MisspellRedirect
cls
echo Misspell Detected
timeout 2
goto RedirectMenu


:RedirectMenu
cls
goto AoolBox



:: Tolbox Code

:Visual+CC
cls
start https://github.com/abbodi1406/vcredist/releases/download/v0.73.0/VisualCppRedist_AIO_x86_x64.exe
echo Already Download And Open! Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:DirectX
cls
start https://download.microsoft.com/download/1/7/1/1718CCC4-6315-4D8E-9543-8E28A4E18C4C/dxwebsetup.exe
echo Already Download And Open! Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Zip
cls
start https://www.7-zip.org/a/7z2301-x64.exe
echo.
echo Already Download And Open! Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Brave
cls
start ttps://laptop-updates.brave.com/download/BRV002.exe
echo.
echo Already Download And Open! Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Discord
cls
start https://discord.com/api/downloads/distributions/app/installers/latest?channel=stable&platform=win&arch=x86
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:notepad
cls
start https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.5.8/npp.8.5.8.Installer.x64.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:VirtualBox
cls
start https://download.virtualbox.org/virtualbox/7.0.12/VirtualBox-7.0.12-159484-Win.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:VisualCode
cls
start https://go.microsoft.com/fwlink/?LinkID=534107
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:Lighshot
cls
start https://app.prntscr.com/build/setup-lightshot.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Phyton
cls
https://www.python.org/ftp/python/3.12.0/python-3.12.0-amd64.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Everything
cls
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:Edge
cls
powershell Invoke-WebRequest "https://go.microsoft.com/fwlink/?linkid=2108834&Channel=Stable&language=en&brand=M100" -OutFile "%temp%\MicrosoftEdgeSetup.exe"
call "%temp%\MicrosoftEdgeSetup.exe" /silent /install
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:GoogleChrome
cls
start https://www.google.com/intl/us-419/chrome/next-steps.html?statcb=1&installdataindex=empty&defaultbrowser=0#
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:Opera
cls
start https://www.opera.com/computer/thanks?ni=stable&os=windows
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Spotify
cls
start https://download.scdn.co/SpotifySetup.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface



:Steam
cls
start https://cdn.akamai.steamstatic.com/client/installer/SteamSetup.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:EpicGamerLaucher
cls
start https://launcher-public-service-prod06.ol.epicgames.com/launcher/api/installer/download/EpicGamesLauncherInstaller.msi
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:MicrosoftTeams
cls
start https://statics.teams.cdn.office.net/production-windows/1.5.00.11002/MSTeamsSetup.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:Malwarebytes
cls
start https://downloads.malwarebytes.com/file/mb-windows
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:TeamViewer
cls
start https://download.teamviewer.com/download/TeamViewer_Setup_x64.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface


:WinRAR
cls
start https://www.win-rar.com/fileadmin/winrar-versions/winrar/winrar-x64-624.exe
echo.
echo Already Download And Open!  Press enter to go to Back.
Pause > Nul
goto TweaksWindowsInterface

:TypeWritting effect

:TYPE
SET "d[text]=%~1"
CALL :TYPELOOP
GOTO :EOF

:TYPELOOP
IF "%d[text]:~0,1%" == "#" (
    <NUL SET /P "=^!"
) else (
    <NUL SET /P "=d!BS!%d[text]:~0,1%"
)
SET "d[text]=%d[text]:~1%"
IF "%d[text]%" == "" (
    GOTO :EOF
) else (
    FOR /L %%J in (1, 100, 10000000) DO REM
    GOTO :TYPELOOP
)
exit

:TYPEFast
SET "d[text]=%~1"
CALL :TYPELOOPFast
GOTO :EOF

:TYPELOOPFast
IF "%d[text]:~0,1%" == "#" (
    <NUL SET /P "=^!"
) else (
    <NUL SET /P "=d!BS!%d[text]:~0,1%"
)
SET "d[text]=%d[text]:~1%"
IF "%d[text]%" == "" (
    GOTO :EOF
) else (
    FOR /L %%J in (1, 100, 1000000) DO REM
    GOTO :TYPELOOPFast
)
exit
